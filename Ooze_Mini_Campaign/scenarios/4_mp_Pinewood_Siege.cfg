     # ===================================================================================================================== #
     # 4 - SIEGE MULTIPLAYER SCENARIO
     # ===================================================================================================================== #
     #  Created by: SpenceLack
     # Modified by: Wesbane
     # Last revision: 2012-09-12
     # ===================================================================================================================== #

#define P1
1#enddef

#define P2
2#enddef

#define F1
3#enddef

#define F2
4#enddef

     # ===================================================================================================================== #
     # SCENARIO UTILS DEFINITIONS
     # ===================================================================================================================== #

#define CREATE_SOLID_LEADERS
    [set_variable]
        name=ooze_store.moves
        to_variable=ooze_store.max_moves
    [/set_variable]

    [set_variable]
        name=ooze_store2.moves
        to_variable=ooze_store2.max_moves
    [/set_variable]

    [kill]
        id=Master Ooze
    [/kill]

    [redraw]
    [/redraw]

    [unstore_unit]
        variable=ooze_store
    [/unstore_unit]

    [kill]
        id=Master Ooze 2
    [/kill]

    [redraw]
    [/redraw]

    [unstore_unit]
        variable=ooze_store2
    [/unstore_unit]

    [object]
	[filter]
	    id=Master Ooze
        [/filter]
	silent=yes
	[effect]
	    apply_to=hitpoints
	    heal_full=yes
	[/effect]
    [/object]

    [object]
	[filter]
	    id=Master Ooze 2
        [/filter]
	silent=yes
	[effect]
	    apply_to=hitpoints
	    heal_full=yes
	[/effect]
    [/object]
#enddef

#define INITIALIZE_VARIABLES 
    {VARIABLE battle_stage 0}

    [if]
        [variable]
            name=dryad_friend
            numerical_equals=1
        [/variable]
    [then]
        [set_variable]
            name=traitor_id
            value=Master Ooze
        [/set_variable]
    [/then]
    [else]
        [if]
            [variable]
                name=dryad_friend
                numerical_equals=2
            [/variable]
        [then]
            [set_variable]
                name=traitor_id
                value=Master Ooze 2
            [/set_variable]
        [/then]
        [/if]
    [/else]
    [/if]
#enddef

#define RANDOMIZE_SCENARIO
    {RANDOM 1..2}
    
    [set_variable]
        name=join_to_forces
        value=$random
    [/set_variable]

    {CLEAR_VARIABLE random}

    {RANDOM 1..2}
    
    [set_variable]
        name=sudden_strike
        value=$random
    [/set_variable]

    {CLEAR_VARIABLE random}
    
    {RANDOM 1..5}
    
    [set_variable]
        name=allies_type
        value=$random
    [/set_variable]

    {CLEAR_VARIABLE random}
#enddef

#define CAPTURE_LEADER FILTER VALUE
    [store_unit]        
        variable=captured_unit
        kill=no
        [filter]
            {FILTER}
        [/filter]
    [/store_unit]
    [set_variable]
        name=captured_unit[0].side
        value={VALUE}
    [/set_variable]
    [unstore_unit]
        variable=captured_unit[0]
        find_vacant=no
    [/unstore_unit]
    {CLEAR_VARIABLE captured_unit}
#enddef

#define SPENT_GOLD VALUE SIDE
    [set_variable]
        name=gpa
        value={VALUE}
    [/set_variable]
    [message]
	speaker=narrator
	message= _ "You spent $gpa gold pieces!"
	image=wesnoth-icon.png
    [/message]
    [sound]
        name=gold.ogg
    [/sound]
    [gold]
        side={SIDE}
        amount=-$gpa
    [/gold]
#enddef

#define SHADY_INTRODUCTION SIDE
    {VARIABLE master_ooze {SIDE}}

    [if]
        [variable]
            name=master_ooze
            numerical_equals=1
        [/variable]
    [then]
        [set_variable]
            name=speaker_id
            value=Master Ooze
        [/set_variable]
    [/then]
    [else]
        [set_variable]
            name=speaker_id
            value=Master Ooze 2
        [/set_variable]
    [/else]
    [/if]

    [if]
	[variable]
	    name=shady_dead
	    numerical_equals=0
	[/variable]
    [then]
	[message]
	    id=Shady Character
	    message= _ "How would you like to increase the efficiency of your troops?" 
	[/message]
	[message]
		id=$speaker_id
		message= _ "Who are you?" 
	[/message]
	[message]
		id=Shady Character
		message= _ "My name is unimportant. I'm a black market arms dealer by trade. Under normal circumstances my business would be conducted in a more...clandestine manner, but these are hardly normal times. If the orcs overrun the fort they'll kill us all. So I'm willing to sell my wares to your troops at a significant discount!" 
	[/message]
	[message]
		id=$speaker_id
		message= _ "You want to SELL us weapons? You're not just going to give them to us? Because, as you so correctly pointed out, if we lose, you die too." 
	[/message]
	[message]
		id=Shady Character
		message= _ "Sorry, this is a case of my overwhelming greed getting the better of my self preservation instincts." 
	[/message]
    [/then]
    [/if]
    {CLEAR_VARIABLE master_ooze}
    {CLEAR_VARIABLE speaker_id}
#enddef

#define SHADY_TRANSACTIONS SIDE	
    [if]
	[variable]
	    name=shady_dead
	    numerical_equals=0
	[/variable]
    [then]
        [store_gold] 
	    side={SIDE}
	    variable=gold 
        [/store_gold]

	[if]
            [variable]
		name=upgrade_given
		numerical_equals=0
	    [/variable]
	[then]	
	    [message]
		id=Shady Character
		message= _ "30 gold will give one of your units poison for their melee attack." 
	    [/message]
	    [message]
		id=Shady Character
		message= _ "40 gold will give one of your units a one-time permanent upgrade to their melee capabilities. I only have the ability to do this ONCE, so choose who will receive this boon wisely." 
	    [/message]
	
	    [message]
	        speaker=unit
	message= _ "(What to buy?)"
		[option]
		    message= _ "(Pay 30 gold) Poison my melee weapons!"
		    [command]
			[if]
			    [variable] 
				name=gold 
				less_than=30
			    [/variable]
			[then]
			    [message]
			        id=Shady Character
				message= _ "It looks like you don't have that much. Come back when you have more gold."
			    [/message]
			[/then]
                        [else]
                            [object]
				silent=yes
       				duration=forever
				[effect]
				    apply_to=attack
				    range=melee
				    [set_specials]
           			        mode=append
           			        {WEAPON_SPECIAL_POISON}
     				    [/set_specials]
				[/effect]
        		    [/object]
                            {SPENT_GOLD 30 {SIDE}}
                        [/else]
			[/if]
                    [/command]
		[/option]
		[option]
                    message= _ "(Pay 40 gold) Upgrade my melee weapons!"
                    [command]
			[if]
			    [variable] 
				name=gold 
				less_than=40
			    [/variable]
			[then]
			    [message]
				id=Shady Character
				message= _ "It looks like you don't have that much. Come back when you have more gold."
			    [/message]
			[/then]
                        [else]
                            [object]
			        silent=yes
       			        duration=forever
			        [effect]
				    apply_to=attack
				    range=melee
				    increase_damage=3
				[/effect]
        		    [/object]

			    [set_variable]
				name=upgrade_given
				value=1
			    [/set_variable]

                            [message]
				speaker=narrator
				message= _ "You spent 40 gold pieces and your melee damage increased by 3!"
				image=wesnoth-icon.png
			    [/message]

			    [sound]
				name=gold.ogg
			    [/sound]
			    [gold]
				side={SIDE}
				amount=-40
			    [/gold]
                        [/else]
			[/if]
		    [/command]
		[/option]
		[option]
		    message= _ "(Leave)"
		    [command]
			[message]
			    id=Shady Character
			    message= _ "Come back any time (with more gold, preferably)!"
			[/message]
		    [/command]
		[/option]
            [/message]
	[/then]
	[else]
	    [message]
	        id=Shady Character
	        message= _ "30 gold will give one of your units poison for their melee attack." 
	    [/message]
	    [message]
	        speaker=unit
	        message= _ "(What to buy?)"
		[option]
		    message= _ "(Pay 30 gold) Poison my melee weapons!"
		    [command]
			[if]
			    [variable] 
			        name=gold 
				less_than=30
			    [/variable]
			[then]
			    [message]
			        id=Shady Character
				message= _ "It looks like you don't have that much. Come back when you have more gold."
			    [/message]
			[/then]
                        [else]
                            [object]
				silent=yes
       				duration=forever
				[effect]
				    apply_to=attack
				    range=melee
				    [set_specials]
           			        mode=append
           			        {WEAPON_SPECIAL_POISON}
     				    [/set_specials]
				[/effect]
        		    [/object]
                            {SPENT_GOLD 30 {SIDE}}
                        [/else]
			[/if]
		    [/command]
		[/option]
		[option]
		    message= _ "(Leave)"
		    [command]
			[message]
			    id=Shady Character
			    message= _ "Come back any time (with more gold, preferably)!"
			[/message]
		    [/command]
		[/option]
	    [/message]
	[/else]
	[/if]
    [/then]
    [/if]
#enddef

#define WILD_ALLIES
    [switch]
        variable=allies_type
    [case]
        value="1"
        [unit]
	    type=Giant Spider
	    [modifications]
		{TRAIT_RESILIENT}
		{TRAIT_QUICK}
	    [/modifications]
	    side={F2}
	    x=10
	    y=19
	[/unit]
    [/case]
    [case]
        value="2"
        [unit]
	    type=Water Serpent
	    [modifications]
		{TRAIT_RESILIENT}
		{TRAIT_STRONG}
	    [/modifications]
	    side={F2}
	    x=7
	    y=17
	[/unit]
        [unit]
	    type=Water Serpent
	    [modifications]
		{TRAIT_QUICK}
		{TRAIT_STRONG}
	    [/modifications]
	    side={F2}
	    x=13
	    y=17
	[/unit]
    [/case]
    [case]
        value="3"
        [unit]
	    type=Troll Rocklobber
	    [modifications]
		{TRAIT_RESILIENT}
		{TRAIT_FEARLESS}
	    [/modifications]
	    side={F2}
	    x=9
	    y=19
	[/unit]
        [unit]
	    type=Troll Rocklobber
	    [modifications]
		{TRAIT_QUICK}
		{TRAIT_RESILIENT}
	    [/modifications]
	    side={F2}
	    x=11
	    y=19
	[/unit]
    [/case]
    [case]
        value="4"
        [unit]
	    type=Goblin Spearman
	    [modifications]
		{TRAIT_SLOW}
	    [/modifications]
	    side={F2}
	    x=9
	    y=18
	[/unit]
        [unit]
	    type=Goblin Rouser
	    [modifications]
		{TRAIT_DIM}
	    [/modifications]
	    side={F2}
	    x=10
	    y=17
	[/unit]
        [unit]
	    type=Goblin Spearman
	    [modifications]
		{TRAIT_SLOW}
	    [/modifications]
	    side={F2}
	    x=11
	    y=18
	[/unit]
        [unit]
	    type=Goblin Spearman
	    [modifications]
		{TRAIT_SLOW}
	    [/modifications]
	    side={F2}
	    x=10
	    y=18
	[/unit]
        [unit]
	    type=Goblin Rouser
	    [modifications]
		{TRAIT_WEAK}
	    [/modifications]
	    side={F2}
	    x=10
	    y=19
	[/unit]
        [unit]
	    type=Goblin Spearman
	    [modifications]
		{TRAIT_DIM}
	    [/modifications]
	    side={F2}
	    x=11
	    y=19
	[/unit]
    [/case]
    [else]
        [unit]
	    type=Troll Hero
	    [modifications]
		{TRAIT_FEARLESS}
		{TRAIT_QUICK}
	    [/modifications]
	    side={F2}
	    x=9
	    y=19
	[/unit]
        [unit]
	    type=Troll Hero
	    [modifications]
		{TRAIT_RESILIENT}
		{TRAIT_STRONG}
	    [/modifications]
	    side={F2}
	    x=11
	    y=19
	[/unit]
    [/else]
    [/switch]
    
    [message]
        id=Guthry
	message= _ "I found new friends to help me claim what's rightfully mine!"
    [/message]
#enddef

#define GUTHRY_EAGER SIDE
    [if]
        [have_unit]
            side={F2}
            id=Guthry
        [/have_unit]
    [then]
        [if]
            [variable]
                name=dryad_friend
                numerical_equals={SIDE}
            [/variable]
        [then]
            [message]
               id=Guthry
               message= _ "Come out elf and fight! Do not hide before me!" 
            [/message]
        [/then]
        [/if]
    [/then]
    [/if]
#enddef

#define TOWNSFOLK
    [unit]
	type=Spearman
	id=Stern Guard
	name= _ "Stern Guard"
	[modifications]
	    {TRAIT_LOYAL}
	    {TRAIT_INTELLIGENT}
	[/modifications]
	side={F1}
	x=9
	y=15
    [/unit]
    [unit]
	type=Bowman
	id=Bored Guard
	name= _ "Bored Guard"
	[modifications]
	    {TRAIT_LOYAL}
	    {TRAIT_QUICK}
	[/modifications]
	side={F1}
	x=11
	y=15
    [/unit]
    [unit]
	type=Dwarvish Thunderer
	id=Ram Aide
	name= _ "Ram Aide"
	[modifications]
	    {TRAIT_LOYAL}
	    {TRAIT_STRONG}
	[/modifications]
	side={F1}
	x=3
	y=7
    [/unit]
    [unit]
	type=White Mage
	id=High Priest Jal
	name= _ "High Priest Jal"
	[modifications]
	    {TRAIT_LOYAL}
	    {TRAIT_INTELLIGENT}
	[/modifications]
	side={F1}
	x=14
	y=8
    [/unit]
    [unit]
	type=Peasant
	id=Jedd
	name= _ "Jedd"
	[modifications]
	    {TRAIT_LOYAL}
	    {TRAIT_RESILIENT}
	[/modifications]
	side={F1}
	x=14
	y=4
    [/unit]
    [unit]
	type=Dark Sorceress
	id=Corinna
	name= _ "Corinna"
	[modifications]
	    {TRAIT_LOYAL}
	    {TRAIT_INTELLIGENT}
	[/modifications]
	side={F1}
	x=3
	y=11
    [/unit]
    [unit]
	type=Sergeant
	id=Sergeant Ryn
	name= _ "Sergeant Ryn"
	[modifications]
	    {TRAIT_LOYAL}
	    {TRAIT_INTELLIGENT}
	[/modifications]
	side={F1}
	x=10
	y=6
    [/unit]
    [unit]
        type=Dwarvish Fighter
	id=Frist
	name= _ "Frist"
	[modifications]
	    {TRAIT_LOYAL}
	    {TRAIT_STRONG}
	[/modifications]
	side={P1}
	x=6
	y=8
    [/unit]
    [unit]
	type=Longbowman
	id=Valin
	name= _ "Valin"
	[modifications]
	    {TRAIT_LOYAL}
	    {TRAIT_STRONG}
	[/modifications]
	side={F1}
	x=18
	y=8
    [/unit]
    [unit]
	type=Dwarvish Guardsman
	id=Brock
	name= _ "Brock"
	[modifications]
	    {TRAIT_LOYAL}
	    {TRAIT_RESILIENT}
	[/modifications]
	profile=Portraits/olddwarf-guard.png
	side={F1}
	x=14
	y=12
    [/unit]
    [unit]
	type=Elvish Ranger
	id=Kirielle the Realist
	name= _ "Kirielle the Realist"
	[modifications]
	    {TRAIT_LOYAL}
	    {TRAIT_INTELLIGENT}
	[/modifications]
	side={P1}
	x=10
	y=1
	gender=female
    [/unit]
    [unit]
	type=Elvish Marksman
	id=Bryony the Idealist
	name= _ "Bryony the Idealist"
	[modifications]
	    {TRAIT_LOYAL}
	    {TRAIT_QUICK}
	[/modifications]
	side={P1}
	x=11
	y=2
	gender=female
    [/unit]
#enddef

#define FORM_DEFENDER_FORCES
    [if]
        [variable]
            name=leadership_aurelia
            greater_than=$leadership_sithras
        [/variable]
    [then]
        {VARIABLE aurelia_forces_overwhelm $leadership_aurelia}
        {VARIABLE_OP aurelia_forces_overwhelm sub $leadership_sithras}
        [if]
            [variable]
                name=leaderless_troops
                greater_than=0
            [/variable]
        [then]
            [if]
                [variable]
                    name=corinna_friend
                    numerical_equals=3
                [/variable]
            [then]
                {CAPTURE_LEADER id=Corinna {P2}}
                {VARIABLE_OP leaderless_troops sub 1}
                {VARIABLE_OP aurelia_forces_overwhelm sub 1}
                {VARIABLE_OP leadership_sithras add 1}           
            [/then]
            [/if]

            [if]
                [variable]
                    name=valin_friend
                    numerical_equals=3
                [/variable]
            [then]
                {CAPTURE_LEADER id=Valin {P2}}
                {VARIABLE_OP leaderless_troops sub 1}
                {VARIABLE_OP aurelia_forces_overwhelm sub 1}
                {VARIABLE_OP leadership_sithras add 1}                
            [/then]
            [/if]

            [if]
                [variable]
                    name=sergeant_ryn_friend
                    numerical_equals=3
                [/variable]
            [then]
                {CAPTURE_LEADER id="Sergeant Ryn" {P2}}
                {VARIABLE_OP leaderless_troops sub 1}
                {VARIABLE_OP aurelia_forces_overwhelm sub 1}
                {VARIABLE_OP leadership_sithras add 1}                
            [/then]
            [/if]

            [if]
                [variable]
                    name=brock_friend
                    numerical_equals=3
                [/variable]
            [then]
                {CAPTURE_LEADER id=Brock {P2}}
                {VARIABLE_OP leaderless_troops sub 1}
                {VARIABLE_OP aurelia_forces_overwhelm sub 1}
                {VARIABLE_OP leadership_sithras add 1}                
            [/then]
            [/if]

            [if]
                [variable]
                    name=ram_friend
                    numerical_equals=3
                [/variable]
            [then]
                {CAPTURE_LEADER id="Ram Aide" {P2}}
                {VARIABLE_OP leaderless_troops sub 1}
                {VARIABLE_OP aurelia_forces_overwhelm sub 1}
                {VARIABLE_OP leadership_sithras add 1}                
            [/then]
            [/if]
        [/then]
        [/if]

        [if]
            [variable]
                name=aurelia_forces_overwhelm
                less_than=0
            [/variable]
        [then]
            {VARIABLE imperial_commander {P1}}
            {VARIABLE_OP aurelia_forces_overwhelm add 3}
            {VARIABLE_OP leadership_aurelia add 3} 
        [/then]
        [else]
            [if]
                [variable]
                    name=aurelia_forces_overwhelm
                    greater_than=0
                [/variable]
            [then]
                {VARIABLE imperial_commander {P2}} 
                {VARIABLE_OP aurelia_forces_overwhelm sub 3}
                {VARIABLE_OP leadership_sithras add 3} 
            [/then]
            [else]
                {VARIABLE imperial_commander $join_to_forces}
                [if]
                    [variable]
                        name=join_to_forces
                        numerical_equals=1
                    [/variable]
                [then]
                    {VARIABLE_OP sithras_forces_overwhelm sub 3}
                    {VARIABLE_OP leadership_aurelia add 3} 
                [/then]
                [else]
                    {VARIABLE_OP aurelia_forces_overwhelm sub 3}
                    {VARIABLE_OP leadership_sithras add 3} 
                [/else]
                [/if]
            [/else]
            [/if]
        [/else]
        [/if]
    [/then]
    [else]
        [if]
            [variable]
                name=leadership_aurelia
                less_than=$leadership_sithras
            [/variable]
        [then]
            {VARIABLE sithras_forces_overwhelm $leadership_sithras}
            {VARIABLE_OP sithras_forces_overwhelm sub $leadership_aurelia}
            [if]
                [variable]
                    name=leaderless_troops
                    greater_than=0
                [/variable]
            [then]
                [if]
                    [variable]
                        name=corinna_friend
                        numerical_equals=3
                    [/variable]
                [then]
                    {CAPTURE_LEADER id=Corinna {P1}}
                    {VARIABLE_OP leaderless_troops sub 1}
                    {VARIABLE_OP sithras_forces_overwhelm sub 1}
                    {VARIABLE_OP leadership_aurelia add 1}                
                [/then]
                [/if]

                [if]
                    [variable]
                        name=valin_friend
                        numerical_equals=3
                    [/variable]
                [then]
                    {CAPTURE_LEADER id=Valin {P1}}
                    {VARIABLE_OP leaderless_troops sub 1}
                    {VARIABLE_OP sithras_forces_overwhelm sub 1}
                    {VARIABLE_OP leadership_aurelia add 1}                
                [/then]
                [/if]

                [if]
                    [variable]
                        name=sergeant_ryn_friend
                        numerical_equals=3
                    [/variable]
                [then]
                    {CAPTURE_LEADER id="Sergeant Ryn" {P1}}
                    {VARIABLE_OP leaderless_troops sub 1}
                    {VARIABLE_OP sithras_forces_overwhelm sub 1}
                    {VARIABLE_OP leadership_aurelia add 1}                
                [/then]
                [/if]

                [if]
                    [variable]
                        name=brock_friend
                        numerical_equals=3
                    [/variable]
                [then]
                    {CAPTURE_LEADER id=Brock {P1}}
                    {VARIABLE_OP leaderless_troops sub 1}
                    {VARIABLE_OP sithras_forces_overwhelm sub 1}
                    {VARIABLE_OP leadership_aurelia add 1}                
                [/then]
                [/if]

                [if]
                    [variable]
                        name=ram_friend
                        equals=3
                    [/variable]
                [then]
                    {CAPTURE_LEADER id="Ram Aide" {P1}}
                    {VARIABLE_OP leaderless_troops sub 1}
                    {VARIABLE_OP sithras_forces_overwhelm sub 1}
                    {VARIABLE_OP leadership_aurelia add 1}                
                [/then]
                [/if]
            [/then]
            [/if]

            [if]
                [variable]
                    name=sithras_forces_overwhelm
                    less_than=0
                [/variable]
            [then]
                {VARIABLE imperial_commander {P2}}
                {VARIABLE_OP sithras_forces_overwhelm add 3}
                {VARIABLE_OP leadership_sithras add 3} 
            [/then]
            [else]
                [if]
                    [variable]
                        name=sithras_forces_overwhelm
                        greater_than=0
                    [/variable]
                [then]
                    {VARIABLE imperial_commander {P1}} 
                    {VARIABLE_OP sithras_forces_overwhelm sub 3}
                    {VARIABLE_OP leadership_aurelia add 3} 
                [/then]
                [else]
                    {VARIABLE imperial_commander $join_to_forces}
                    [if]
                        [variable]
                            name=join_to_forces
                            numerical_equals=1
                        [/variable]
                    [then]
                        {VARIABLE_OP sithras_forces_overwhelm sub 3}
                        {VARIABLE_OP leadership_aurelia add 3} 
                    [/then]
                    [else]
                        {VARIABLE_OP aurelia_forces_overwhelm sub 3}
                        {VARIABLE_OP leadership_sithras add 3} 
                    [/else]
                    [/if]
                [/else]
                [/if]
            [/else]
            [/if]
        [/then]
        [else]
            {VARIABLE sithras_forces_overwhelm 0}

            [if]
                [variable]
                    name=leaderless_troops
                    greater_than=0
                [/variable]
            [then]
                [if]
                    [variable]
                        name=corinna_friend
                        numerical_equals=3
                    [/variable]
                [then]
                    {CAPTURE_LEADER id=Corinna {P1}}
                    {VARIABLE_OP leaderless_troops sub 1}
                    {VARIABLE_OP sithras_forces_overwhelm sub 1}
                    {VARIABLE_OP leadership_aurelia add 1}                
                [/then]
                [/if]

                [if]
                    [variable]
                        name=valin_friend
                        numerical_equals=3
                    [/variable]
                [then]
                    {CAPTURE_LEADER id=Valin {P1}}
                    {VARIABLE_OP leaderless_troops sub 1}
                    {VARIABLE_OP sithras_forces_overwhelm sub 1}
                    {VARIABLE_OP leadership_aurelia add 1}                
                [/then]
                [/if]

                [if]
                    [variable]
                        name=sergeant_ryn_friend
                        numerical_equals=3
                    [/variable]
                [then]
                    {CAPTURE_LEADER id="Sergeant Ryn" {P1}}
                    {VARIABLE_OP leaderless_troops sub 1}
                    {VARIABLE_OP sithras_forces_overwhelm sub 1}
                    {VARIABLE_OP leadership_aurelia add 1}                
                [/then]
                [/if]

                [if]
                    [variable]
                        name=brock_friend
                        numerical_equals=3
                    [/variable]
                [then]
                    {CAPTURE_LEADER id=Brock {P1}}
                    {VARIABLE_OP leaderless_troops sub 1}
                    {VARIABLE_OP sithras_forces_overwhelm sub 1}
                    {VARIABLE_OP leadership_aurelia add 1}                
                [/then]
                [/if]

                [if]
                    [variable]
                        name=ram_friend
                        numerical_equals=3
                    [/variable]
                [then]
                    {CAPTURE_LEADER id="Ram Aide" {P1}}
                    {VARIABLE_OP leaderless_troops sub 1}
                    {VARIABLE_OP sithras_forces_overwhelm sub 1}
                    {VARIABLE_OP leadership_aurelia add 1}                
                [/then]
                [/if]
            [/then]
            [/if]

            [if]
                [variable]
                    name=sithras_forces_overwhelm
                    less_than=0
                [/variable]
            [then]
                {VARIABLE imperial_commander {P2}}
                {VARIABLE_OP sithras_forces_overwhelm add 3}
                {VARIABLE_OP leadership_sithras add 3} 
            [/then]
            [else]
                [if]
                    [variable]
                        name=sithras_forces_overwhelm
                        greater_than=0
                    [/variable]
                [then]
                    {VARIABLE imperial_commander {P1}} 
                    {VARIABLE_OP sithras_forces_overwhelm sub 3}
                    {VARIABLE_OP leadership_aurelia add 3} 
                [/then]
                [else]
                    {VARIABLE imperial_commander $join_to_forces}
                    [if]
                        [variable]
                            name=join_to_forces
                            numerical_equals=1
                        [/variable]
                    [then]
                           {VARIABLE_OP sithras_forces_overwhelm sub 3}
                           {VARIABLE_OP leadership_aurelia add 3} 
                    [/then]
                    [else]
                        {VARIABLE_OP aurelia_forces_overwhelm sub 3}
                        {VARIABLE_OP leadership_sithras add 3} 
                    [/else]
                    [/if]
                [/else]
                [/if]
            [/else]
            [/if]
        [/else]
        [/if]
    [/else]
    [/if]

    [if]
        [variable]
            name=corinna_friend
            less_than=3
        [/variable]
    [then]
        {CAPTURE_LEADER id=Corinna $corinna_friend}                
    [/then]
    [/if]

    [if]
        [variable]
            name=valin_friend
            less_than=3
        [/variable]
    [then]
        {CAPTURE_LEADER id=Valin $valin_friend}            
    [/then]
    [/if]

    [if]
        [variable]
            name=sergeant_ryn_friend
            less_than=3
        [/variable]
    [then]
        {CAPTURE_LEADER id="Sergeant Ryn" $sergeant_ryn_friend}               
    [/then]
    [/if]

    [if]
        [variable]
            name=brock_friend
            less_than=3
        [/variable]
    [then]
        {CAPTURE_LEADER id=Brock $brock_friend}             
    [/then]
    [/if]

    [if]
        [variable]
             name=ram_friend
             less_than=3
        [/variable]
    [then]
        {CAPTURE_LEADER id="Ram Aide" $ram_friend}             
    [/then]
    [/if]

    {CAPTURE_LEADER id="Bored Guard" $bored_friend}
    {CAPTURE_LEADER id="Stern Guard" $stern_friend} 
#enddef

#define FORM_VOLUNTEER_FORCES
    [if]
	[variable] 
	    name=dryden_friend
	    greater_than=0
	[/variable]
    [then]
	[unit]
	    type=Paladin
	    id=Sir Dryden
	    name= _ "Sir Dryden"
	    [modifications]
		{TRAIT_LOYAL}
		{TRAIT_RESILIENT}
	    [/modifications]
	    side=$dryden_friend
	    x=7
	    y=13
	[/unit]
        [if]
            [variable]
                name=dryden_friend
                greater_than=1
            [/variable]
        [then]
            [message]
	        id=Sir Dryden
	        message= _ "Sithras, today I will repay my debt to you!" 
	    [/message]
        [/then]
        [else]
            [message]
	        id=Sir Dryden
	        message= _ "Aurelia, today I will repay my debt to you!" 
	    [/message]
        [/else]
        [/if]
	[message]
	    id=Corinna
	    message= _ "I don't really care about this fort but... (she fingers the Ring of Opposite Alignment) I guess I do care. (What did I just say?! I haven't been myself lately!)" 
	[/message]
    [/then]
    [else]
	[message]
	    id=Corinna
	    message= _ "What is it with people interrupting my studies?! First that idiot paladin and now an orc horde! Someone will pay for this!" 
	[/message]
    [/else]
    [/if]

    [if]
	[variable] 
	    name=fontaine_friend
	    greater_than=0
	[/variable]
    [then]
	[unit]
	    type=Fencer
	    id=Fontaine
	    name= _ "Fontaine"
	    [modifications]
		{TRAIT_LOYAL}
		{TRAIT_QUICK}
	    [/modifications]
	    side=$fontaine_friend
	    x=16
	    y=10
	[/unit]
        [if]
            [variable]
                name=fontaine_friend
                greater_than=1
            [/variable]
        [then]
            [message]
		id=Fontaine
		message= _ "Today my patron will show the orcs the art of war!" 
	    [/message]
        [/then]
        [else]
            [message]
		id=Fontaine
		message= _ "No foul orc will touch a single golden hair on the head of my beautiful, perfect Muse so long as I draw breath!" 
	    [/message]
        [/else]
        [/if]
    [/then]
    [/if]

    [if]
	[variable] 
	    name=jedd_friend
	    greater_than=0
	[/variable]
    [then]
        [if]
            [variable]
                name=jedd_friend
                greater_than=1
            [/variable]
        [then]
            [message]
		id=Jedd
	        message= _ "Sithras, you helped me when I had no hope, so now I'll help help you against this orc horde, even if there is no hope of victory."
	    [/message]
        [/then]
        [else]
            [message]
		id=Jedd
	        message= _ "Aurelia, you helped me when I had no hope, so now I'll help help you against this orc horde, even if there is no hope of victory."
	    [/message]
        [/else]
        [/if]
        {CAPTURE_LEADER id=Jedd $jedd_friend}
    [/then]
    [else]
	[message]
	    id=Jedd
	    message= _ "Time for me to go hide in my cellar." 
	[/message]
	[kill]
	    id=Jedd
	[/kill]
    [/else]
    [/if]

    [if]
	[variable] 
	    name=jal_friend
	    greater_than=0
	[/variable]
    [then]
        [if]
            [variable]
                name=jal_friend
                greater_than=1
            [/variable]
        [then]
            [message]
	        id=High Priest Jal
	        message= _ "Sithras's piety is a beacon of light in this hour of darkness. By sword and prayer we will drive these heathen orcs back to the shadows from whence they came!" 
	    [/message]
        [/then]
        [else]
            [message]
	        id=High Priest Jal
	        message= _ "Aurelia's piety is a beacon of light in this hour of darkness. By sword and prayer we will drive these heathen orcs back to the shadows from whence they came!" 
	    [/message]
        [/else]
        [/if]
        {CAPTURE_LEADER id="High Priest Jal" $jal_friend}
    [/then]
    [else]
	[message]
	    id=High Priest Jal
	    message= _ "A battlefield is no place for a man of my stature. I'll be in my church...praying to Pelor for our inevitable victory." 
	[/message]
	[kill]
	    id=High Priest Jal
	[/kill]
    [/else]
    [/if]

    [if]
	[variable] 
	    name=alkar_friend
	    greater_than=0
	[/variable]
    [then]
        [if]
            [variable]
                name=alkar_offer
                numerical_equals=4
            [/variable]
            [then]
                [unit]
                    type=Lancer
                    id=Alkar
                    name = _ "Alkar"
                    [modifications]
		        {TRAIT_LOYAL}
		        {TRAIT_QUICK}
                    [/modifications]
	            side=$alkar_friend
	            x=6
	            y=4
                [/unit]
                [message]
                    id=Alkar
                    message= _ "My lord everything I am I owe to you. Command me!"
                [/message]
            [/then]
            [else]
                [unit]
                    type=Spearman
                    id=Alkar
                    name = _ "Alkar"
                    [modifications]
		        {TRAIT_LOYAL}
		        {TRAIT_QUICK}
                    [/modifications]
	            side=$alkar_friend
	            x=6
	            y=4
                [/unit]
                [message]
                    id=Alkar
                    message= _ "My master! Lead!"
                [/message]
            [/else]
        [/if]
    [/then]
    [else]
        [unit]
            type=Peasant
            id=Alkar
            name = _ "Alkar"
            [modifications]
		{TRAIT_LOYAL}
		{TRAIT_QUICK}
            [/modifications]
	    side={F1}
	    x=6
	    y=4
        [/unit]
        [message]
            id=Alkar
            message= _ "To victory! Glory for b... (Suddenly you hear a wail of pain. Alkar has tripped in the darkness of night and unfortunately impaled himself on his pitchfork. The young man's militia career has ended before it could even begin.)"
        [/message]
        [kill]
            id=Alkar
            animate=yes
        [/kill]
        [message]
            id=Frist
            message= _ "And thats why ye shouldn't go ta battle without proper training."
        [/message]
    [/else]	
    [/if]

    [if]
	[variable] 
	    name=livius_friend
	    greater_than=0
	[/variable]
    [then]
	[unit]
	    type=Mage
	    id=Livius
	    name= _ "Livius"
	    [modifications]
		{TRAIT_LOYAL}
		{TRAIT_INTELLIGENT}
	    [/modifications]
	    side=$livius_friend
	    x=16
	    y=6
	[/unit]
	[message]
	    id=Livius
	    message= _ "(Sigh) Why did it have to be an orc horde? Why couldn't it have been an ooze horde?" 
	[/message]
    [/then]
    [/if]

    [if]
	[variable] 
	    name=guthry_friend
	    greater_than=0
	[/variable]
    [then]
	[unit]
	    type=Woodsman
	    id=Guthry
	    name= _ "Guthry"
	    [modifications]
	        {TRAIT_LOYAL}
	        {TRAIT_STRONG}
	    [/modifications]
	    side=$guthry_friend
	    x=4
	    y=3
	[/unit]
        [if]
            [variable]
                name=guthry_friend
                greater_than=1
            [/variable]
        [then]
            [message]
	        id=Guthry
	        message= _ "I didn't inherit this land just to lose it to some thieving orc lord! I'm with you, Sithras!"
	    [/message]
        [/then]
        [else]
            [message]
	        id=Guthry
	        message= _ "I didn't inherit this land just to lose it to some thieving orc lord! I'm with you, Aurelia!"
	    [/message]
        [/else]
        [/if]
    [/then]
    [/if]

    [if]
	[variable] 
	    name=dryad_friend
	    greater_than=0
	[/variable]
    [then]
	[unit]
	    type=Elvish Druid
	    id=Dryad
	    name= _ "Dryad"
	    [modifications]
	        {TRAIT_LOYAL}
		{TRAIT_QUICK}
	    [/modifications]
	    side=$dryad_friend
	    x=5
	    y=3
	[/unit]
        [if]
            [variable]
                name=dryad_friend
                greater_than=1
            [/variable]
        [then]
            [message]
	        id=Dryad
	        message= _ "Sithras, today I repay my debt to you! The orcs will feel Nature's fury!" 
	    [/message]
        [/then]
        [else]
            [message]
	        id=Dryad
	        message= _ "Aurelia, today I repay my debt to you! The orcs will feel Nature's fury!" 
	    [/message]
        [/else]
        [/if]
	[unit]
	    type=Woodsman
	    id=Guthry
	    name= _ "Guthry"
	    [modifications]
		{TRAIT_LOYAL}
		{TRAIT_STRONG}
	    [/modifications]
	    side={F2}
	    x=10
	    y=20
        [/unit]
	[message]
	    id=Guthry
	    message= _ "Thieving dryad! Despicable elf! I hope the orcs tear you both limb from limb! In fact, I intend to make sure of it!" 
	[/message]
        {WILD_ALLIES}
    [/then]
    [/if]

    [if]
	[variable] 
	    name=troll_friend
	    greater_than=0
	[/variable]
    [then]
        [unit]
	    type=Troll Whelp
	    id=Slave
	    name= _ "Slave"
	    [modifications]
		{TRAIT_LOYAL}
		{TRAIT_STRONG}
	    [/modifications]
	    side=$troll_friend
	    x=9
	    y=2
        [/unit]
        [if]
            [variable]
                name=jal_friend
                greater_than=1
            [/variable]
        [then]
            [set_variable] 
                name=speaker_id
                value=Master Ooze 2
            [/set_variable]
        [/then]
        [else]
            [set_variable] 
                name=speaker_id
                value=Master Ooze
            [/set_variable]
        [/else]
        [/if]
	[message]
	    id=$speaker_id
	    message= _ "(Your troll slave is ready for combat!)" 
	[/message]
    [/then]
    [/if]

    [if]
	[variable] 
	    name=slavers_friend
	    greater_than=0
	[/variable]
    [then]
        [unit]
	    type=Footpad
	    id=Haffuz the Slaver
	    name= _ "Haffuz the Slaver"
	    [modifications]
		{TRAIT_LOYAL}
		{TRAIT_INTELLIGENT}
	    [/modifications]
	    side=$slavers_friend
	    x=9
	    y=3
	[/unit]
	[unit]
	    type=Thug
	    id=Gorl the Smasher
	    name= _ "Gorl the Smasher"
	    [modifications]
		{TRAIT_LOYAL}
		{TRAIT_STRONG}
	    [/modifications]
	    side=$slavers_friend
	    x=8
	    y=2
	[/unit]
	[unit]
	    type=Troll Whelp
	    id=Slave
	    name= _ "Slave"
	    [modifications]
		{TRAIT_LOYAL}
		{TRAIT_STRONG}
	    [/modifications]
	    side=$slavers_friend
	    x=9
	    y=2
	[/unit]
        [if]
            [variable]
                name=slavers_friend
                greater_than=1
            [/variable]
        [then]
            [message]
	        id=Haffuz the Slaver
	        message= _ "Reporting for duty sir! We even brought the troll slav-- errr...troll mascot with us to help out!" 
	    [/message]
        [/then]
        [else]
            [message]
	        id=Haffuz the Slaver
	        message= _ "Reporting for duty ma'am! We even brought the troll slav-- errr...troll mascot with us to help out!" 
	    [/message]
        [/else]
        [/if]
    [/then]
    [/if]

    [remove_item]
	x,y=3,6
    [/remove_item]

    [if]
	[variable] 
	    name=ram_friend
	    less_than=3
	[/variable]
    [then]
	[message]
	    id=Ram Aide
	    message= _ "Oi what a hangover!" 
	[/message]
	[message]
	    id=Ram Aide
	    message= _ "What's this?! Th' entire town is up in arms and orcs are at th' gates? (Pats the gigantic barrel fondly) Baby, I'm gonna miss ya!" 
	[/message]
	[sound]
	    name=dragonstick.ogg
	[/sound]
	[sound]
	    name=flame-big.ogg
	[/sound]
	[color_adjust]
	    red=200
	    green=50
	    blue=50
	[/color_adjust]
	[delay]
	    time=10
	[/delay]
	[color_adjust]
	    red=0
	    green=0
	    blue=0
	[/color_adjust]
	[message]
	    speaker=narrator
	    #image=items/barrel.png
	    image=Items/oldbarrel.png
	    message= _ "Ram Aide uses the gigantic barrel of booze to incinerate the bridge into town and a good portion of the nearby road as well!"
	[/message]
	[terrain]
	    x=10
	    y=15
	    terrain=Ww
	[/terrain]
	[terrain]
	    x=10
	    y=16
	    terrain=Ww
	[/terrain]
    [/then]
    [else]
	[message]
	    id=Ram Aide
	    message= _ "Oi what a hangover!" 
	[/message]
	[message]
	    id=Ram Aide
	    message= _ "What's this?! Th' entire town is up in arms and orcs are at th' gates? (Groans) How did I drink that ENTIRE barrel?!" 
	[/message]
    [/else]
    [/if]
	
    [unit]
	type=Rogue
	side={F1}
	id=Shady Character
	name= _ "Shady Character"
	canrecruit=yes
	recruit=Ruffian
	[modifications]
	    [object]
		silent=yes
		[effect]
		    apply_to=movement_costs 
		    replace=true
		    [movement_costs]
		        flat=99
		    [/movement_costs]
		[/effect]
		[effect]
		    apply_to=movement 
		    set=1
		[/effect]
	    [/object]
	[/modifications]
	x=17
	y=13
    [/unit]
    
    [message]
	speaker=narrator
	message= _ "Note: In this scenario you will no longer share gold with your partner."
        image=wesnoth-icon.png
    [/message]

    {CLEAR_VARIABLE speaker_id}
#enddef

#define IMPERIAL_ARMY_SUPPORT
    [unit]
	type=Dragoon
	id=Captain Koltz
	name= _ "Captain Koltz"
	[modifications]
	    {TRAIT_LOYAL}
	    {TRAIT_QUICK}
	[/modifications]
	side=$imperial_commander
	x=10
	y=1
    [/unit]
    [unit]
	type=Cavalryman
	[modifications]
	    {TRAIT_LOYAL}
	    {TRAIT_QUICK}
	[/modifications]
        side=$imperial_commander
	x=9
	y=1
    [/unit]
    [unit]
	type=Cavalryman
	[modifications]
	    {TRAIT_LOYAL}
	    {TRAIT_QUICK}
	[/modifications]
	side=$imperial_commander
	x=11
	y=1
    [/unit]
	
    [music]
	name=loyalists.ogg
	immediate=yes
    [/music]
    [music]
    name=heroes_rite.ogg
    append=yes
    [/music]
#enddef

#define IMPERIAL_ARMY_FORCES
    [unit]
	type=Great Mage
	id=Imperial Mage
	name= _ "Master Keiron"
	[modifications]
	    {TRAIT_RESILIENT}
	    {TRAIT_INTELLIGENT}
	[/modifications]
	side={F2}
	x=10
	y=1
	canrecruit=yes
	recruit=Cavalryman
	moves=0
    [/unit]
    [unit]
        type=Javelineer
        [modifications]
	    {TRAIT_RESILIENT}
	    {TRAIT_INTELLIGENT}
        [/modifications]
	side={F2}
	x=10
	y=2
	moves=0
    [/unit]
    [unit]
	type=Fencer
	[modifications]
	    {TRAIT_RESILIENT}
	    {TRAIT_INTELLIGENT}
	[/modifications]
	side={F2}
	x=7
	y=1
	moves=0
    [/unit]
    [unit]
	type=Heavy Infantryman
	[modifications]
	    {TRAIT_RESILIENT}
	    {TRAIT_INTELLIGENT}
	[/modifications]
	side={F2}
	x=8
	y=1
	moves=0
    [/unit]
    [unit]
	type=Javelineer
	[modifications]
	    {TRAIT_RESILIENT}
	    {TRAIT_INTELLIGENT}
	[/modifications]
	side={F2}
	x=9
	y=1
	moves=0
    [/unit]
    [unit]
	type=Javelineer
	[modifications]
	    {TRAIT_RESILIENT}
	    {TRAIT_INTELLIGENT}
	[/modifications]
	side={F2}
	x=11
	y=1
	moves=0
    [/unit]
    [unit]
	type=Heavy Infantryman
	[modifications]
	    {TRAIT_RESILIENT}
	    {TRAIT_INTELLIGENT}
	[/modifications]
	side={F2}
	x=12
	y=1
	moves=0
    [/unit]
    [unit]
	type=Sergeant
	[modifications]
	    {TRAIT_RESILIENT}
	    {TRAIT_INTELLIGENT}
	[/modifications]
	side={F2}
	x=13
	y=1
	moves=0
    [/unit]
		
    [unit]
	type=Bowman
	[modifications]
	    {TRAIT_RESILIENT}
	    {TRAIT_INTELLIGENT}
	[/modifications]
	side={F2}
	x=5
	y=1
	moves=0
    [/unit]
    [unit]
	type=Spearman
	[modifications]
	    {TRAIT_RESILIENT}
	    {TRAIT_INTELLIGENT}
	[/modifications]
	side={F2}
	x=6
	y=1
	moves=0
    [/unit]
    [unit]
	type=Mage
	[modifications]
	    {TRAIT_RESILIENT}
	    {TRAIT_INTELLIGENT}
	[/modifications]
	side={F2}
	x=14
	y=1
	moves=0
    [/unit]
    [unit]
	type=Bowman
	[modifications]
	    {TRAIT_RESILIENT}
	    {TRAIT_INTELLIGENT}
	[/modifications]
	side={F2}
	x=15
	y=1
	moves=0
    [/unit]
#enddef

#define OOZE_INFECTION TYPE SIDE
    {VARIABLE ooze_type {TYPE}}

    [if]
        [variable]
            name=ooze_type
            numerical_equals=1
        [/variable]
    [then]
        [set_variable]
           name=ooze_type_id
           value=Giant Ooze
        [/set_variable]
        [set_variable]
           name=master_ooze_id
           value=Master Ooze
        [/set_variable]
    [/then]
    [else]
        [set_variable]
           name=ooze_type_id
           value=Giant Ooze 2
        [/set_variable]
        [set_variable]
           name=master_ooze_id
           value=Master Ooze 2
        [/set_variable]
    [/else]
    [/if]

    [modify_side]
        side={SIDE}
        team_name=devoures 
    [/modify_side]

    [store_unit]
        [filter]
            side={SIDE}
            [not]
                type=$ooze_type_id
            [/not]
            [not]
	        id=$master_ooze_id
	    [/not]
         [/filter]
         kill=yes
         variable=more_ooze
    [/store_unit]

    {FOREACH more_ooze i}

    [unit]
        type=$ooze_type_id
        side={SIDE}
        x,y=$more_ooze[$i].x,$more_ooze[$i].y
    [/unit]

    {NEXT i}

    {CLEAR_VARIABLE more_ooze}
    {CLEAR_VARIABLE ooze_type_id}
    {CLEAR_VARIABLE master_ooze_id}
#enddef

#define BLACKFANG_ARMY_WAVE_01
    [unit]
	type=Orcish Archer
	[modifications]
	    {TRAIT_QUICK}
	    {TRAIT_STRONG}
	[/modifications]
	side={F2}
	x=1
	y=20
    [/unit]
    [unit]
	type=Orcish Grunt
	[modifications]
	    {TRAIT_QUICK}
	    {TRAIT_STRONG}
	[/modifications]
	side={F2}
	x=3
	y=20
    [/unit]
    [unit]
	type=Orcish Grunt
	[modifications]
	    {TRAIT_QUICK}
	    {TRAIT_STRONG}
	[/modifications]
	side={F2}
	x=5
	y=20
    [/unit]
    [unit]
	type=Wolf Rider
	[modifications]
	    {TRAIT_QUICK}
	    {TRAIT_STRONG}
	[/modifications]
	side={F2}
	x=7
	y=20
    [/unit]
    [unit]
	type=Wolf Rider
	[modifications]
	    {TRAIT_QUICK}
	    {TRAIT_STRONG}
	[/modifications]
	side={F2}
	x=9
	y=20
    [/unit]
    [unit]
	type=Orcish Leader
	[modifications]
	    {TRAIT_QUICK}
	    {TRAIT_STRONG}
	[/modifications]
	side={F2}
	x=11
	y=20
    [/unit]
    [unit]
	type=Young Ogre
	[modifications]
	    {TRAIT_QUICK}
	    {TRAIT_STRONG}
	[/modifications]
	side={F2}
	x=13
	y=20
    [/unit]
    [unit]
	type=Orcish Grunt
	[modifications]
	    {TRAIT_QUICK}
	    {TRAIT_STRONG}
	[/modifications]
	side={F2}
	x=15
	y=20
    [/unit]
    [unit]
	type=Young Ogre
	[modifications]
	    {TRAIT_QUICK}
	    {TRAIT_STRONG}
	[/modifications]
	side={F2}
	x=17
	y=20
    [/unit]
    [unit]
	type=Orcish Archer
	[modifications]
	    {TRAIT_QUICK}
	    {TRAIT_STRONG}
	[/modifications]
	side={F2}
	x=19
	y=20
    [/unit]
#enddef

#define BLACKFANG_ARMY_WAVE_02
    [message]
	id=Kirielle the Realist
	message= _ "They're using ogres to pile boulders up in the moat, to make it easier for their troops to cross! Blackfang is quite clever for an orc."
    [/message]
		
    [music]
	name=the_city_falls.ogg
	immediate=yes
    [/music]
    [music]
    name=casualties_of_war.ogg
    append=yes
    [/music]
		
    [unit]
	type=Ogre
	[modifications]
	    {TRAIT_RESILIENT}
	    {TRAIT_STRONG}
	[/modifications]
	side={F2}
	x=2
	y=17
    [/unit]
    [unit]
	type=Ogre
	[modifications]
	    {TRAIT_RESILIENT}
	    {TRAIT_STRONG}
	[/modifications]
	side={F2}
	x=19
	y=18
    [/unit]
    
    [terrain]
	x=2
	y=16
	terrain=Wwf
    [/terrain]
    [terrain]
	x=19
	y=16
	terrain=Wwf
    [/terrain]
    [terrain]
	x=19
	y=17
	terrain=Wwf
    [/terrain]
    
    [sound]
		name=water-blast.wav
	[/sound]
    
    [redraw]
    [/redraw]
    
{PLACE_IMAGE terrain/embellishments/stones-small.png 2 16}
{PLACE_IMAGE terrain/embellishments/stones-small2.png 19 16}
{PLACE_IMAGE terrain/embellishments/stones-small3.png 19 17}
		
    [terrain]
        x=18
        y=16
        terrain=Wwf
    [/terrain]
    [terrain]
        x=3
        y=16
        terrain=Wwf
    [/terrain]
    [terrain]
        x=3
        y=17
        terrain=Wwf
    [/terrain]
    
    [sound]
		name=water-blast.wav
	[/sound]
    
    [redraw]
    [/redraw]

{PLACE_IMAGE terrain/embellishments/stones-small4.png 18 16}
{PLACE_IMAGE terrain/embellishments/stones-small5.png 3 16}
{PLACE_IMAGE terrain/embellishments/stones-small6.png 3 17}    

    
    
#enddef

#define BLACKFANG_ARMY_WAVE_03
    [message]
	speaker=narrator
	message= _ "It seems the orcs have hired naga mercenaries. They're trying to flank you!"
        image=wesnoth-icon.png
    [/message]
    [unit]
	type=Naga Fighter
	[modifications]
	    {TRAIT_RESILIENT}
	    {TRAIT_STRONG}
	[/modifications]
	side={F2}
	x=1
	y=1
    [/unit]
    [unit]
	type=Naga Fighter
	[modifications]
	    {TRAIT_RESILIENT}
	    {TRAIT_STRONG}
	[/modifications]
	side={F2}
	x=1
	y=3
    [/unit]
    [unit]
	type=Naga Fighter
	[modifications]
	    {TRAIT_RESILIENT}
	    {TRAIT_STRONG}
	[/modifications]
	side={F2}
	x=1
	y=5
    [/unit]
    [unit]
	type=Naga Fighter
	[modifications]
	    {TRAIT_RESILIENT}
	    {TRAIT_STRONG}
	[/modifications]
	side={F2}
	x=20
	y=1
    [/unit]
    [unit]
	type=Naga Fighter
	[modifications]
	    {TRAIT_RESILIENT}
	    {TRAIT_STRONG}
	[/modifications]
	side={F2}
	x=20
	y=3
    [/unit]
    [unit]
	type=Naga Fighter
	[modifications]
	    {TRAIT_RESILIENT}
	    {TRAIT_STRONG}
	[/modifications]
	side={F2}
        x=20
	y=5
    [/unit]
#enddef

#define BLACKFANG_ARMY_WAVE_04
    [message]
	speaker=narrator
	message= _ "It seems that the earlier attacks were only designed to test your defenses. The vanguard of the orcish army has finally arrived. They march toward the fort, shoulder to shoulder, for as far as the eye can see. You may be in trouble."
        image=wesnoth-icon.png
    [/message]
    [unit]
	type=Orcish Assassin
	[modifications]
	    {TRAIT_RESILIENT}
	    {TRAIT_STRONG}
	[/modifications]
	side={F2}
	x=1
	y=20
    [/unit]
    [unit]
	type=Orcish Grunt
	[modifications]
	    {TRAIT_RESILIENT}
	    {TRAIT_STRONG}
	[/modifications]
	side={F2}
	x=2
	y=20
    [/unit]
    [unit]
	type=Orcish Assassin
	[modifications]
	    {TRAIT_RESILIENT}
	    {TRAIT_STRONG}
	[/modifications]
	side={F2}
	x=3
	y=20
    [/unit]
    [unit]
	type=Orcish Archer
	[modifications]
	    {TRAIT_RESILIENT}
	    {TRAIT_STRONG}
	[/modifications]
	side={F2}
	x=4
	y=20
    [/unit]
    [unit]
	type=Orcish Leader
	[modifications]
	    {TRAIT_RESILIENT}
	    {TRAIT_STRONG}
	[/modifications]
	side={F2}
	x=5
	y=20
    [/unit]
    [unit]
	type=Wolf Rider
	[modifications]
	    {TRAIT_RESILIENT}
	    {TRAIT_STRONG}
	[/modifications]
	side={F2}
	x=6
	y=20
    [/unit]
    [unit]
	type=Orcish Grunt
	[modifications]
	    {TRAIT_RESILIENT}
	    {TRAIT_STRONG}
	[/modifications]
	side={F2}
	x=7
	y=20
    [/unit]
    [unit]
	type=Orcish Grunt
	[modifications]
	    {TRAIT_RESILIENT}
	    {TRAIT_STRONG}
	[/modifications]
	side={F2}
	x=8
	y=20
    [/unit]
    [unit]
	type=Young Ogre
	[modifications]
	    {TRAIT_RESILIENT}
	    {TRAIT_STRONG}
	[/modifications]
	side={F2}
	x=9
	y=20
    [/unit]
    [unit]
	type=Orcish Assassin
	[modifications]
	    {TRAIT_RESILIENT}
	    {TRAIT_STRONG}
	[/modifications]
	side={F2}
	x=10
	y=20
    [/unit]
    [unit]
	type=Wolf Rider
	[modifications]
	    {TRAIT_RESILIENT}
	    {TRAIT_STRONG}
	[/modifications]
	side={F2}
	x=11
	y=20
    [/unit]
    [unit]
	type=Orcish Leader
	[modifications]
	    {TRAIT_RESILIENT}
	    {TRAIT_STRONG}
	[/modifications]
	side={F2}
	x=12
	y=20
    [/unit]
    [unit]
	type=Orcish Archer
	[modifications]
	    {TRAIT_RESILIENT}
	    {TRAIT_STRONG}
	[/modifications]
	side={F2}
	x=13
	y=20
    [/unit]
    [unit]
	type=Orcish Grunt
	[modifications]
	    {TRAIT_RESILIENT}
	    {TRAIT_STRONG}
	[/modifications]
	side={F2}
	x=14
	y=20
    [/unit]
    [unit]
	type=Wolf Rider
	[modifications]
	    {TRAIT_RESILIENT}
	    {TRAIT_STRONG}
	[/modifications]
	side={F2}
	x=15
	y=20
    [/unit]
    [unit]
	type=Orcish Grunt
	[modifications]
	    {TRAIT_RESILIENT}
	    {TRAIT_STRONG}
	[/modifications]
	side={F2}
	x=16
	y=20
    [/unit]
    [unit]
	type=Orcish Archer
	[modifications]
	    {TRAIT_RESILIENT}
	    {TRAIT_STRONG}
	[/modifications]
	side={F2}
	x=17
	y=20
    [/unit]
    [unit]
	type=Young Ogre
	[modifications]
	    {TRAIT_RESILIENT}
	    {TRAIT_STRONG}
	[/modifications]
	side={F2}
	x=18
	y=20
    [/unit]
    [unit]
	type=Orcish Assassin
	[modifications]
	    {TRAIT_RESILIENT}
	    {TRAIT_STRONG}
	[/modifications]
	side={F2}
	x=19
	y=20
    [/unit]
    [unit]
	type=Orcish Grunt
	[modifications]
	    {TRAIT_RESILIENT}
	    {TRAIT_STRONG}
	[/modifications]
	side={F2}
	x=20
	y=20
    [/unit]
#enddef

#define BLACKFANG_ARMY_WAVE_05
    [unit]
	type=Orcish Crossbowman
	[modifications]
	    {TRAIT_RESILIENT}
	    {TRAIT_INTELLIGENT}
	[/modifications]
	side={F2}
	x=1
	y=20
    [/unit]
    [unit]
	type=Goblin Knight
	[modifications]
	    {TRAIT_RESILIENT}
	    {TRAIT_INTELLIGENT}
	[/modifications]
	side={F2}
	x=2
	y=20
    [/unit]
    [unit]
	type=Orcish Crossbowman
	[modifications]
	    {TRAIT_RESILIENT}
	    {TRAIT_INTELLIGENT}
	[/modifications]
	side={F2}
	x=3
	y=20
    [/unit]
    [unit]
	type=Orcish Warrior
	[modifications]
	    {TRAIT_RESILIENT}
	    {TRAIT_INTELLIGENT}
	[/modifications]
	side={F2}
	x=4
	y=20
    [/unit]
    [unit]
	type=Ogre
	[modifications]
	    {TRAIT_RESILIENT}
	    {TRAIT_INTELLIGENT}
	[/modifications]
	side={F2}
	x=5
	y=20
    [/unit]
    [unit]
        type=Orcish Slayer
        [modifications]
	    {TRAIT_RESILIENT}
	    {TRAIT_INTELLIGENT}
        [/modifications]
        side={F2}
        x=6
	y=20
    [/unit]
    [unit]
	type=Orcish Warrior
	[modifications]
	    {TRAIT_RESILIENT}
	    {TRAIT_INTELLIGENT}
	[/modifications]
	side={F2}
	x=7
	y=20
    [/unit]
    [unit]
	type=Goblin Knight
	[modifications]
	    {TRAIT_RESILIENT}
	    {TRAIT_INTELLIGENT}
	[/modifications]
	side={F2}
	x=8
	y=20
    [/unit]
    [unit]
	type=Orcish Crossbowman
	[modifications]
	    {TRAIT_RESILIENT}
	    {TRAIT_INTELLIGENT}
	[/modifications]
	side={F2}
	x=9
	y=20
    [/unit]
    [unit]
	type=Orcish Sovereign
	id=Blackfang
	name= _ "Blackfang"
	[modifications]
	    {TRAIT_RESILIENT}
	    {TRAIT_INTELLIGENT}
	[/modifications]
	side={F2}
	x=10
	y=20
    [/unit]
    [unit]
	type=Orcish Warrior
	[modifications]
	    {TRAIT_RESILIENT}
	    {TRAIT_INTELLIGENT}
	[/modifications]
	side={F2}
	x=11
	y=20
    [/unit]
    [unit]
	type=Ogre
	[modifications]
	    {TRAIT_RESILIENT}
	    {TRAIT_INTELLIGENT}
	[/modifications]
	side={F2}
	x=12
	y=20
    [/unit]
    [unit]
	type=Orcish Slayer
	[modifications]
	    {TRAIT_RESILIENT}
	    {TRAIT_INTELLIGENT}
	[/modifications]
	side={F2}
	x=13
	y=20
    [/unit]
    [unit]
	type=Orcish Warrior
	[modifications]
	    {TRAIT_RESILIENT}
	    {TRAIT_INTELLIGENT}
	[/modifications]
	side={F2}
	x=14
	y=20
    [/unit]
    [unit]
	type=Orcish Crossbowman
	[modifications]
	    {TRAIT_RESILIENT}
	    {TRAIT_INTELLIGENT}
	[/modifications]
	side={F2}
	x=15
	y=20
    [/unit]
    [unit]
        type=Goblin Knight
        [modifications]
	    {TRAIT_RESILIENT}
	    {TRAIT_INTELLIGENT}
        [/modifications]
        side={F2}
        x=16
        y=20
    [/unit]
    [unit]
        type=Ogre
        [modifications]
	    {TRAIT_RESILIENT}
	    {TRAIT_INTELLIGENT}
        [/modifications]
        side={F2}
        x=17
        y=20
    [/unit]
    [unit]
	type=Orcish Warrior
	[modifications]
	    {TRAIT_RESILIENT}
	    {TRAIT_INTELLIGENT}
	[/modifications]
	side={F2}
	x=18
	y=20
    [/unit]
    [unit]
	type=Orcish Crossbowman
	[modifications]
	    {TRAIT_RESILIENT}
	    {TRAIT_INTELLIGENT}
	[/modifications]
	side={F2}
	x=19
	y=20
    [/unit]
    [unit]
	type=Orcish Slayer
	[modifications]
	    {TRAIT_RESILIENT}
	    {TRAIT_INTELLIGENT}
	[/modifications]
	side={F2}
	x=20
	y=20
    [/unit]
    [music]
	name=northerners.ogg
	immediate=yes
    [/music]
#enddef

#define BLACKFANG_ARMY_WAVE_06
    [unit]
	type=Orcish Sovereign
	id=Blackfang
	name= _ "Blackfang"
	{IS_HERO}
	[modifications]
	    {TRAIT_RESILIENT}
	    {TRAIT_INTELLIGENT}
	[/modifications]
	side={F2}
	x=10
	y=19
    [/unit]
    [unit]
	type=Direwolf Rider
        [modifications]
	    {TRAIT_STRONG}
	    {TRAIT_QUICK}
	[/modifications]
	side={F2}
	x=9
	y=20
    [/unit]
    [unit]
	type=Direwolf Rider
	[modifications]
	    {TRAIT_STRONG}
            {TRAIT_QUICK}
	[/modifications]
	side={F2}
	x=11
	y=20
    [/unit]
    [message]
	id=Blackfang
	message= _ "Hah, what a bloodbath! Rally to me, men! We finish them now!"
    [/message]
#enddef

#define SUDDEN_STRIKE
    [if]
        [variable]
	    name=sudden_strike
	    numerical_equals=1
        [/variable]
    [then]
        [message]
	    speaker=narrator
 	    message= _ "Naga mercenaries suddenly emerge from the town well!"
	    image=wesnoth-icon.png
        [/message]
        [unit]
            type=Naga Warrior
	    [modifications]
	        {TRAIT_RESILIENT}
	        {TRAIT_STRONG}
	    [/modifications]
	    side={F2}
	    x=6
	    y=6
        [/unit]
        [unit]
            type=Naga Fighter
	    [modifications]
	        {TRAIT_RESILIENT}
	        {TRAIT_STRONG}
	    [/modifications]
	    side={F2}
	    x=6
	    y=5
        [/unit]
        [unit]
	    type=Naga Fighter
	    [modifications]
	        {TRAIT_RESILIENT}
	        {TRAIT_STRONG}
	    [/modifications]
	    side={F2}
	    x=7
	    y=6
        [/unit]
        [unit]
	    type=Naga Fighter
	    [modifications]
	        {TRAIT_RESILIENT}
	        {TRAIT_STRONG}
	    [/modifications]
	    side={F2}
	    x=7
	    y=7
        [/unit]
        [unit]
            type=Naga Fighter
 	    [modifications]
	        {TRAIT_RESILIENT}
	        {TRAIT_STRONG}
            [/modifications]
	    side={F2}
	    x=6
	    y=7
        [/unit]
        [unit]
	    type=Naga Fighter
	    [modifications]
	        {TRAIT_RESILIENT}
	        {TRAIT_STRONG}
	    [/modifications]
	    side={F2}
	    x=5
	    y=7
        [/unit]
        [unit]
	    type=Naga Fighter
	    [modifications]
	        {TRAIT_RESILIENT}
	        {TRAIT_STRONG}
	    [/modifications]
	    side={F2}
	    x=5
	    y=6
        [/unit]
    [/then]
    [else]
	[message]
	    speaker=narrator
	    message= _ "A necromancer and his minions suddenly burst out of the town crypt! It seems they, too, are in the pay of the orcs."
            image=wesnoth-icon.png
	[/message]
	[unit]
	    type=Dark Sorcerer
	    [modifications]
		{TRAIT_RESILIENT}
		{TRAIT_STRONG}
	    [/modifications]
	    side={F2}
	    x=14
	    y=6
	[/unit]
	[unit]
	    type=Walking Corpse
	    side={F2}
	    x=13
	    y=6
	[/unit]
	[unit]
	    type=Ghoul
	    side={F2}
	    x=14
	    y=5
	[/unit]
	[unit]
	    type=Walking Corpse
	    side={F2}
	    x=15
	    y=6
	[/unit]
	[unit]
	    type=Walking Corpse
	    side={F2}
	    x=15
	    y=7
        [/unit]
	[unit]
	    type=Ghoul
	    side={F2}
	    x=14
	    y=7
	[/unit]
	[unit]
	    type=Walking Corpse
	    side={F2}
	    x=13
	    y=7
	[/unit]
    [/else]
    [/if]
#enddef

     # ===================================================================================================================== #
     # SCENARIO
     # ===================================================================================================================== #

[multiplayer]
#textdomain wesnoth-Ooze_Mini_Campaign
name= _ "Pinewood Siege"
id=4_mp_Pinewood_Siege
next_scenario=null
experience_modifier=100

allow_new_game=no
map_data="{~add-ons/Ooze_Mini_Campaign/maps/Fort_Pinewood.map}"
{SCENARIO_MUSIC "revelation.ogg"}
{EXTRA_SCENARIO_MUSIC "weight_of_revenge.ogg"}

turns=-1
victory_when_enemies_defeated=no

{FIRST_WATCH}
{SECOND_WATCH}
{DAWN}
{MORNING}
{AFTERNOON}
{DUSK}

{PLACE_IMAGE scenery/leanto.png 3 7}
{PLACE_IMAGE scenery/signpost.png 11 18}
{PLACE_IMAGE scenery/temple1.png 14 6}
{PLACE_IMAGE scenery/tent-fancy-red.png 18 7}
{PLACE_IMAGE scenery/well.png 6 6}
{PLACE_IMAGE items/archery-target-right.png 17 9}
{PLACE_IMAGE items/archery-target-right.png 18 9}
{PLACE_IMAGE items/scarecrow.png 16 3}
{PLACE_IMAGE Items/oldbarrel.png 3 6}
#{PLACE_IMAGE items/barrel.png 3 6}
{PLACE_IMAGE items/gohere.png 17 12}

     # ===================================================================================================================== #
     # SIDE DEFINITION
     # ===================================================================================================================== #

[side]
    side={P1}
    controller=human
    id=Master Ooze
    save_id=Ooze
    name= _ "Master Ooze"
    type=Elvish Shaman Ooze
    fog=no
    canrecruit=yes
    recruit=Peasant, Woodsman, Ruffian
    team_name=oozes
    gold=25	
[/side]

[side]
    side={P2}
    controller=human
    id=Master Ooze 2
    save_id=Ooze2
    name= _ "Master Ooze 2"
    type=Elvish Fighter
    fog=no
    canrecruit=yes
    recruit=Peasant, Woodsman, Ruffian
    team_name=oozes
    gold=25
[/side]
	
[side]
    side={F1}
    controller=ai
    allow_player=no
    no_leader=yes
    gold=0

    [ai]
        aggression=0.8
	leader_value=3
	village_value=1
	grouping=defensive
	caution=1.0
	recruitment_pattern=fighter
	passive_leader=yes
	ai_algorithm=idle_ai
    [/ai]
    team_name=oozes
[/side]
	
[side]
    side={F2}
    controller=ai
    allow_player=no
    no_leader=yes
    team_name=enemies
    color=black
    [ai]
	aggression=1.0
	leader_value=2
	village_value=1
	grouping=yes
	caution=0.0
	recruitment_pattern=scout
    [/ai]
[/side]

[event]
    name=preload
    first_time_only=no

    [if]
        [variable]
	    name=shady_dead
	    numerical_equals=0
        [/variable]
    [then]
        [capture_village] 
	    x=17
	    y=13
	    side={P1}
        [/capture_village]	
    [/then]
    [/if]
[/event]

[event]
    name=prestart
    [objectives]
	side={P1}
	[objective]
	    description= _ "Defend the Fort"
	    condition=win
	[/objective]
	[objective]
	    description= _ "Death of the Master Ooze"
	    condition=lose
	[/objective]
        [objective]
            description= _ "Death of the Master Ooze 2"
	    condition=lose
        [/objective]
    [/objectives]

    [objectives]
	side={P2}
	[objective]
	    description= _ "Defend the Fort"
	    condition=win
	[/objective]
	[objective]
	    description= _ "Death of the Master Ooze"
	    condition=lose
	[/objective]
        [objective]
            description= _ "Death of the Master Ooze 2"
	    condition=lose
        [/objective]
    [/objectives]

    {CREATE_SOLID_LEADERS}

    [terrain]
	x=10
	y=19
	terrain=Re
    [/terrain]
    [terrain]
	x=12
	y=18
	terrain=Gg
    [/terrain]

    [teleport]
	[filter]
	    id=Master Ooze
	[/filter]
	x=10
	y=10
    [/teleport]

    [teleport]
	[filter]
	    id=Master Ooze 2
	[/filter]
	x=10
	y=5
    [/teleport]

[/event]
	
[event]
    name=start

     # ===================================================================================================================== #
     # VARIABLE INITIALIZATION
     # ===================================================================================================================== #

    {INITIALIZE_VARIABLES}

     # ===================================================================================================================== #
     # PICK SCENARIO EVENTS
     # ===================================================================================================================== #
     # NOTE:
     # Adding to scenario even the smolest random element makes game less predictiable and more intresting. To avoid 
     # possible spikes better set them all in one place at beginning
     # ===================================================================================================================== #

    {RANDOMIZE_SCENARIO}

     # ===================================================================================================================== #
     # DEFENDER UNITS
     # ===================================================================================================================== #
     # NOTE:
     # Defenders will unconditionally TAKE a part in upcoming battle. However who will command them depends on player 
     # decisions from previous scenario
     # ===================================================================================================================== #

    {TOWNSFOLK}
    {FORM_DEFENDER_FORCES}

    [message]
        speaker=narrator
        message= _ "That night there is a commotion at the Mayor's Manor."
        image=wesnoth-icon.png
    [/message]

    {BLACKFANG_ARMY_WAVE_01}

    [message]
	speaker=narrator
	image=units/orcs/assassin.png
	message= _ "An orcish assassin has snuck into town and poisoned the Mayor and his bodyguards! Meanwhile a massive horde of orcs surges out of the wilderness and surrounds the fort. They clearly intend to sack the leaderless human town and kill everyone within it."
    [/message]
    [message]
	id=Master Ooze
	message= _ "(You realize that you have no choice but to try and unite the leaderless Solids and drive back the orcs)." 
    [/message]
    [message]
	id=Jedd
	message= _ "Oh we're doomed, doomed! There's hundreds of orcs! There is no hope." 
    [/message]
    [message]
	id=Master Ooze
	message= _ "I will organize the fort's defense if others will follow me." 
    [/message]
    [message]
	id=Frist
	message= _ "Aye lass, I'll follow ye to the Hells and back! Yer the most talented student I ever had!" 
    [/message]
    [message]
	id=Sergeant Ryn
	message= _ "Count me in as well." 
    [/message]
    [message]
	id=Master Ooze 2
	message= _ "Come on citizens of Pinewood, let's give these orcs a lesson they won't forget!" 
    [/message]
    [message]
	id=Brock
	message= _ "No damned orc is gonna get his filthy claws on my tavern!" 
    [/message]
    [message]
	id=Valin
	message= _ "Let COURAGE be our vanguard and DOUBT our whipping-boy! To GLORY!" 
    [/message]
    [message]
	id=Kirielle the Realist
	message= _ "Looks like our quarry has come to us." 
    [/message]
    [message]
	id=Bryony the Idealist
	message= _ "You're sure this is Blackfang's army?" 
    [/message]
    [message]
	id=Kirielle the Realist
	message= _ "Yeah, you can tell by their battle standards." 
    [/message]
    [message]
	id=Bryony the Idealist
	message= _ "There sure are a lot of them. I assume you have some sort of plan?" 
    [/message]
    [message]
	id=Kirielle the Realist
	message= _ "Just follow the so-called elven sorceress for now." 
    [/message]
    [message]
	id=Bryony the Idealist
	message= _ "What do you mean 'so-called sorceress'?! She is a sorceress!" 
    [/message]
    [message]
	id=Kirielle the Realist
	message= _ "Bryony, how many times have I told you that what appears to be true and what is actually true can be two very different things? I was planning to kill the creature but now it may be of use to us." 
    [/message]
    [message]
	id=Bryony the Idealist
	message= _ "What creature? Why do you always have to speak in riddles?" 
    [/message]
    [message]
	id=Kirielle the Realist
	message= _ "(Sigh) Just start shooting orcs, all right?" 
    [/message]

     # ===================================================================================================================== #
     # VOLUNTEER UNITS
     # ===================================================================================================================== #
     # NOTE: 
     # Volunter units MAY take a part in upcoming battle. However this depends on player actions taken in previous scenario
     # ===================================================================================================================== #

    {FORM_VOLUNTEER_FORCES}

     # ===================================================================================================================== #
     # CAPTURE VILLAGES
     # ===================================================================================================================== #
     # This step should be taken unconditionally after placing units on the map since we don't know to whom they belong to.
     # However villages are already assigned to sides. If we do otherwise we just capture village for owner of a unit!
     # ===================================================================================================================== #

    [capture_village] 
	x=6
	y=8
	side={P1}
    [/capture_village]
    [capture_village] 
	x=4
	y=3
	side={P1}
    [/capture_village]
    [capture_village] 
	x=16
	y=6
	side={P1}
    [/capture_village]
    [capture_village] 
	x=16
	y=10
	side={P1}
    [/capture_village]
    [capture_village] 
	x=17
	y=13
	side={P1}
    [/capture_village]

    [capture_village] 
	x=3
	y=11
	side={P2}
    [/capture_village]
    [capture_village] 
	x=6
	y=4
	side={P2}
    [/capture_village]
    [capture_village] 
	x=14
	y=4
	side={P2}
    [/capture_village]
    [capture_village] 
	x=14
	y=8
	side={P2}
    [/capture_village]
    [capture_village] 
	x=14
	y=12
	side={P2}
    [/capture_village]

[/event]

     # ===================================================================================================================== #
     # BATTLE
     # ===================================================================================================================== #
     # In this section are described all battle events
     # ===================================================================================================================== #

[event]
    name=moveto
    first_time_only=yes
    [filter]
	side={P1}
	x=17
	y=12
    [/filter]
    {SHADY_INTRODUCTION {P1}}	
[/event]

[event]
    name=moveto
    first_time_only=yes
    [filter]
	side={P2}
	x=17
	y=12
    [/filter]
    {SHADY_INTRODUCTION {P2}}	
[/event]

[event]
    name=moveto
    first_time_only=no
    [filter]
	side={P1}
	x=17
	y=12
    [/filter]
    {SHADY_TRANSACTIONS {P1}}
[/event]

[event]
    name=moveto
    first_time_only=no
    [filter]
	side={P2}
	x=17
	y=12
    [/filter]
    {SHADY_TRANSACTIONS {P2}}
[/event]

[event]
    name=attack
    [filter]
        id=Guthry
    [/filter]
    [filter_second]
        id=$traitor_id
    [/filter_second]
    [if]
        [variable]
            name=dryad_friend
            greater_than=0
        [/variable]
    [then]
        [message]
            id=Guthry
            message= _ "No one crosses me and gets away with it!"
        [/message]
    [/then]
    [/if]
[/event]

[event]
    name=turn 2
    {BLACKFANG_ARMY_WAVE_02}		
[/event]

[event]
    name=turn 5
    {BLACKFANG_ARMY_WAVE_03}
[/event]

[event]
    name=side {P1} turn 5
    {GUTHRY_EAGER {P1}}
[/event]

[event]
    name=side {P2} turn 5
    {GUTHRY_EAGER {P2}}
[/event]

[event]
    name=turn 10
    {BLACKFANG_ARMY_WAVE_04}
[/event]

[event]
    name=turn 15
    {SUDDEN_STRIKE}
[/event]

[event]
    name=turn 20
    {BLACKFANG_ARMY_WAVE_05}
		
    [message]
	speaker=narrator
	message= _ "The ranks of the orc horde part momentarily to make way for the largest orc you have ever seen. His black spiked armor and sword mark him as Blackfang, leader of the Black Horde."
        image=wesnoth-icon.png
    [/message]
    [message]
	id=Blackfang
	message= _ "Blackfang IS HERE!!!"
    [/message]
    [message]
	speaker=narrator
	message= _ "The orcs cheer and howl in applause, waving tattered banners in homage to their brutal leader."
	image=wesnoth-icon.png
    [/message]
    [message]
	id=Blackfang
	message= _ "Already this fort's defenses are wavering, and I haven't even sent in my veterans yet. How pathetic. If I'd known it would be this easy to raze Pinewood, I'd have attacked months ago!"
    [/message]
    [message]
	id=Blackfang
	message= _ "Well troops, you know the drill: Kill everyone. Destroy everything. The orc who brings me their leader's head on a pike gets an immediate promotion!"
    [/message]
    [message]
	id=Master Ooze
	message= _ "This is impossible! There's just too many of them and not enough of us!"
    [/message]

    {IMPERIAL_ARMY_SUPPORT}
	
    [message]
	speaker=narrator
	message= _ "Suddenly a small formation of Imperial calvary appears on the horizon! They smash through a platoon of orcish infantry and reach the north side of the fort! The surviving townsfolk are beside themselves with joy."
	image=wesnoth-icon.png
    [/message]
    [message]
	id=Blackfang
	message= _ "How annoying! Leave it to the Imperial Army to show up and ruin a perfectly good day."
    [/message]
    [message]
	id=Captain Koltz
	message= _ "Looks like we arrived just in time! Are you in charge here?"
    [/message]
    [message]
	id=Master Ooze
	message= _ "Yes."
    [/message]
    [message]
	id=Captain Koltz
	message= _ "I'm Captain Koltz, 5th Imperial Cavalry Troop, at your service. You should know that an Imperial Councilman is also on his way to assist in the defense of the fort. He's bringing his personal bodyguards with him. I'm not sure if he'll arrive by the time the battle is finished though."
    [/message]
    [message]
	id=Captain Koltz
	message= _ "We cut our way through some of the orcs besieging the fort, but it looks like orcish reinforcements have already closed the gap we made. Looks like we're stuck here with you."
    [/message]
    [message]
	id=Master Ooze
	message= _ "Yes, I'm afraid it's going to be a fight to the finish."
    [/message]
    [message]
	id=Captain Koltz
	message= _ "We're outnumbered at least twenty to one, but perhaps if we kill the orcish leader we'll be able to escape the fort in the ensuing chaos."
    [/message]
    [message]
	id=Master Ooze
	message= _ "There hasn't been an opportunity to strike at Blackfang directly yet."
    [/message]
    [message]
	id=Captain Koltz
	message= _ "Then we must bide our time and conserve our numbers. If we kill enough orcs, Blackfang might be goaded into personally leading his troops in battle. That will be our time to strike."
    [/message]

    [kill]
	id=Blackfang
    [/kill]
[/event]

[event]
    name=turn 25
    {BLACKFANG_ARMY_WAVE_06}
[/event]

[event]
    name=last breath

    [filter]
	id=Blackfang
    [/filter]

    [message]
	speaker=unit
	message= _ "Hragh! How could I be beaten by someone so pathetic?"
    [/message]

    [kill]
	side={F2}
    [/kill]

    {VARIABLE battle_stage 1}

    [message]
	speaker=narrator
	message= _ "The orcs, demoralized by the death of their leader, flee the battlefield! You are victorious!"
	image=wesnoth-icon.png
    [/message]
    [message]
	speaker=narrator
	message= _ "The defenders let out a ragged cheer as the last orcs disappear over the horizon. Slain orcs, smoldering fires, and broken weapons lie everywhere. Against impossible odds you saved Fort Pinewood from the Black Horde! Bards will surely sing praises of your heroism for generations to come!"
	image=wesnoth-icon.png
    [/message]
    [message]
	speaker=narrator
	message= _ "The bloodied, weary townsfolk begin to turn to the task of helping the wounded and repairing the extensive damage to the fort. More Imperial reinforcements arrive, too late to affect the outcome of the battle. But you soon realize that these newcomers are not normal Imperial soldiers."
	image=wesnoth-icon.png
    [/message]

    {IMPERIAL_ARMY_FORCES}

    [teleport]
	[filter]
	    x,y=10,5
	[/filter]
	x=16
	y=3
    [/teleport]
    [teleport]
	[filter]
	    x,y=9,5
	[/filter]
	x=15
	y=3
    [/teleport]
    [teleport]
	[filter]
	    x,y=10,4
	[/filter]
	x=16
	y=2
    [/teleport]
    [teleport]
	[filter]
	    x,y=11,5
	[/filter]
	x=17
	y=3
    [/teleport]
    [teleport]
	[filter]
	    x,y=9,6
	[/filter]
	x=15
	y=4
    [/teleport]
    [teleport]
	[filter]
	    x,y=10,6
	[/filter]
	x=16
	y=4
    [/teleport]
    [teleport]
	[filter]
	    x,y=11,6
	[/filter]
	x=17
	y=4
    [/teleport]

    [teleport]
	[filter]
	    x,y=10,10
	[/filter]
	x=4
	y=8
    [/teleport]
    [teleport]
	[filter]
	    x,y=9,10
	[/filter]
	x=3
	y=8
    [/teleport]
    [teleport]
	[filter]
	    x,y=10,9
	[/filter]
	x=4
	y=7
    [/teleport]
    [teleport]
	[filter]
	    x,y=11,10
	[/filter]
	x=5
	y=8
    [/teleport]
    [teleport]
	[filter]
	    x,y=9,11
	[/filter]
	x=3
	y=9
    [/teleport]
    [teleport]
	[filter]
	    x,y=10,11
	[/filter]
	x=4
	y=9
    [/teleport]
    [teleport]
	[filter]
	    x,y=11,11
	[/filter]
	x=5
	y=9
    [/teleport]

    [teleport]
	[filter]
	    id=Master Ooze
	[/filter]
	x=10
	y=5
    [/teleport]

    [teleport]
	[filter]
	    id=Master Ooze 2
	[/filter]
	x=10
	y=10
    [/teleport]

    {VARIABLE idle_mode 1}
    
    [end_turn]
    [/end_turn]
[/event]

     # ===================================================================================================================== #
     # FINAL BATTLE
     # ===================================================================================================================== #
     # In this section are described final story twists. Choices taken by player in this moment have greatest impact at
     # campaign ending.
     # ===================================================================================================================== #
	
[event]
    name=side {P1} turn
    first_time_only=no
    [if]
        [variable]
            name=battle_stage
            numerical_equals=1
        [/variable]
        [and]
            [variable]
                name=imperial_mage_talk
                less_than=1
            [/variable]
        [/and]
    [then]
        {VARIABLE imperial_mage_talk 1}
        [message]
	    id=Imperial Mage
	    message= _ "(Gazes calmly at the the wrecked fort) Ah Pinewood. I remember when this place was nothing more than a few huts by a trade crossroads. It's good to be back!"
        [/message]
        [message]
	    id=Master Ooze
	    message= _ "There will be time for nostalgia later, sir! We've got wounded soldiers that need help!"
        [/message]
        [message]
	    id=Imperial Mage
	    message= _ "(He seems to be talking to himself) It speaks, it speaks! Oh how wonderful! I feel like I've met the child I never knew I had!"
        [/message]
        [message]
	    id=Master Ooze
	    message= _ "(Is this man crazy?)"
        [/message]
        [message]
	    id=Imperial Mage
	    message= _ "Yes, yes, it was in my youth that I made you. A harmless pastime, really. To try to create Life itself is...difficult. Impossible perhaps? A thousand failures and finally my one success...you!"
        [/message]
        [message]
	    id=Master Ooze
	    message= _ "(You have a very odd feeling about this old man. You're certain you've never met him before yet he seems strangely familiar... )"
        [/message]
        [message]
	    id=Imperial Mage
	    message= _ "It took a bit of my life, my spirit, if you will, to finally do it. To give you life. Alas, urgent business at the Imperial Court called me away from my studies, all those years ago. But I never forgot about you, oh no!"
        [/message]
        [message]
	    id=Master Ooze
	    message= _ "(Did this man create you? Your memories of those early years in the ruined underground laboratory are hazy and vague...your mind is so much more clear and sharp since you've taken over the elf.)"
        [/message]
        [message]
	    id=Imperial Mage
	    message= _ "And look how you've grown, evolved! No longer a mere ooze, you've taken solid form! Your lifeforce has increased a hundredfold! You're my project, my baby, the object of so many countless hours of research...come forth and let me see you in your true form!"
        [/message]
        [message]
	    id=Master Ooze
	    message= _ "(Your Solid form shudders and spasms. Somehow the mage has magically compelled you to come out of your hiding place!)"
        [/message]
        [unit]
	    type=Giant Ooze
	    side={P1}
	    x=9
	    y=5
        [/unit]
        [unit]
	    type=Giant Ooze
	    side={P1}
	    x=10
  	    y=4
        [/unit]
        [unit]
	    type=Giant Ooze
	    side={P1}
	    x=11
	    y=5
        [/unit]
        [unit]
	    type=Giant Ooze
	    side={P1}
	    x=9
	    y=6
        [/unit]
        [unit]
	    type=Giant Ooze
	    side={P1}
	    x=10
  	    y=6
        [/unit]
        [unit]
	    type=Giant Ooze
	    side={P1}
	    x=11
	    y=6
        [/unit]
        [message]
	    id=Master Ooze 2
	    message= _ "(Strangely you feel that urge too. You double over and vomit up oozes!)"
        [/message]
        [unit]
	    type=Giant Ooze 2
	    side={P2}
	    x=9
	    y=10
        [/unit]
        [unit]
	    type=Giant Ooze 2
	    side={P2}
	    x=10
	    y=9
        [/unit]
        [unit]
	    type=Giant Ooze 2
	    side={P2}
	    x=11
	    y=10
        [/unit]
        [unit]
	    type=Giant Ooze 2
	    side={P2}
	    x=9
	    y=11
        [/unit]
        [unit]
	    type=Giant Ooze 2
	    side={P2}
	    x=10
	    y=11
        [/unit]
        [unit]
	    type=Giant Ooze 2
	    side={P2}
	    x=11
	    y=11
        [/unit]
        [message]
	    id=Master Ooze
	    message= _ "(You vomit up great quantities of slimy ooze! The townsfolk, who only moments ago looked upon you as their leader and savior, now look at you with revulsion and horror.)"
        [/message]
        [message]
	    id=Imperial Mage
	    message= _ "Oh, how beautiful you are... It seems that you even developed a second personality. Amazing! Some kind of sibling, perhaps? That's very interesting..."
        [/message]
        #Dialogue seems awkward. Replace with something else?
        #[message]
	    #id=Master Ooze 2
	    #message= _ "I'm no sibling. The only reason I vomited is because I always get really nauseous listening to self-important windbags like you."
        #[/message]
        #[message]
	    #id=Imperial Mage
	    #message= _ "Oh, and you even have a sense of humor! But since I can see that you're a little bored let's make a long story short."
        #[/message]
        [message]
	    id=Imperial Mage
	    message= _ "My work on the Imperial Council has kept me busy. However when I heard rumors of a disturbance in the Pinewood territories I somehow knew you were behind it. We are linked, born of one spirit."
        [/message]
        [message]
	    id=Imperial Mage
	    message= _ "What a terrible shame I'm going to have to kill you."
        [/message] 
        [music]
	    name=legends_of_the_north.ogg
	    immediate=yes
        [/music]
        [message]
	    id=Imperial Mage
	    message= _ "In truth you're a victim of your own success. By eating hundreds of creatures you've greatly increased your size and lifeforce. Now I will take that lifeforce back into myself, becoming the most powerful mage ever! Not even the Emperor will be able to stand against me!"
        [/message]
        [message]
	    id=Master Ooze
	    message= _ "(How to respond?)"
	    [option]
	        message= _ "(Evil) If you can absorb my lifeforce then I can absorb yours! I'll devour you all!"
	        [command]
		    [message]
		        speaker=narrator
		        message= _ "Once you've eaten your Creator you will be complete! Your allies from Pinewood will no longer aid you, but it doesn't matter. During your time in Pinewood you've contaminated the local well with tiny pieces of yourself. The townsfolk unwittingly drank the contaminated water, and now the oozes that had lain dormant within them erupt! Cries of shock and agony resonate throughout the fort as you devour the townsfolk from the inside out! Although you can't absorb the allies of your companion ooze it's not important since he is a part of you."
		        image=wesnoth-icon.png
		    [/message]
                    {OOZE_INFECTION {P1} {P1}}
		    [message]
		        speaker=narrator
		        message= _ "Now you've got a lot more oozes with which to eat your Creator!"
		        image=wesnoth-icon.png
		    [/message]

		    [disallow_recruit]
		        side={P1}
		        type=Peasant,Ruffian,Woodsman
		    [/disallow_recruit]
		    [set_variable]
		        name=ooze_alignment_1
		        value=1
		    [/set_variable]
	        [/command]
	    [/option]
	    [option]
	        message= _ "(Good) Citizens of Pinewood, I may be a monster but this mage is the greater evil! He didn't come to Pinewood to save you, only to slay me and plot treason against the Empire!"
	        [command]
		    [message]
		        id=Sergeant Ryn
		        message= _ "Treason against the Empire can never be forgiven! The mage dies first, I'll hold judgement on the ooze creature for now."
		    [/message]
	            [message]
		        id=Alkar
		        message= _ "Whatever you are I owe you much and I will not abondon you."
		    [/message]
                    [if]
                        [variable]
                            name=fontaine_friend
                            greater_than=1
                        [/variable]
                    [then]
                        [message]
		            id=Fontaine
		            message= _ "My Patron... I don't know what you are... but I will continue to fight with you, for now at least."
		        [/message]
                    [/then]
                    [else]
                        [message]
		            id=Fontaine
		            message= _ "My Muse?! I...don't know what you are anymore...but I will continue to fight with you, for now at least."
		        [/message]
                    [/else]
                    [/if]
		    [message]
		        id=Ram Aide
		        message= _ "Oi! I've had waaay too many drinks! Now I'm see'n oozes come outta nowhere an' crazy wizards to boot!"
		    [/message]
		    [message]
                        id=Shady Character
		        message= _ "Don't worry, it's business as usual between us. I've sold weapons to far worse monsters than you, no offense."
		    [/message]
		    [message]
		        id=High Priest Jal
			message= _ "The shining light of Pelor will rain death and destruction upon those lacking in faith! The Imperial mage reeks of evil, the ooze less so. The mage will be slain first."
		    [/message]
		    [message]
		        id=Corinna
		        message= _ "Fascinating! I've always wanted to study a magic ooze creature. Oh yes, and after this Imperial mage is dead I'm definitely taking his spellbooks!"
		    [/message]
		    [message]
		        id=Sir Dryden
		        message= _ "Corinna is evil, the Empire is evil, now my elven benefactor is revealed as evil...so much evil in the world...Though I feel some evils may be redeemed, this mage is beyond salvation!"
		    [/message]
		    [message]
		        id=Jedd
		        message= _ "(Spits tobacco) Oh, a chance to kill a corrupt government official! I wouldn't miss this for the world!"
		    [/message]
		    [message]
		        id=Livius
		        message= _ "So this bastard mage thinks he can just waltz in here and 'absorb' my future culinary masterpiece?! Not on my watch!"
		    [/message]
		    [message]
		        id=Frist
		        message= _ "Ach, this is too complicated fer me ta figure out!"
		    [/message]
		    [message]
		        id=Valin
		        message= _ "KEIRON! You sir have lived the life of a COWARD and a TRAITOR! Now learn to die like a SOLDIER!"
		    [/message]
		    [message]
		        id=Brock
		        message= _ "If the ooze is supposed to be the bad guy, I guess that makes this Master Keiron fellow the REALLY bad guy!"
		    [/message]
		    [message]
		        id=Haffuz the Slaver
		        message= _ "Don't worry, the contract between us is still valid! I make it a point not to let my customers' inherent nastiness get in the way of making a hefty profit!"
		    [/message]
		    [message]
		        id=Dryad
		        message= _ "You're an abomination against Nature, ooze creature! Yet, Pinewood will be far worse off if the power-crazed Imperial traitors win the battle today. I will continue to help you...for now!"
		    [/message]
		    [message]
		        id=Kirielle the Realist
		        message= _ "I swore to the Elven Council that I'd put an end to Blackfang's depredations. Thanks to the ooze creature, Blackfang is no more. We'll continue helping the ooze creature for now."
		    [/message]
		    [message]
		        id=Bryony the Idealist
		        message= _ "If you say so Kirielle. I just wish things didn't always have to be so complicated."
		    [/message]

		    [set_variable]
		        name=ooze_alignment_1
		        value=2
		    [/set_variable]
	        [/command]
	    [/option]
        [/message]

        {CLEAR_VARIABLE idle_mode}
        [end_turn]
        [/end_turn]
    [/then]
    [/if]
[/event]

[event]
    name=side {P2} turn
    first_time_only=no
    [if]
        [variable]
            name=idle_mode
            numerical_equals=1
        [/variable]
    [then]
        [end_turn]
        [/end_turn]
    [/then]
    [else]
        [if]
            [variable]
                name=battle_stage
                numerical_equals=1
            [/variable]
            [and]
                [variable]
                    name=imperial_mage_talk
                    numerical_equals=1
                [/variable]
            [/and]
        [then]
            {VARIABLE imperial_mage_talk 2}
            #{IMMOBILZE false {P1}}
            #{IMMOBILZE false {P2}}
            [if]
                [variable]
                    name=ooze_alignment_1
                    numerical_equals=1
                [/variable]
            [then]
                [message]
                    id=Master Ooze 2
                    message= _ "Your allies stand in shock. It's hard for them to believe what just happened. It's time for your decision..."
                    [option]
                        message = _ "(Evil) At last we will become one!"
                        [command]
                            [message]
		                speaker=narrator
		                message= _ "Once you've eaten your Creator you will be complete! Your allies from Pinewood will no longer aid you, but it doesn't matter. During your time in Pinewood you've contaminated the local well with tiny pieces of yourself. The townsfolk unwittingly drank the contaminated water, and now the oozes that had lain dormant within them erupt!"
		                image=wesnoth-icon.png
		            [/message]
                            {OOZE_INFECTION {P2} {P2}}
		            [message]
		                speaker=narrator
		                message= _ "Now you've got a lot more oozes with which to eat your Creator!"
		                image=wesnoth-icon.png
		            [/message]

		            [disallow_recruit]
		                side={P2}
		                type=Peasant,Ruffian,Woodsman
		            [/disallow_recruit]

                            [set_variable]
		                name=ooze_alignment_2
		                value=1
		            [/set_variable]
                        [/command]
                    [/option]
                    [option]
                        message = _ "(Good) No, I won't do this."
                        [command]
                            [store_unit]
                                variable=ally
                                kill=no
                                [filter]
                                    side={P2}
                                    [not]
                                        type=Giant Ooze 2
                                    [/not]
                                    [not]
                                        id=Master Ooze 2
                                    [/not]
                                [/filter]
                            [/store_unit]
                            [message]
                                id=Master Ooze
                                message= _ "You won't do what?"
                            [/message]
                            [message]
                                id=Master Ooze 2
                                message= _ "I won't murder these innocent people. It's not right!"
                            [/message]
                            [message]
                                id=Master Ooze
                                message= _ "(Sighs) I knew it from the beginning. You are everything that was weak in me... That's why your consciousness stayed separate from mine. It's sad because I'd grown rather fond of you. Perhaps it's because our elven hosts were lovers and their memories were imprinted onto our own. Or perhaps it's because you're the only other sentient ooze I've encountered in all my many years of existence. But now I see that I'm better off alone. That which I cannot control cannot be trusted and must be destroyed."
                            [/message]
                            [message]
                                id=Master Ooze 2
                                message= _ "Citizens, together we can stand against this monstrosity!"
                            [/message]
                            [message]
                                id=$ally.id
                                message= _ "But you are the same! How can we trust you now?!"
                            [/message]
                            [message]
                                id=Master Ooze 2
                                message= _ "(You look deeply into Aurelia's eyes. You look for the part of her that your host loved...But now you see nothing but eternal hunger that can't be appeased...)"
                            [/message]
                            [message]
                                id=Master Ooze 2
                                message= _ "(After a long while you speak) It's not what we are, but what we do that defines us..."
                            [/message]
                            [message]
	                        id=Imperial Mage
	                        message= _ "How very touching. The star-crossed lovers are torn apart by the cruel whims of Fate! I think I just might commission a play based on your story. But for now killing you both will serve as theatrics enough!"
                            [/message]

                            [set_variable]
		                name=ooze_alignment_2
		                value=2
		            [/set_variable]
                            [unstore_unit]
                                variable=ally
                            [/unstore_unit]

                            {CLEAR_VARIABLE ally}
                        [/command]
                    [/option]
                [/message]   
            [/then]
            [else]
                [message]
                    id=Master Ooze 2
                    message= _ "Your allies await your leadership. Its time for your decision..."
                    [option]
                        message = _ "(Evil) No. All of you will be a part of ME!"
                        [command]
                            [store_unit]
                                variable=ally
                                kill=no
                                [filter]
                                    side={P1}
                                    [not]
                                        type=Giant Ooze
                                    [/not]
                                    [not]
                                       id=Master Ooze
                                    [/not]
                                [/filter]
                                [filter_second]
                                [/filter_second]
                            [/store_unit]
                            [message]
		                speaker=narrator
		                message= _ "Once you've eaten your Creator you will be complete! Your allies from Pinewood will no longer aid you, but it doesn't matter. During your time in Pinewood you've contaminated the local well with tiny pieces of yourself. The townsfolk unwittingly drank the contaminated water, and now the oozes that had lain dormant within them erupt! Cries of shock and agony resonate throughout the fort as you devour the townsfolk from the inside out! Unfortunately you can't absorb allies of your companion ooze."
		                image=wesnoth-icon.png
		            [/message]
                            {OOZE_INFECTION {P2} {P2}}
		            [message]
		                speaker=narrator
		                message= _ "Now you've got a lot more oozes with which to eat your Creator!"
		                image=wesnoth-icon.png
		            [/message]

		            [disallow_recruit]
		                side={P2}
		                type=Peasant,Ruffian,Woodsman
		            [/disallow_recruit]

                            [message]
                                id=Master Ooze
                                message= _ "(Looks at you with sadness in her eyes) Why do you do this?"
                            [/message]
                            [message]
                                id=Master Ooze 2
                                message= _ "The Solids are nothing but weak-willed fodder. Can't you see it? Their sole purpose in life is to serve as prey for predators like us."
                            [/message]
                            [message]
                                id=Master Ooze 2
                                message= _ "Die if you cannot understand! I will devour your weakness and become whole once again. There will be no more dissent, no more sympathy for our enemies. There will be only one voice, one mind, one ooze, one purpose, just as it was in the beginning!"
                            [/message]
                            [message]
                                id=Master Ooze
                                message= _ "Citizens! Please stand with me against my...companion. I fear he cannot be reasoned with."
                            [/message]
                            [message]
                                id=$ally.id
                                message= _ "But you are the same! How can we trust you now?!"
                            [/message]
                            [message]
                                id=Master Ooze
                                message= _ "(You look deeply into Sithras's eyes. You look for the part of him that your host loved...But now you see nothing but eternal hunger that can't be appeased...)" 
                            [/message]
                            [message]
                                id=Master Ooze
                                message= _ "(After a long while you speak) It's not what we are, but what we do that defines us..."
                            [/message]
                            [message]
	                        id=Imperial Mage
	                        message= _ "How very touching. The star-crossed lovers are torn apart by the cruel whims of Fate! I think I just might commission a play based on your story. But for now killing you both will serve as theatrics enough!"
                            [/message]
                            

                            [set_variable]
		                name=ooze_alignment_2
		                value=1
		            [/set_variable]
                            [unstore_unit]
                                variable=ally
                            [/unstore_unit]

                            {CLEAR_VARIABLE ally}
                        [/command]
                    [/option]
                    [option]
                        message = _ "(Good) Cititzens of Pinewood we have defeated one villain! It's time to defeat another!"
                        [command]
                            [set_variable]
		                name=ooze_alignment_2
		                value=2
		            [/set_variable]
                        [/command]
                    [/option]
                [/message]
            [/else]
            [/if]

            {VARIABLE idle_mode 1}
            [end_turn]
            [/end_turn]
        [/then]
        [/if]
     [/else]
     [/if]
[/event]

[event]
    name=side {F2} turn
    first_time_only=no

    [if]
        [variable]
            name=idle_mode
            numerical_equals=1
        [/variable]
    [then]
        [end_turn]
        [/end_turn]
    [/then]
    [/if]
[/event]

[event]
    name=new turn
    first_time_only=no

    [if]
        [variable]
            name=imperial_mage_talk
            numerical_equals=2
        [/variable]
        [and]
            [variable]
                name=ooze_alignment_1
                greater_than=0
            [/variable]
        [/and]
        [and]
            [variable]
                name=ooze_alignment_2
                greater_than=0
            [/variable]
        [/and]
    [then]
        {VARIABLE imperial_mage_talk 3}
        {CLEAR_VARIABLE idle_mode}

        [if]
            [variable]
                name=ooze_alignment_1
                numerical_equals=$ooze_alignment_2
            [/variable]
        [then]
            [if]
                [variable]
                    name=ooze_alignment_1
                    greater_than=1
                [/variable]
            [then]
                {VARIABLE battle_stage 2}
            [/then]
            [else]
                {VARIABLE battle_stage 3}
            [/else]  
            [/if]
            [objectives]
		side={P1}
		[objective]
		    description= _ "Kill your Creator!"
	            condition=win
		[/objective]
		[objective]
		    description= _ "Death of the Master Ooze"
		    condition=lose
		[/objective]
		[objective]
		    description= _ "Death of the Master Ooze 2"
		    condition=lose
		[/objective]
	    [/objectives]

            [objectives]
		side={P2}
		[objective]
		    description= _ "Kill your Creator!"
		    condition=win
		[/objective]
		[objective]
		    description= _ "Death of the Master Ooze"
		    condition=lose
		[/objective]
		[objective]
		    description= _ "Death of the Master Ooze 2"
		    condition=lose
	        [/objective]
	    [/objectives]
        [/then]
        [else]
            [if]
                [variable]
                    name=ooze_alignment_1
                    greater_than=$ooze_alignment_2
                [/variable]
            [then]
                {VARIABLE battle_stage 4}
                [objectives]
		    side={P1}
		    [objective]
		        description= _ "Defeat your dark side!"
	                condition=win
		    [/objective]
		    [objective]
		        description= _ "Kill your Creator!"
	                condition=win
		    [/objective]
		    [objective]
		        description= _ "Death of the Master Ooze"
		        condition=lose
		    [/objective]
                    [objective]
		        description= _ "Allow your Creator to kill your dark side"
		        condition=lose
	            [/objective]
	        [/objectives]

                [objectives]
		    side={P2}
                    [objective]
		        description= _ "Defeat your weak side!"
	                condition=win
		    [/objective]
		    [objective]
		        description= _ "Kill your Creator!"
		        condition=win
		    [/objective]
		    [objective]
		        description= _ "Death of the Master Ooze 2"
		        condition=lose
	            [/objective]
                    [objective]
		        description= _ "Allow your Creator to kill your weak side"
		        condition=lose
	            [/objective]
	        [/objectives]
            [/then]
            [else]
                {VARIABLE battle_stage 5}

                [objectives]
		    side={P1}
                    [objective]
		        description= _ "Defeat your weak side!"
	                condition=win
		    [/objective]
		    [objective]
		        description= _ "Kill your Creator!"
		        condition=win
		    [/objective]
		    [objective]
		        description= _ "Death of the Master Ooze 2"
		        condition=lose
	            [/objective]
                    [objective]
		        description= _ "Allow your creator to kill your weak side"
		        condition=lose
	            [/objective]
	        [/objectives]

                [objectives]
		    side={P2}
		    [objective]
		        description= _ "Defeat your dark side!"
	                condition=win
		    [/objective]
		    [objective]
		        description= _ "Kill your Creator!"
	                condition=win
		    [/objective]
		    [objective]
		        description= _ "Death of the Master Ooze"
		        condition=lose
		    [/objective]
                    [objective]
		        description= _ "Allow your creator to kill your dark side"
		        condition=lose
	            [/objective]
	        [/objectives]
            [/else]  
            [/if]
        [/else]  
        [/if]
    [/then]  
    [/if]
[/event]

     # ===================================================================================================================== #
     # CAMPAIGN HERO DEATHS
     # ===================================================================================================================== #

[event]
   name=last breath
   [filter]
       id=Master Ooze
   [/filter]
   [message]
       speaker=unit
       message= _ "Gurgle!"
   [/message]
   [if]
       [variable]
           name=battle_stage
           less_than=1
       [/variable]
   [then]
      [message]
          id=Master Ooze 2
          message= _ "(It seems you somehow remain connected to your companion ooze. When your other part dies you die as well...)"
      [/message]   
      [endlevel]
          result=defeat
      [/endlevel]
   [/then]
   [else]
       [if]
           [variable]
               name=battle_stage
               less_than=4
           [/variable]
       [then]
           [message]
               id=Master Ooze 2
               message= _ "(You have allowed the Imperial Mage to kill your companion ooze. A shockwave ripples through your consciousness, stunning you and handing victory to your hated Creator!"
           [/message] 
           [endlevel]
               result=defeat
           [/endlevel]
       [/then]
       [/if]
   [/else]
   [/if]
[/event]

[event]
   name=last breath
   [filter]
       id=Master Ooze 2
   [/filter]
   [message]
       speaker=unit
       message= _ "Gurgle!"
   [/message]
   [if]
       [variable]
           name=battle_stage
           less_than=1
       [/variable]
   [then]
      [message]
          id=Master Ooze
          message= _ "(It seems you somehow remain connected to your companion ooze. When your other part dies you die as well...)"
      [/message] 
      [endlevel]
          result=defeat
      [/endlevel]
   [/then]
   [else]
       [if]
           [variable]
               name=battle_stage
               less_than=4
           [/variable]
       [then]
           [message]
               id=Master Ooze
               message= _ "(You have allowed the Imperial Mage to kill your companion ooze. A shockwave ripples through your consciousness, stunning you and handing victory to your hated Creator!"
           [/message] 
           [endlevel]
               result=defeat
           [/endlevel]
       [/then]
       [/if]
   [/else]
   [/if]
[/event]

[event]
    name=die
    [filter]
        id=Master Ooze
    [/filter]
    [filter_second]
        side={F2}
    [/filter_second]
    [if]
        [variable]
            name=battle_stage
            greater_than=3
        [/variable]
        [then]
            [message]
                id=Master Ooze 2
                message= _ "(You have allowed the Imperial Mage to kill your companion ooze. A shockwave ripples through your consciousness, stunning you and handing victory to your hated Creator!"
            [/message] 
            [endlevel]
                result=defeat
            [/endlevel]
        [/then]
    [/if]
[/event]

[event]
    name=die
    [filter]
        id=Master Ooze 2
    [/filter]
    [filter_second]
        side={F2}
    [/filter_second]
    [if]
        [variable]
            name=battle_stage
            greater_than=3
        [/variable]
        [then]
            [message]
                id=Master Ooze
                message= _ "(You have allowed the Imperial Mage to kill your companion ooze. A shockwave ripples through your consciousness, stunning you and handing victory to your hated Creator!"
            [/message] 
            [endlevel]
                result=defeat
            [/endlevel]
        [/then]
    [/if]
[/event]

[event]
    name=die
    [filter]
        id=Master Ooze
    [/filter]
    [filter_second]
        side={P2}
    [/filter_second]
    [if]
        [variable]
            name=battle_stage
            greater_than=3
        [/variable]
        [then]
            [if]
                [variable]
                    name=ooze_alignment_1
                    numerical_equals=1
                [/variable]
            [then]
                [message]
                    speaker=narrator
                    message= _ "After the death of your companion ooze its progeny dissolve into harmless gelatinous puddles."
                    image=wesnoth-icon.png
                [/message]
            [/then]
            [else]
                [message]
                    speaker=narrator
                    message= _ "With their leader slain the remaining townsfolk flee the battle!"
                    image=wesnoth-icon.png
                [/message]
            [/else]
            [/if]

            [set_variable]
                name=main_ooze_id
                value=Master Ooze 2
            [/set_variable]

            [kill]
	        side={P1}
            [/kill]

            [if]
                [variable]
                    name=imperial_mage_dead
                    numerical_equals=1
                [/variable]
            [then]
                {VARIABLE ooze_alignment_win $ooze_alignment_2}
                [fire_event]
                    name=ooze_campaign_epilogue
                [/fire_event]
            [/then]
            [else]
                {VARIABLE ooze_alignment_win $ooze_alignment_2}
                {VARIABLE master_ooze_1_dead 1}
            [/else]
            [/if]
        [/then]
    [/if]
[/event]

[event]
    name=die
    [filter]
        id=Master Ooze 2
    [/filter]
    [filter_second]
        side={P1}
    [/filter_second]
    [if]
        [variable]
            name=battle_stage
            greater_than=3
        [/variable]
        [then]
            [if]
                [variable]
                    name=ooze_alignment_2
                    numerical_equals=1
                [/variable]
            [then]
                [message]
                    speaker=narrator
                    message= _ "After the death of your companion ooze its progeny dissolve into harmless gelatinous puddles."
                    image=wesnoth-icon.png
                [/message]
            [/then]
            [else]
                [message]
                    speaker=narrator
                    message= _ "With their leader slain the remaining townsfolk flee the battle!"
                    image=wesnoth-icon.png
                [/message]
            [/else]
            [/if]

            [set_variable]
                name=main_ooze_id
                value=Master Ooze
            [/set_variable]

            [kill]
	        side={P2}
            [/kill]

            [if]
                [variable]
                    name=imperial_mage_dead
                    numerical_equals=1
                [/variable]
            [then]
                {VARIABLE ooze_alignment_win $ooze_alignment_1}
                [fire_event]
                    name=ooze_campaign_epilogue
                [/fire_event]
            [/then]
            [else]
                {VARIABLE ooze_alignment_win $ooze_alignment_1}
                {VARIABLE master_ooze_2_dead 1}
            [/else]
            [/if]
        [/then]
    [/if]
[/event]

     # ===================================================================================================================== #
     # HERO DEATHS
     # ===================================================================================================================== #

[event]
    name=last breath
    [filter]
	id=Shady Character
    [/filter]
    [message]
	speaker=unit
	message= _ "Ack! Why attack an innocent arms merchant like myself? I would have sold you quality weapons at an affordable price!"
    [/message]
    [set_variable]
	name=shady_dead
	value=1
    [/set_variable]
    [remove_item]
	x,y=17,12
    [/remove_item]
[/event]
	
[event]
    name=last breath
    [filter]
	id=Ram Aide
    [/filter]
    [message]
        speaker=unit
	message= _ "Ach! I hope there's lots of booze in Heaven..."
    [/message]
[/event]

[event]
    name=last breath
    [filter]
	id=High Priest Jal
    [/filter]
    [message]
	speaker=unit
	message= _ "Ugn! I go...to meet...Pelor..."
    [/message]
[/event]

[event]
    name=last breath
    [filter]
        id=Jedd
    [/filter]
    [if]
        [variable]
            name=jedd_friend
            greater_than=1
        [/variable]
    [then]
        [message]
	    speaker=unit
	    message= _ "Fiend! I hope Sithras kills...you...all...ugn..."
        [/message]
    [/then]
    [else]
        [message]
	    speaker=unit
	    message= _ "Fiend! I hope Aurelia kills...you...all...ugn..."
        [/message]
    [/else]
    [/if]
[/event]

[event]
    name=last breath
    [filter]
	id=Corinna
    [/filter]
    [message]
	speaker=unit
	message= _ "No! I'm too pretty to die!"
    [/message]
    [message]
	id=Sir Dryden
	message= _ "Corinna! NOOOOO!!!!"
    [/message]
    [set_variable]
	name=corinna_dead
	value=1
    [/set_variable]
    [if]
	[variable]
	     name=dryden_friend
	     greater_than=0
	[/variable]
	[and]
	    [variable]
		name=dryden_dead
		numerical_equals=0
	    [/variable]
	[/and]
    [then]
	[kill]
	    id=Sir Dryden
	[/kill]
	[message]
	    speaker=narrator
	    message= _ "Wracked with grief, Sir Dryden has abandoned the fight!"
	    image=wesnoth-icon.png
	[/message]
    [/then]
    [/if]
[/event]

[event]
    name=last breath
    [filter]
	id=Sergeant Ryn
    [/filter]
    [message]
	speaker=unit
	message= _ "I hope you drown in my blood, scum!"
    [/message]
[/event]

[event]
    name=last breath
    [filter]
	id=Livius
    [/filter]
    [message]
	speaker=unit
	message= _ "Damn, now my book on exotic cooking will never be finished!"
    [/message]
[/event]

[event]
    name=last breath
    [filter]
	id=Frist
    [/filter]
    [message]
	speaker=unit
	message= _ "I did my best...my student Aurelia will finish this...ugn..."
    [/message]
[/event]

[event]
    name=last breath
    [filter]
	id=Valin
    [/filter]
    [message]
	speaker=unit
	message= _ "My DEATH will be AVENGED!!!"
    [/message]
[/event]

[event]
    name=last breath
    [filter]
	id=Brock
    [/filter]
    [message]
	speaker=unit
	message= _ "Ach, I've finally met my match!"
    [/message]
[/event]

[event]
    name=last breath
    [filter]
	id=Kirielle the Realist
    [/filter]
    [message]
	speaker=unit
	message= _ "Damn, I didn't count on them being this strong!"
    [/message]
    [message]
	id=Bryony the Idealist
	message= _ "Kirielle, please don't die!!! I'm coming to help you!"
    [/message]
    [kill]
	id=Bryony the Idealist
    [/kill]
    [message]
	speaker=narrator
	message= _ "Bryony has abandoned the fight!"
	image=wesnoth-icon.png
    [/message]
[/event]

[event]
    name=last breath
    [filter]
	id=Bryony the Idealist
    [/filter]
    [message]
	speaker=unit
	message= _ "Kirielle, I'm sorry..."
    [/message]
    [message]
	id=Kirielle the Realist
	message= _ "Bryony, you can't die!!! I'm coming to help you!"
    [/message]
    [kill]
	id=Kirielle the Realist
    [/kill]
    [message]
	speaker=narrator
	message= _ "Kirielle has abandoned the fight!"
	image=wesnoth-icon.png
    [/message]
[/event]

[event]
    name=last breath
    [filter]
	id=Sir Dryden
    [/filter]
    [message]
	speaker=unit
	message= _ "Why did it have to end like this! Corinna...has not been redeemed yet...ugn..."
    [/message]
    [set_variable]
	name=dryden_dead
	value=1
    [/set_variable]
[/event]

[event]
    name=last breath
    [filter]
	id=Fontaine
    [/filter]
    [if]
        [variable]
            name=fontaine_friend
            greater_than=1
        [/variable]
    [then]
        [message]
	    speaker=unit
	    message= _ "Well... I suppose... my patron that means you will not see my art any more..."
        [/message]
    [/then]
    [else]
        [message]
	    speaker=unit
	    message= _ "I die now, alas, alas! I only wish to gaze into the angelic face of my Muse one last time..."
        [/message]
    [/else]
    [/if]
[/event]

[event]
    name=last breath
    [filter]
	id=Alkar
    [/filter]
    [message]
	speaker=unit
	message= _ "Urgh! No glory for me...only death..."
    [/message]
[/event]

[event]
    name=last breath
    [filter]
        id=Guthry
    [/filter]
    [message]
	speaker=unit
	message= _ "Usurpers! Stay away...from...my...land...ugn..."
    [/message]
[/event]

[event]
    name=last breath
    [filter]
	id=Dryad
    [/filter]
    [message]
	speaker=unit
	message= _ "Now I return to the Earth..."
    [/message]
[/event]
	
[event]
    name=last breath
    [filter]
	id=Captain Koltz
    [/filter]
    [message]
	speaker=unit
	message= _ "I may die now but the Empire is eternal!"
    [/message]
[/event]

[event]
    name=last breath
    [filter]
	id=Slave
    [/filter]
    [message]
	speaker=unit
	message= _ "(Grunts in pain)"
    [/message]
[/event]

[event]
    name=last breath
    [filter]
	id=Haffuz the Slaver
    [/filter]
    [message]
	speaker=unit
	message= _ "Maybe getting into the bodyguard business wasn't such a good idea after all..."
    [/message]
[/event]

[event]
    name=last breath
    [filter]
	id=Gorl the Smasher
    [/filter]
    [message]
	speaker=unit
	message= _ "(Grunts)"
    [/message]
[/event]

     # ===================================================================================================================== #
     # ANTYHERO DEATH
     # ===================================================================================================================== #

[event]
    name=last breath
    [filter]
	id=Imperial Mage
    [/filter]
    [message]
	speaker=unit
	message= _ "No!!! Absolute power was within my...grasp...ugnh..."
    [/message]
    [kill]
	side={F2}
    [/kill]
    [message]
	speaker=narrator
	message= _ "Keiron's remaining men flee in disarray!"
	image=wesnoth-icon.png
    [/message]
    [if]
        [variable]
            name=battle_stage
            greater_than=3
        [/variable]
    [then]
        [if]
            [variable]
                name=master_ooze_1_dead
                numerical_equals=1 
            [/variable]
        [then]
            {VARIABLE ooze_alignment_win $ooze_alignment_2}
            [fire_event]
                name=ooze_campaign_epilogue
            [/fire_event]
        [/then]
        [else]
            [if]
                [variable]
                    name=master_ooze_2_dead
                    numerical_equals=1 
                [/variable]
            [then]
                {VARIABLE ooze_alignment_win $ooze_alignment_1}
                [fire_event]
                    name=ooze_campaign_epilogue
                [/fire_event]
            [/then]
            [else]
                {VARIABLE imperial_mage_dead 1}
            [/else]
            [/if]
        [/else]
        [/if]
    [/then]
    [else]
        {VARIABLE ooze_alignment_win $ooze_alignment_1}
        [fire_event]
            name=ooze_campaign_epilogue
        [/fire_event]
    [/else]
    [/if]
[/event]

     # ===================================================================================================================== #
     # EPILOGUE
     # ===================================================================================================================== #

[event]
    name=ooze_campaign_epilogue
    [if]
	[variable]
	    name=ooze_alignment_win
	    numerical_equals=1
	[/variable]
    [then]
	[music]
	    name=main_menu.ogg
	    immediate=yes
	[/music]
        [if]
            [variable]
                name=battle_stage
                greater_than=3
            [/variable]
        [then]
            [message]
	        speaker=narrator
	        message= _ "You have consumed your weak side and become stronger than ever!"
	        image=wesnoth-icon.png
	    [/message]
        [/then]
        [/if]
	[message]
	    speaker=narrator
	    message= _ "Your quest for power and security is complete! With the death of your Creator you feel great power surging through you, and your amorphous form quivers with energy. From now on, men and orcs will tremble with fear at the mere mention of your name, and those few who dare oppose you will be quickly devoured."
            image=wesnoth-icon.png
	[/message]
	[message]
	    speaker=narrator
	    message= _ "Pinewood is abandoned by the forces of civilization, leaving you free to roam the vast wilderness in search of prey. In the new natural order you've created, you are at the very top of the food chain!"
	    image=wesnoth-icon.png
	[/message]
	[message]
	    speaker=narrator
	    message= _ "If you liked this campaign check out the sort-of sequel, Elvish Dynasty! Coming soon to the Wesnoth add-on server!"
            image=wesnoth-icon.png
	[/message]

	[endlevel]
	    result=victory
	[/endlevel]
     [/then]
     [else]
	[music]
	    name=main_menu.ogg
	    immediate=yes
	[/music]
        [message]
	    speaker=narrator
	    message= _ "EPILOGUE: You've defeated the Black Horde and your wicked Creator! With the death of your Creator you feel great power surging through you, and your amorphous form quivers with energy. The surviving townsfolk are wary of you, but they are also the first to admit that without your leadership the fort would have fallen."
	    image=wesnoth-icon.png
	[/message]

	[message]
	    speaker=narrator
	    message= _ "They offer to pardon you for any and all crimes you may have committed, and even offer you honorary Pinewood citizenship! Your time amongst the Solids has given you much to think about..."
	    image=wesnoth-icon.png
	[/message]

        [if]
            [variable]
                name=battle_stage
                greater_than=3
            [/variable]
        [then]
            [message]
	        speaker=narrator
	        message= _ "To achieve this you have faced your dark side and won!"
	        image=wesnoth-icon.png
	    [/message]
        [/then]
        [else]
            [set_variable]
                name=main_ooze_id
                value=Master Ooze
            [/set_variable]
        [/else]
        [/if]

	[message]
	    speaker=narrator
	    message= _ "The fate of the surviving townsfolk:"
	    image=wesnoth-icon.png
	[/message]

        [if]
            [variable]
                name=alkar_offer
                numerical_equals=4
            [/variable]
        [then]
	    [message]
		id=Alkar
		message= _ "Becomes a famous mercenary."
	    [/message]
        [/then]
        [else]
            [message]
		id=Alkar
		message= _ "Becomes a townguard in Pinewood."
	    [/message]
        [/else]
        [/if]

	[message]
	    id=Ram Aide
	    message= _ "Tries to get the townsfolk to buy him a new gigantic barrel of booze...unsuccessfully."
	[/message]
	[message]
	    id=High Priest Jal
	    message= _ "Takes charge of the town's wounded after the battle. Tries to get you to convert to the worship of Pelor."
	[/message]
	[message]
	    id=Kirielle the Realist
	    message= _ "The mysterious elf ranger disappears shortly after the battle and is not seen again."
	[/message]
	[message]
	    id=Bryony the Idealist
	    message= _ "Disappears with her companion, Kirielle."
	[/message]
	[message]
	    id=Frist
	    message= _ "Redoubles his efforts at training others in combat. Helps re-establish the Pinewood Militia."
	[/message]

        [if]
            [variable]
                name=battle_stage
                greater_than=3
            [/variable]
        [then]
	    [message]
	        id=Livius
	        message= _ "Becomes quite a wealthy man after opening a restaurant that specializes in exotic foods. The most expensive item on the menu is 'ooze flambé'!"
	    [/message]
        [/then]
        [else]
	    [message]
	        id=Livius
	        message= _ "Has to give up his plans to cook and sell your corpse as an exotic culinary delicacy after you become the town hero. Goes off in search of other exotic ingredients for his recipes."
	    [/message]
        [/else]
        [/if]

	[message]
	    id=Jedd
	    message= _ "After complaining for years about government bureaucrats that never did an honest day's work, Jedd is elected Mayor."
	[/message]
	[message]
	    id=Valin
	    message= _ "Takes his show on the road."
	[/message]
	[message]
	    id=Captain Koltz
	    message= _ "Rises to the rank of Colonel in the Imperial Army."
	[/message]
	[message]
	    id=Guthry
	    message= _ "Becomes a land speculator."
	[/message]
	[message]
	    id=Brock
	    message= _ "Continues to run his tavern. People from across the Empire come to challenge him to an armwrestling match; only a handful are able to best him."
	[/message]
	[message]
	    id=Dryad
	    message= _ "The tree-fairy returns to her tree once she is satisfied that Nature's balance has been restored."
	[/message]
	[message]
	    id=Sergeant Ryn
	    message= _ "Becomes the new leader of the Pinewood Militia."
	[/message]
	[message]
	    id=Haffuz the Slaver
	    message= _ "Gets out of the bodyguard business in search of easier money."
	[/message]

        [if]
            [variable]
                name=fontaine_friend
                greater_than=1
            [/variable]
        [then]
	    [message]
		id=Fontaine
		message= _ "His artwork becomes famous and much sought after."
	    [/message]
        [/then]
        [else]
	    [message]
		id=Fontaine
		message= _ "His artwork becomes famous and much sought after. He dedicates his paintings to his Muse."
	    [/message]
        [/else]
        [/if]
		
	[if]
	    [variable]
		name=dryden_friend
		numerical_equals=1
	    [/variable]
	    [and]
	        [variable]
		    name=corinna_dead
		    numerical_equals=0
	        [/variable]
	    [/and]
	[then]
	    [message]
		id=Sir Dryden
		message= _ "Marries the love of his life, Corinna. He thanks you for helping him get the 'wedding ring.'"
	    [/message]
	[/then]
	[/if]
		
	[if]
	    [variable]
		name=dryden_friend
		numerical_equals=1
	    [/variable]
	    [and]
	        [variable]
		    name=dryden_dead
		    numerical_equals=1
	        [/variable]
	    [/and]
	[then]
	    [message]
		id=Corinna
		message= _ "Without Sir Dryden's moral guidance, Corinna overcomes the power of the Ring of Opposite Alignment and returns to studying the Dark Arts."
	    [/message]
	[/then]
	[/if]
		
	[if]
	    [variable]
		name=dryden_friend
		numerical_equals=0
	    [/variable]
	[then]
	    [message]
		id=Corinna
		message= _ "Becomes even more reclusive as she delves into the Dark Arts."
	    [/message]
	[/then]
	[/if]
		
	[message]
	    id=$main_ooze_id
	    message= _ "You've won a great victory today. The future beckons you forward, and you're left to reflect on how far you've come...from a primitive creature in a dark cave, to an enlightened hero and savior of a town, it has been an extraordinary journey. You're certain that your future promises many great opportunities; all that's left to do is to decide which path to take!"
	[/message]
		
	[message]
	    speaker=narrator
	    message= _ "If you liked this campaign check out the sort-of sequel, Elvish Dynasty! Coming soon to the Wesnoth add-on server!"
	    image=wesnoth-icon.png
	[/message]

	[endlevel]
	    result=victory
	[/endlevel]
    [/else]
    [/if]

    {CLEAR_VARIABLE ooze_alignment_win}
    {CLEAR_VARIABLE ooze_alignment_1}
    {CLEAR_VARIABLE ooze_alignment_2}
    {CLEAR_VARIABLE master_ooze_dead_1}
    {CLEAR_VARIABLE master_ooze_dead_2}
    {CLEAR_VARIABLE imperial_mage_dead}
    {CLEAR_VARIABLE imperial_mage_talk}
    {CLEAR_VARIABLE alkar_offer}
    {CLEAR_VARIABLE corinna_dead}
    {CLEAR_VARIABLE dryden_dead}
    {CLEAR_VARIABLE upgrade_given}
    {CLEAR_VARIABLE sudden_strike}
    {CLEAR_VARIABLE allies_type}
    {CLEAR_VARIABLE shady_dead}
    {CLEAR_VARIABLE dryad_friend}
    {CLEAR_VARIABLE troll_friend}
    {CLEAR_VARIABLE ram_friend}
    {CLEAR_VARIABLE jedd_friend}
    {CLEAR_VARIABLE slavers_friend}
    {CLEAR_VARIABLE dryden_friend}
    {CLEAR_VARIABLE fontaine_friend}
    {CLEAR_VARIABLE guthry_friend}
    {CLEAR_VARIABLE sithras_friend}
    {CLEAR_VARIABLE jal_friend}
    {CLEAR_VARIABLE livius_friend}
    {CLEAR_VARIABLE brock_friend}
    {CLEAR_VARIABLE valin_friend}
    {CLEAR_VARIABLE corinna_friend}
    {CLEAR_VARIABLE sergeant_ryn_friend}
    {CLEAR_VARIABLE bored_friend}
    {CLEAR_VARIABLE stern_friend}
    {CLEAR_VARIABLE leaderless_troops}
    {CLEAR_VARIABLE leadership_aurelia}
    {CLEAR_VARIABLE leadership_sithras}
    {CLEAR_VARIABLE aurelia_forces_overwhelm}
    {CLEAR_VARIABLE sithras_forces_overwhelm}
    {CLEAR_VARIABLE imperial_commander}
    {CLEAR_VARIABLE join_to_forces}
    {CLEAR_VARIABLE battle_stage}
    {CLEAR_VARIABLE main_ooze_id}
    {CLEAR_VARIABLE traitor_id}

    #undef CREATE_SOLID_LEADER
    #undef INITIALIZE_VARIABLES
    #undef RANDOMIZE_SCENARIO
    #undef CAPTURE_LEADER
    #undef SPENT_GOLD
    #undef SHADY_INTRODUCTION
    #undef SHADY_TRANSACTIONS
    #undef WILD_ALLIES
    #undef TOWNSFOLK
    #undef FORM_DEFENDER_FORCES
    #undef FORM_VOLUNTEER_FORCES
    #undef IMPERIAL_ARMY_SUPPORT
    #undef IMPERIAL_ARMY_FORCES
    #undef OOZE_INFECTION
    #undef BLACKFANG_ARMY_WAVE_01
    #undef BLACKFANG_ARMY_WAVE_02
    #undef BLACKFANG_ARMY_WAVE_03
    #undef BLACKFANG_ARMY_WAVE_04
    #undef BLACKFANG_ARMY_WAVE_05
    #undef BLACKFANG_ARMY_WAVE_06
    #undef SUDDEN_STRIKE
    #undef GUTHRY_EAGER
[/event]

[/multiplayer]
