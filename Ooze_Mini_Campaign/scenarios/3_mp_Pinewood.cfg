     # ===================================================================================================================== #
     # 3 - PINEWOOD MULTIPLAYER SCENARIO
     # ===================================================================================================================== #
     #  Created by: SpenceLack
     # Modified by: Wesbane
     # Last revision: 2012-09-12
     # ===================================================================================================================== #

#define P1
1#enddef

#define P2
2#enddef

#define F1
3#enddef

#define F2
4#enddef

#define F3
5#enddef

     # ===================================================================================================================== #
     # SCENARIO UTILS DEFINITIONS
     # ===================================================================================================================== #

#define TEAM_GOLD_VALUE
    [store_side]
       side={P1}
       variable=side
    [/store_side]    
    [set_variable]
       name=team_gold
       value=$side.gold
    [/set_variable]
    {CLEAR_VARIABLE side}
    [store_side]
       side={P2}
       variable=side
    [/store_side]
    {VARIABLE_OP team_gold add $side.gold}
    {CLEAR_VARIABLE side}
#enddef

#define TEAM_HAS_GOLD VALUE SIDE
    [store_side]
       side={SIDE}
       variable=side
    [/store_side]
    {VARIABLE gga {VALUE}}
    {VARIABLE ggl {VALUE}}
    {VARIABLE_OP ggl divide 2}
    {VARIABLE_OP ggl multiply 2}
    [if]
    [variable]
      name=ggl
      not_equals=$gga
    [/variable]
    [then]
    {VARIABLE_OP ggl divide 2}
    {VARIABLE_OP ggl add 1}
    [/then]
    [else]
    {VARIABLE_OP ggl divide 2}
    [/else]
    [/if]
    [if]
    [variable]
        name=team_gold
        greater_than_equal_to=$gga
    [/variable]
    [and]
    [variable]
        name=side.gold
        greater_than_equal_to=$ggl
    [/variable]
    [/and]
    [then]
      {VARIABLE has_gold yes}
    [/then]
    [else]
      {VARIABLE has_gold no}
    [/else]
    [/if]
    {CLEAR_VARIABLE side}
#enddef

#define TEAM_GOLD GAIN VALUE SIDE
    [set_variable]
        name=gain_gold
        value={GAIN}
    [/set_variable]
    [set_variable]
        name=gpa
        value={VALUE}
    [/set_variable]
    [set_variable]
        name=gpl
        value={VALUE}
    [/set_variable]
    [if]
    [variable]
        name=gain_gold
        not_equals=lost     
    [/variable]
    [and]
        [variable]
            name=gain_gold
            not_equals=spent     
        [/variable]
    [/and]
    [then]
    [if]
        [variable]
            name=gain_gold
            equals=win
        [/variable]
    [then]
        [message]
	    speaker=narrator
	    message= _ "You are victorious and win $gpa gold pieces!"
            image=wesnoth-icon.png
        [/message]
    [/then]
    [else]
        [if]
            [variable]
                name=gain_gold
                equals=gain
            [/variable]
        [then]
            [message]
	        speaker=narrator
	        message= _ "You gained $gpa gold pieces!"
                image=wesnoth-icon.png
            [/message]
        [/then]
        [else]
            [message]
	        speaker=narrator
	        message= _ "You earned $gpa gold pieces!"
                image=wesnoth-icon.png
            [/message]
        [/else]
        [/if]
    [/else]
    [/if]   
    {VARIABLE_OP gpl divide 2}
    [gold]
	side={P1}
	amount=$gpl
    [/gold]
    [gold]
	side={P2}
	amount=$gpl
    [/gold]
    {VARIABLE_OP gpl multiply 2}
    [if]
    [variable]
      name=gpl
      not_equals=$gpa
    [/variable]
    [then]
    [gold]
	side={SIDE}
	amount=1
    [/gold]
    [/then]
    [/if]
    [/then]
    [else]
        [if]
            [variable]
                name=gain_gold
                equals=spent     
            [/variable]
        [then]
            [message]
	        speaker=narrator
	        message= _ "You spent $gpa gold pieces!"
                image=wesnoth-icon.png
            [/message]
        [/then]
        [else]
            [message]
	        speaker=narrator
	        message= _ "You lost $gpa gold pieces!"
                image=wesnoth-icon.png
            [/message]
        [/else]
        [/if]
    {VARIABLE_OP gpl divide 2}
    [gold]
	side={P1}
	amount=-$gpl
    [/gold]
    [gold]
	side={P2}
	amount=-$gpl
    [/gold]
    {VARIABLE_OP gpl multiply 2}
    [if]
    [variable]
      name=gpl
      not_equals=$gpa
    [/variable]
    [then]
    [gold]
	side={SIDE}
	amount=-1
    [/gold]
    [/then]
    [/if]
    [/else]
    [/if]
    [sound]
	name=gold.ogg
    [/sound]
    {TEAM_GOLD_VALUE}
#enddef

#define HAS_TRAITS
    [if]
        [variable]
            name=master_ooze
            numerical_equals=1
        [/variable]
    [then]
        {VARIABLE have_strength $have_strength_aurelia}
        {VARIABLE have_resilient $have_resilient_aurelia}
        {VARIABLE have_dexterity $have_dexterity_aurelia}
        {VARIABLE have_quickness $have_quickness_aurelia}
    [/then]
    [else]
        {VARIABLE have_strength $have_strength_sithras}
        {VARIABLE have_resilient $have_resilient_sithras}
        {VARIABLE have_dexterity $have_dexterity_sithras}
        {VARIABLE have_quickness $have_quickness_sithras}
    [/else]     
    [/if]
#enddef

#define LANGUAGE_PFIXES SIDE
    [if]
      [variable]
        name=gender
        numerical_equals=1
      [/variable]   
    [then]
      [set_variable]
        name=pfx_00
        value= _ "female-0"
      [/set_variable]
      [set_variable]
        name=pfx_01
        value= _ "female-1"
      [/set_variable]
      [set_variable]
        name=pfx_02
        value= _ "female-2"
      [/set_variable]
      [set_variable]
        name=pfx_03
        value= _ "female-3"
      [/set_variable]
      [set_variable]
        name=pfx_04
        value= _ "female-4"
      [/set_variable]
    [/then]
    [else]
      [set_variable]
        name=pfx_00
        value= _ "male-0"
      [/set_variable]
      [set_variable]
        name=pfx_01
        value= _ "male-1"
      [/set_variable]
      [set_variable]
        name=pfx_02
        value= _ "male-2"
      [/set_variable]
      [set_variable]
        name=pfx_03
        value= _ "male-3"
      [/set_variable]
      [set_variable]
        name=pfx_04
        value= _ "male-4"
      [/set_variable]
    [/else]
    [/if]
#enddef

#define NO_TIME SIDE
    [set_variable]
        name=master_ooze
        value={SIDE}
    [/set_variable]
    [if]
      [variable]
        name=master_ooze
        numerical_equals=1
      [/variable]   
    [then]
      [set_variable]
        name=speaker_id
        value=Master Ooze
      [/set_variable]
    [/then]
    [else]
      [set_variable]
        name=speaker_id
        value=Master Ooze 2
      [/set_variable]
    [/else]
    [/if]
    {LANGUAGE_PFIXES $master_ooze}
    [message]
        speaker=$speaker_id
        message= _ "(You have no time for this.)"
    [/message]
#enddef

#define LEADERSHIP INCREASE SIDE
    [set_variable]
        name=master_ooze
        value={SIDE}
    [/set_variable]
    [if]
      [variable]
        name=master_ooze
        numerical_equals=1
      [/variable]   
    [then]
      {VARIABLE_OP leadership_aurelia add {INCREASE}}
    [/then]
    [else]
      {VARIABLE_OP leadership_sithras add {INCREASE}}
    [/else]
    [/if]
#enddef

     # ===================================================================================================================== #
     # STORY EVENTS DEFINITIONS
     # ===================================================================================================================== #

#define MAYOR_WYATT SIDE
    [set_variable]
        name=master_ooze
        value={SIDE}
    [/set_variable]
    [if]
      [variable]
        name=master_ooze
        numerical_equals=1
      [/variable]   
    [then]
      [set_variable]
        name=speaker_id
        value=Master Ooze
      [/set_variable]   
    [/then]
    [else]
      [set_variable]
        name=speaker_id
        value=Master Ooze 2
      [/set_variable]   
    [/else]
    [/if]
    {LANGUAGE_PFIXES $master_ooze}
    [message]
	id=Mayor Wyatt
	message= _ "(The Mayor appears to be a balding middle-aged man with an exuberant temperament. Based on his clothes and bearing, you guess that he must have been a farmer before taking up the aegis of politics)"
    [/message]
    [message]
	id=Mayor Wyatt
	message= _ "Greetings citizen! Have you come to aid our fair town in our hour of need?"
    [/message]
    [message]
	id=$speaker_id
	message= _ "(How should you respond?)"
    [option]
        [show_if]
          [variable]
            name=master_ooze
            numerical_equals=1
          [/variable]
        [/show_if]
	message= _ "(Offer to help fight Evil) Yes, my name is Aurelia. I'm an elvish shaman and I'm here to help!"
	[command]
	    [message]
		id=Mayor Wyatt
		message= _ "(He rubs his hands together with glee) Wonderful! Splendid! Let me explain the situation..."
	    [/message]
	    [/command]
    [/option]
    [option]
        [show_if]
          [variable]
            name=master_ooze
            numerical_equals=2
          [/variable]
        [/show_if]
	message= _ "(Offer to help fight Evil) Yes, my name is Sithras. I'm an elvish fighter and I'm here to help!"
	[command]
	    [message]
		id=Mayor Wyatt
		message= _ "(He rubs his hands together with glee) Wonderful! Splendid! Let me explain the situation..."
	    [/message]
	    [/command]
    [/option]
    [option]
	message= _ "(Offer to help for a reward) I'm a mercenary. I can help, but my services will cost you."
	[command]
	    [message]
		id=Mayor Wyatt
		message= _ "Of course, of course! There's considerable risk involved in what I'm asking. I wouldn't dream of putting you in harm's way without providing proper...compensation."
	    [/message]
	    [message]
		id=Mayor Wyatt
		message= _ "Let me give you a quick briefing about what's been going on..."
	    [/message]
	[/command]
    [/option]
    [option]
	message= _ "(Decline to help) I'm just a simple traveler looking for a place to spend the night."
	[command]
	    [message]                
		id=Mayor Wyatt
		message= _ "In that case madam, I highly recommend Brock's Tavern, which is located near the South Gate. The food is delicious, the rooms are cozy, and the prices are quite affordable. Please enjoy your stay in Fort Pinewood!"
	    [/message]
	    [message]
		id=Mayor Wyatt
		message= _ "(He suddenly looks dejected) Or...at least, enjoy your stay as much as possible under the circumstances. (Sigh) Our town has had its share of troubles recently. Let me explain what's been going on..."
	    [/message]

	[/command]
    [/option]
    [option]
	message= _ "(Provoke) I'm no hero! I'm the Master Ooze, come to devour you all!"
	[command]
	    [message]
		id=$speaker_id
		message= _ "(On second thought, as you look at the Mayor's four well-armored bodyguards, you decide that it might not be in your best interest to provoke a fight here. You need to become more powerful before you make a move to destroy the humans...)"
	    [/message]
	    [message]
		id=$speaker_id
		message= _ "(Decline to help) I'm just a simple traveler looking for a place to spend the night."
	    [/message]
	    [message]
                [show_if]
                   [variable]
                       name=master_ooze
                       numerical_equals=1
                   [/variable]
                [/show_if]
		id=Mayor Wyatt
		message= _ "In that case madam, I highly recommend Brock's Tavern, which is located near the South Gate. The food is delicious, the rooms are cozy, and the prices are quite affordable. Please enjoy your stay in Fort Pinewood!"
	    [/message]
            [message]
                [show_if]
                   [variable]
                       name=master_ooze
                       numerical_equals=2
                   [/variable]
                [/show_if]
		id=Mayor Wyatt
		message= _ "In that case sir, I highly recommend Brock's Tavern, which is located near the South Gate. The food is delicious, the rooms are cozy, and the prices are quite affordable. Please enjoy your stay in Fort Pinewood!"
	    [/message]
	    [message]
		id=Mayor Wyatt
		message= _ "(He suddenly looks dejected) Or...at least, enjoy your stay as much as possible under the circumstances. (Sigh) Our town has had its share of troubles recently. Let me explain what's been going on..."
	    [/message]

	[/command]
    [/option]
    [/message]
    [message]
	id=Mayor Wyatt
	message= _ "It all started when our militia leader led a punitive strike against the local goblin tribe. The strike force encountered an incredibly evil, powerful monster that devoured all in its path!"
    [/message]
    [message]
	id=Mayor Wyatt
	message= _ "The Pinewood Militia suffered a crushing defeat, and our militia leader was killed. I've had all the outlying farmsteads evacuated as we no longer have the manpower to defend them. The Imperial Army is coming to our aid, but it'll be weeks before they arrive in force."
    [/message]
    [message]
	id=Mayor Wyatt
	message= _ "In the meantime I've been trying to recruit heroes and mercenaries to bolster the fort's defenses. I'm not just worried about the oozes; there's plenty of opportunistic orc warlords that would love to sack a poorly defended human town. If word of our militia's defeat spreads we may have more to worry about than just mindless oozes!"
    [/message]
    [message]
	id=Mayor Wyatt
	message= _ "If you're interested in helping with the town's defense, go speak with Frist at the Training Hall. You may also want to speak with some of the other townsfolk. They might, at the very least, be able to provide you with valuable information."
    [/message]
#enddef

#define DRYDEN_PROBLEM
    [message]
	id=Sir Dryden
	message= _ "Oh, would that I might never see another day such as today, alas, alas!"
    [/message]
    [message]
	id=$speaker_id
	message= _ "(What to say?)"
	[option]
	    message= _ "(Offer to help) Hello sir. Is something wrong?"
	    [command]
		[remove_item]
		    x,y=8,12
		[/remove_item]
                {VARIABLE quest_sir_dryden $master_ooze}
		[message]
                    [show_if]
                       [variable]
                           name=master_ooze
                           numerical_equals=1
                       [/variable]
                    [/show_if]
		    id=Sir Dryden
		    message= _ "Oh fair damsel, I don't want to burden you with my problems. (He suddenly reconsiders) On the other hand, perhaps you're just what I need..."
		[/message]
                [message]
                    [show_if]
                       [variable]
                           name=master_ooze
                           numerical_equals=2
                       [/variable]
                    [/show_if]
		    id=Sir Dryden
		    message= _ "Oh good sir, I don't want to burden you with my problems. (He suddenly reconsiders) On the other hand, perhaps you're just what I need..."
		[/message]
		[message]
		    id=Sir Dryden
		    message= _ "I'll tell you my tale of woe, and then you can decide whether to help me or not. "
		[/message]
		[message]
		    id=Sir Dryden
		    message= _ "Last year I was traveling with a trade caravan in the icy steppes of Vedra when we were ambushed by orcs. Except for myself, there was only one other survivor, a beautiful and skilled mage by the name of Corinna."
		[/message]
		[message]
		    id=Sir Dryden
		    message= _ "What can I say about Corinna? Her eyes are exquisite emeralds, her face is that of an angel, she is a goddess made flesh! With Corinna's magic and my paladin skills we became the perfect team. Together we defeated orcs, yetis, and other evils too terrible to mention. At night we hugged each other for warmth, warding off the relentless cold. And finally, after months of traveling together, the two of us made it back to civilization."
		[/message]
		[message]
	            id=Sir Dryden
		    message= _ "We're the perfect team! The gods intended for us to be together, I'm sure of it!"
		[/message]
		[message]
		    id=$speaker_id
		    message= _ "You do sound like a good match. So what's the problem?"
		[/message]
		[message]
		    id=Sir Dryden
		    message= _ "Corinna is evil and she hates me."
		[/message]
		[message]
		     id=$speaker_id
		     message= _ "Ouch."
		[/message]
		[message]
	            id=Sir Dryden
		    message= _ "Tell me about it."
		[/message]
	        [message]
		    id=Sir Dryden
		    message= _ "Once we got back to Fort Pinewood she wanted nothing to do with me! She said she only stayed with me to survive, that she never loved me! I feel like I've had my heart ripped out and trampled to a pulp!"
		[/message]
		[message]
		    id=Sir Dryden
		    message= _ "Now she broods in her manor, studying dark tomes of forbidden magic. The last time I tried to visit her she attacked me, and placed what she called an 'Anti-Annoying Paladin Ward' around her estate. Some invisible force stops me from even passing through the front gate of her manor now!"
		[/message]
		[message]
		    id=Sir Dryden
		    message= _ "The tenets of my paladin Order clearly state that I must slay Evil wherever I find it, but how can I raise my sword against the woman I love? (Sigh) If only I could convince Corinna to abandon her dark magicks. How can one so beautiful be so ugly inside?"
		[/message]
		[message]
		    id=$speaker_id
		    message= _ "I guess appearances can be deceiving sometimes... (You wonder what Dryden would think of you if he saw your true form...)"
		[/message]
		[message]
		    id=Sir Dryden
		    message= _ "If you're willing to help, please take this love letter I wrote to Corinna at her estate. It's just west of the bridge."
		[/message]
		[set_variable]
		    name=dryden_quest
		    value=1
		[/set_variable]
                [if]
                    [variable]
                        name=master_ooze
                        numerical_equals=1
                    [/variable]
                [then]
                   {VARIABLE_OP quests_aurelia add 1}
                [/then]
                [else]
                  {VARIABLE_OP quests_sithras add 1}
                [/else]
                [/if]
		{PLACE_IMAGE items/gohere.png 4 10}
	    [/command]
        [/option]
	[option]
	    message= _ "(Leave him alone) Sorry to bother you..."
	    [command]
		[message]
		    id=Sir Dryden
		    message= _ "(The man is so self-absorbed in his sorrow that he doesn't even notice your arrival or departure.)"
		[/message]
            [/command]
	[/option]
    [/message]
#enddef

#define DRYDEN_RESPONSE
    [message]
	id=Sir Dryden
	message= _ "(Eagerly) Were you able to get my letter to Corinna?"
    [/message]
    [message]
	id=$speaker_id
	message= _ "(What to say?)"
    [option]
	message= _ "(Tell the truth) I'm afraid so. She tried to hire me to get rid of you."
    [command]
        [message]
	    id=Sir Dryden
	    message= _ "(Grimly) Then things are even worse than I feared. It is only a matter of time before Corinna's experiments in black magic come to the attention of the authorities. When that happens, my duty as a paladin will be clear: I will have to slay her. There is one...last chance...one last thing to try...to save Corinna from herself...if you would be willing to help."
	[/message]
	[message]
	    id=Sir Dryden
	    message= _ "There is a cursed artifact known as a 'Ring of Opposite Alignment.' Supposedly it has the power to change the most pure-hearted hero to evil, or the most wicked villain to good. If we could acquire that ring and trick Corinna into wearing it perhaps she would develop a more...amenable personality."
	[/message]
	[message]
	    id=Sir Dryden
	    message= _ "I'm going to look into acquiring the ring. I'll be right back. (He leaves for a minute, then returns.)"
	[/message]
	[set_variable]
	    name=dryden_quest
	    value=3
	[/set_variable]
    [/command]
    [/option]
    [option]
	message= _ "(Lie) Corinna said that to win her heart you must travel to the far away land of Tyrakia and pick a crystal rose for her."
	[command]
	    [remove_item]
		x,y=8,12
	    [/remove_item]
	    [message]
		id=Sir Dryden
		message= _ "A quest! A heroic quest to win the fair maiden's heart, just as in the stories of old! Oh Corinna, I will prove my worth to you in whatever way you desire! To Tyrakia!"
	    [/message]
	    [message]
                [show_if]
                    [variable]
                        name=master_ooze
                        numerical_equals=1
                    [/variable]
                [/show_if]
		id=Sir Dryden
		message= _ "And thank you, elf damsel, for helping me woo Corinna! Please take this gold as a reward!"
	    [/message]
            [message]
                [show_if]
                    [variable]
                        name=master_ooze
                        numerical_equals=2
                    [/variable]
                [/show_if]
		id=Sir Dryden
		message= _ "And thank you, good sir, for helping me woo Corinna! Please take this gold as a reward!"
	    [/message]
	    {TEAM_GOLD gain 20 $master_ooze}
	    [kill]
		id=Sir Dryden
	    [/kill]
	    [set_variable]
		name=dryden_quest
		value=4
	    [/set_variable]
	    {PLACE_IMAGE items/gohere.png 4 10}
	[/command]
	[/option]
[/message]
#enddef

#define PURCHASE_RING
    [message]
	id=Sir Dryden
	message= _ "Unfortunately...the merchant is selling the Ring of Opposite Alignment for 50 pieces of gold, and due to my paladin vows of poverty I can't afford it."
    [/message]
    {TEAM_HAS_GOLD 50 $master_ooze}			
    [if]		
	[variable] 
	    name=has_gold 
	    equals=yes
	[/variable]
    [then]
	[message]
	    id=$speaker_id
	    message= _ "(What to say?)"
	[option]
	    message= _ "(Buy the ring) I'll pay for it."
	    [command]
		[remove_item]
		    x,y=8,12
		[/remove_item]
                {TEAM_GOLD lost 50 $master_ooze}
		[message]
                    [show_if]
                        [variable]
                            name=master_ooze
                            numerical_equals=1
                        [/variable]
                    [/show_if]
		    id=Sir Dryden
		    message= _ "Milady, you are a saint! (He rushes off to get the ring and returns in a few minutes.)"
		[/message]
                [message]
                    [show_if]
                        [variable]
                            name=master_ooze
                            numerical_equals=2
                        [/variable]
                    [/show_if]
		    id=Sir Dryden
		    message= _ "Sir, you are a saint! (He rushes off to get the ring and returns in a few minutes.)"
		[/message]
		[message]
		    id=Sir Dryden
		    message= _ "Now you must convince Corinna to put on the ring. I'll leave the details up to you."
		[/message]
		[message]
		    speaker=narrator
		    message= _ "You got the Ring of Opposite Alignment!"		
		    image=items/ring-gold.png
		[/message]
		[set_variable]
		    name=dryden_quest
		    value=5
		[/set_variable]
		{PLACE_IMAGE items/gohere.png 4 10}
	
	    [/command]
	[/option]
	[option]
	    message= _ "(Decline to help) Sorry, I can't help you right now."
	    [command]
		[message]
                    [show_if]
                        [variable]
                            name=master_ooze
                            numerical_equals=1
                        [/variable]
                    [/show_if]
		    id=Sir Dryden
		    message= _ "Of course, milady. I know it was a lot to ask. Thank you for all your help. I must now contemplate my next course of action."
		[/message]
                [message]
                    [show_if]
                        [variable]
                            name=master_ooze
                            numerical_equals=2
                        [/variable]
                    [/show_if]
		    id=Sir Dryden
		    message= _ "Of course, sir. I know it was a lot to ask. Thank you for all your help. I must now contemplate my next course of action."
		[/message]
	    [/command]
        [/option]
        [/message]
    [/then]
    [else]		
	[message]
	    id=$speaker_id
	    message= _ "I'm sorry, I don't have that much money either."
	[/message]
	[message]
            [show_if]
                [variable]
                    name=master_ooze
                    numerical_equals=1
                [/variable]
            [/show_if]
	    id=Sir Dryden
	    message= _ "Of course, milady. I know it was a lot to ask. Thank you for all your help. I must now contemplate my next course of action."
        [/message]
        [message]
            [show_if]
                [variable]
                    name=master_ooze
                    numerical_equals=2
                [/variable]
            [/show_if]
	    id=Sir Dryden
	    message= _ "Of course, sir. I know it was a lot to ask. Thank you for all your help. I must now contemplate my next course of action."
        [/message]
	[message]
	    id=$speaker_id
	    message= _ "(If you still want to help Sir Dyden you can come back later with the money.)"
	[/message]
     [/else]
     [/if]
#enddef 

#define DRYDEN_WINS
    [remove_item]
	x,y=8,12
    [/remove_item]
    [message]
	id=$speaker_id
	message= _ "I gave her the ring and she put it on. I...guess it worked. At least, I'm assuming it did based on the fact she hasn't melted the flesh off your bones yet."
    [/message]
    [message]
	id=Sir Dryden
	message= _ "Well, I guess that's good news. I must admit I was hoping for a more instantaneous transition to Good, but perhaps the ring takes time to work."
    [/message]
    [message]
	id=$speaker_id
	message= _ "Or maybe she's just really, really evil."
    [/message]
    [message]
        [show_if]
            [variable]
                name=master_ooze
                numerical_equals=1
            [/variable]
        [/show_if]
	id=Sir Dryden
	message= _ "Maybe. I'll have to wait and see. As for you milady, you have done more for me than I ever could have hoped for. If you ever need a paladin by your side, I will be there."
    [/message]
    [message]
        [show_if]
            [variable]
                name=master_ooze
                numerical_equals=2
            [/variable]
        [/show_if]
	id=Sir Dryden
	message= _ "Maybe. I'll have to wait and see. As for you good sir, you have done more for me than I ever could have hoped for. If you ever need a paladin by your side, I will be there."
    [/message]
    [message]
	id=$speaker_id
	message= _ "Thank you."
    [/message]
    [set_variable]
	name=dryden_friend
	value=$master_ooze
    [/set_variable]
    {VARIABLE corinna_friend $master_ooze}
    {VARIABLE dryden_friend $master_ooze}
    {VARIABLE_OP leaderless_troops sub 1}
    {LEADERSHIP 2 $master_ooze}
#enddef

#define DRYDEN_LOSES
    [remove_item]
	x,y=8,12
    [/remove_item]
    [message]
	id=$speaker_id
	message= _ "I gave her the ring but she didn't put it on and I don't think she's going to."
    [/message]
    [message]
	id=Sir Dryden
	message= _ "Nooo! All that effort, for nothing! I...I can't live like this...this unrequited love is consuming me from within! I must...flee Fort Pinewood before I go mad with grief."
    [/message]
    [kill]
	id=Sir Dryden
    [/kill]
#enddef

#define CORRINA_PROBLEM
    [remove_item]
	x,y=4,10
    [/remove_item]
    [message]
	id=Corinna
	message= _ "(This pretty young woman scowls at you as you approach.)"
    [/message]
    [message]
	id=Corinna
	message= _ "Let me guess. That tin-headed oaf of a paladin is still pining for me outside the gates of my estate, and he sent you to do his dirty work."
    [/message]
    [message]
	id=$speaker_id
	message= _ "(What to say?)"
	[option]
	    message= _ "(Be indifferent) That's right. I've got a letter for you."
	    [command]
		[message]
		    id=Corinna
		    message= _ "Not another one!"
		[/message]
	    [/command]
	[/option]
	[option]
	    message= _ "(Try to change her mind) But he loves you! He wrote you this love letter!"
	    [command]
	       [message]
	           id=Corinna
	           message= _ "Not another one!"
	       [/message]
	    [/command]
        [/option]
    [/message]
    [message]
        [show_if]
            [variable]
                name=master_ooze
                numerical_equals=1
            [/variable]
        [/show_if]
	id=Corinna
	message= _ "Look, I'll pay you 75 pieces of gold if you can get rid of Sir Dryden for me. Kill him, trick him, marry him, whatever, just make him go away!"
    [/message]
    [message]
        [show_if]
            [variable]
                name=master_ooze
                numerical_equals=2
            [/variable]
        [/show_if]
	id=Corinna
	message= _ "Look, I'll pay you 75 pieces of gold if you can get rid of Sir Dryden for me. Kill him, trick him, do whatever is necessary, just make him go away!"
    [/message]
    [message]
	id=$speaker_id
	message= _ "(How to respond to her offer?)"
	[option]
	    message= _ "(Accept the offer) All right, I'll get rid of Sir Dryden for you."
	    [command]
		[message]
		    id=Corinna
		    message= _ "Thanks. Come back here when the job is done for your reward."
		[/message]
	    [/command]
        [/option]
	[option]
	    message= _ "(Reject the offer) No! Sir Dryden was right about you, you're evil!"
	    [command]
		[message]
		    id=Corinna
		    message= _ " (Menacingly) You've worn out your welcome here. Leave. Now."
		[/message]
	    [/command]
	[/option]
    [/message]
    {PLACE_IMAGE items/gohere.png 8 12}
    [set_variable]
	name=dryden_quest
	value=2
    [/set_variable]
#enddef

#define CORRINA_WINS
    [remove_item]
	x,y=4,10
    [/remove_item]
    [message]
	id=$speaker_id
	message= _ "Your paladin problem has been taken care of. (You relate the details of what happened.)"
    [/message]
    [message]
	id=Corinna
	message= _ "Ha ha! What a clever way to get rid of that pompous fool! Here's your 75 gold, plus a little extra for your creativity!"
    [/message]
    {TEAM_GOLD gain 90 $master_ooze}
    {VARIABLE corinna_friend $master_ooze}
    {VARIABLE_OP leaderless_troops sub 1}
    {LEADERSHIP 1 $master_ooze}	
#enddef

#define CORRINA_CHOICE
    [remove_item]
	x,y=4,10
    [/remove_item]
    [message]
	id=$speaker_id
	message= _ "I've got another gift for you from your admirer."
    [/message]
    [message]
	id=Corinna
	message= _ "How dare you waste my time with this!"
    [/message]	
    [message]
	id=$speaker_id
	message= _ "(What to say?)"
	[option]
	    message= _ "(Lie) But you'll like this gift. It's a Ring of Magic Power!"
	    [command]
		[message]
		    id=Corinna
		    message= _ "Well, maybe Dryden isn't as useless as he appeared. (She takes the ring and puts it on)."
		[/message]
		[message]
		    id=Corinna
		    message= _ "(She gets angry) Wait a minute! This isn't a Ring of Magic Power! (She tries to take it off but can't) It's cursed! Why that lousy, conniving paladin! I'll melt the flesh off his bones! I'll...eh...(She swoons) Actually, my head hurts. I...I need to rest. Yes, rest, and think some things over."
		[/message]
		[set_variable]
		    name=dryden_quest
		    value=6
		[/set_variable]
	   [/command]
	[/option]
	[option]
	    message= _ "(Tell the truth) Dryden is giving you a chance to turn your life around with this Ring of Opposite Alignment."
	    [command]
		[message]
		    id=Corinna
		    message= _ "So he's trying to befuddle me with a cursed ring, eh? I'll take the ring, as I might find some uses for it. Uses which will not, of course, include wearing it. Here's some money for your trouble, and give my regards to that idiot paladin! (She laughs cruelly.)"
		[/message]
		[set_variable]
		    name=dryden_quest
		    value=7
		[/set_variable]
                {TEAM_GOLD gain 100 $master_ooze}
	    [/command]
        [/option]
    [/message]
    {PLACE_IMAGE items/gohere.png 8 12}
#enddef

#define SIR_DRYDEN SIDE
    [set_variable]
        name=master_ooze
        value={SIDE}
    [/set_variable]
    [if]
      [variable]
        name=master_ooze
        numerical_equals=1
      [/variable]   
    [then]
      [set_variable]
        name=speaker_id
        value=Master Ooze
      [/set_variable]   
    [/then]
    [else]
      [set_variable]
        name=speaker_id
        value=Master Ooze 2
      [/set_variable]   
    [/else]
    [/if]
    {LANGUAGE_PFIXES $master_ooze}
    [if]
       [variable]
	   name=dryden_quest
	   numerical_equals=0
	[/variable]
    [then]
        {DRYDEN_PROBLEM}
    [/then]
    [/if]
		
    [if]
       [variable]
	   name=dryden_quest
	   numerical_equals=2
	[/variable]
    [then]
	{DRYDEN_RESPONSE}
    [/then]
    [/if]
		
    [if]
       [variable]
	   name=dryden_quest
	   numerical_equals=3
	[/variable]
    [then]
	{PURCHASE_RING}
    [/then]
    [/if]
		
    [if]
       [variable]
	   name=dryden_quest
	   numerical_equals=6
       [/variable]
    [then]
	{DRYDEN_WINS}
    [/then]
    [/if]
		
    [if]
       [variable]
	   name=dryden_quest
	   numerical_equals=7
       [/variable]
    [then]
       {DRYDEN_LOSES}
    [/then]
    [/if]
#enddef

#define CORRINA SIDE
    [set_variable]
        name=master_ooze
        value={SIDE}
    [/set_variable]
    [if]
      [variable]
        name=master_ooze
        numerical_equals=1
      [/variable]   
    [then]
      [set_variable]
        name=speaker_id
        value=Master Ooze
      [/set_variable]   
    [/then]
    [else]
      [set_variable]
        name=speaker_id
        value=Master Ooze 2
      [/set_variable]   
    [/else]
    [/if]
    {LANGUAGE_PFIXES $master_ooze}
    [if]
       [variable]
	   name=dryden_quest
	   numerical_equals=1
	[/variable]
    [then]
        {CORRINA_PROBLEM}
    [/then]
    [/if]
		
    [if]
       [variable]
	   name=dryden_quest
	   numerical_equals=4
	[/variable]
    [then]
	{CORRINA_WINS}
    [/then]
    [/if]
		
    [if]
       [variable]
	   name=dryden_quest
	   numerical_equals=5
	[/variable]
    [then]
	{CORRINA_CHOICE}
    [/then]
    [/if]
#enddef

#define FRIST SIDE
    [set_variable]
        name=master_ooze
        value={SIDE}
    [/set_variable]
    {LANGUAGE_PFIXES $master_ooze}
    [if]
      [variable]
        name=master_ooze
        numerical_equals=1
      [/variable]   
    [then]
      [set_variable]
        name=speaker_id
        value=Master Ooze
      [/set_variable]
      {TEAM_HAS_GOLD 30 $master_ooze}
    [if]
	[variable]
	    name=have_training_aurelia
	    numerical_equals=0
	[/variable]
        [and]
            [not]
		[variable] 
	            name=quintains_released
		    numerical_equals=1
		[/variable]
            [/not]
        [/and]
    [then]
    [message]
	id=Frist
	message= _ "Welcome to th' Training Hall. If yer lookin' ta sharpen yer combat skills before taking on th' ooze hordes, yer in the right place!"
    [/message]
    [message]
	id=Frist
	message= _ "Thirty gold will get ya four magical quintains ta hone yer skills on. They shouldn't be too difficult ta defeat, but if ye should happen ta get injured, High Priest Jal on the east side of town can fix ya up in a jiffy!"
    [/message]
    [message]
	id=Frist
	message= _ "So what do ye say lass? Ready ta train?"
    [/message]
    [message]
	id=$speaker_id
	message= _ "(What to say?)"
	[option]
	    message= _ "(Pay 30 gold) I'm ready to train!"
	    [command]
		[if]
		[variable] 
		name=has_gold 
		equals=no
		[/variable]
		[then]
		[message]
		id=Frist
		message= _ "It looks like ye don't have that much. Come back when ye have more gold."
		[/message]
		[/then]
		[/if]

		[if]
		[variable] 
		name=has_gold 
		equals=yes
		[/variable]
		[then]
		{TEAM_GOLD lost 30 $master_ooze}
		[message]
		id=Frist
		message= _ "Release the quintains!"
		[/message]
                {VARIABLE_OP training_aurelia add 1}
                {VARIABLE quintains_released 1}
		[unit]
		type=Quintain0
		side={F3}
                [modifications]
		[object]
		silent=yes
		[effect]
		apply_to=movement_costs 
		replace=true
		[movement_costs]
		castle=99
		[/movement_costs]
		[/effect]
		[/object]
		[/modifications]
		x=7
		y=9
		[/unit]
		[unit]
		type=Quintain0
		side={F3}
		x=7
		y=10
                [modifications]
		[object]
		silent=yes
		[effect]
		apply_to=movement_costs 
		replace=true
		[movement_costs]
		castle=99
		[/movement_costs]
		[/effect]
		[/object]
		[/modifications]
		[/unit]
		[unit]
		type=Quintain0
		side={F3}
                [modifications]
		[object]
		silent=yes
		[effect]
		apply_to=movement_costs 
		replace=true
		[movement_costs]
		castle=99
		[/movement_costs]
		[/effect]
		[/object]
		[/modifications]
		x=8
		y=8
		[/unit]
		[unit]
		type=Quintain0
		side={F3}
                [modifications]
		[object]
		silent=yes
		[effect]
		apply_to=movement_costs 
		replace=true
		[movement_costs]
		castle=99
		[/movement_costs]
		[/effect]
		[/object]
		[/modifications]
		x=8
		y=9
		[/unit]
		[/then]
		[/if]
	    [/command]
	[/option]
	[option]
	    message= _ "(Beg) I'm poor and I don't have 30 gold! But I'm training to help save Fort Pinewood!"
	    [command]
		[if]
		[variable] 
		name=has_gold 
		equals=no
		[/variable]
		[then]
		[message]
		id=Frist
		message= _ "I'll be outta business if I just give away high quality quintain training for free ya know? On the other hand, I'll be outta business if the oozes overrun the town, so ya got yerself a deal lass-- you promise to help defend the fort, and I promise to fund your training!"
		[/message]
		[message]
		id=Frist
		message= _ "Release the quintains!"
		[/message]
                {VARIABLE_OP training_aurelia add 1}
                {VARIABLE quintains_released 1}
                
		[unit]
		type=Quintain0
		side={F3}
                [modifications]
		[object]
		silent=yes
		[effect]
		apply_to=movement_costs 
		replace=true
		[movement_costs]
		castle=99
		[/movement_costs]
		[/effect]
		[/object]
		[/modifications]
		x=7
		y=9
		[/unit]
		[unit]
		type=Quintain0
		side={F3}
                [modifications]
		[object]
		silent=yes
		[effect]
		apply_to=movement_costs 
		replace=true
		[movement_costs]
		castle=99
		[/movement_costs]
		[/effect]
		[/object]
		[/modifications]
		x=7
		y=10
		[/unit]
		[unit]
		type=Quintain0
		side={F3}
                [modifications]
		[object]
		silent=yes
		[effect]
		apply_to=movement_costs 
		replace=true
		[movement_costs]
		castle=99
		[/movement_costs]
		[/effect]
		[/object]
		[/modifications]
		x=8
		y=8
		[/unit]
		[unit]
		type=Quintain0
		side={F3}
                [modifications]
		[object]
		silent=yes
		[effect]
		apply_to=movement_costs 
		replace=true
		[movement_costs]
		castle=99
		[/movement_costs]
		[/effect]
		[/object]
		[/modifications]
		x=8
		y=9
		[/unit]
		[/then]
		[/if]

		[if]
		[variable] 
		name=has_gold 
		equals=yes
		[/variable]
		[then]
		[message]
		id=Frist
		message= _ "I'll be outta business if I just give away high quality quintain training for free ya know? Besides, ye don't look that poor ta me."
		[/message]
		[/then]
		[/if]

	    [/command]
	[/option]
	[option]
	    message= _ "(Leave) I'm not interested in training right now."
	    [command]
		[message]
		    id=Frist
		    message= _ "Come back soon!"
		[/message]
	    [/command]
        [/option]
    [/message]
    [/then]
    [/if]
    [/then]
    [else]
      [set_variable]
        name=speaker_id
        value=Master Ooze 2
      [/set_variable]
    [if]
	[variable]
	    name=have_training_sithras
	    numerical_equals=0
	[/variable]
    [then]
    [message]
	id=Frist
	message= _ "Welcome to th' Training Hall. Yer lookin' ta sharpen yer combat skills before taking on th' ooze hordes, ya?"
    [/message]
    [message]
	id=Frist
	message= _ "Ye look to me like a skilled fighter, so I'm afraid that ya won't learn anything here. Yer gonna have ta go ta the arena. Sergeant Ryn can help ya."
    [/message]
    [message]
	id=Frist
	message= _ "(He thinks for a little while.) Ya elves have too much faith in yer dexterity. In tha arena there's no place for that... I have something that can help ya. It's a potion of protection. Take it."
    [/message]
    [message]
        speaker=narrator
	message= _ "You got a potion of protection! It will increase your defense during fights in the arena by 30%. The potion will last for the first few skirmishes."
	image=items/potion-grey.png
    [/message]
    [message]
	id=Sergeant Ryn
	message= _ "Frist told me that you are a skilled warrior, but here in the Arena it's the real deal. Combat is brutal and to the death. Injury is guaranteed. But if you have what it takes to compete you can earn some good money and get valuable combat experience."
    [/message]
    {VARIABLE have_training_sithras 1}

    [if]
        [variable]
            name=have_training_aurelia
            numerical_equals=1
        [/variable]
    [then]
        [remove_item]
	x,y=6,9
	[/remove_item]
    [/then]
    [else]
	[label]
	x,y=10,6
	text= _ "Arena"
	[/label]	
	{PLACE_IMAGE items/gohere.png 10 6}
	{PLACE_IMAGE items/gohere.png 10 15}
    [/else]
    [/if]
    [message]
	speaker=narrator
	message= _ "When you're finished exploring Fort Pinewood, head back to the front gate!"
	image=wesnoth-icon.png
    [/message]
    [/then]
    [/if]
    [/else]
    [/if] 
#enddef

#define AURELIA_SKILLS
    [message]
	id=Master Ooze
	message= _ "(You're out of breath and slicked with sweat. You've really pushed yourself hard, but it seems your efforts have paid off. You've unlocked some of the magical secrets of your elven host!)"
    [/message]
#enddef

#define AURELIA_TRAINING
    [message]
	id=Frist
	message= _ "Yer a quick learner lass, one o' the quickest I've ever seen. But ye won't learn anything more from beat'n up on quintains. If ye want ta continue ta train, yer gonna have ta go ta the arena. Sergeant Ryn can help ya, but the risk will be greater."
    [/message]
    [message]
	id=Sergeant Ryn
	message= _ "Frist told me that you were one of his best students at the Training Hall, but here in the Arena it's the real deal. Combat is brutal and to the death. Injury is guaranteed. But if you have what it takes to compete you can earn some good money and get valuable combat experience."
    [/message]
    [kill]
    side={F3}
    [/kill]
    {VARIABLE have_training_aurelia 1}
    {CLEAR_VARIABLE training_aurelia}
    [if]
        [variable]
            name=have_training_sithras
            numerical_equals=1
        [/variable]
    [then]
        [remove_item]
	x,y=6,9
	[/remove_item]
    [/then]
    [else]
	[label]
	x,y=10,6
	text= _ "Arena"
	[/label]	
	{PLACE_IMAGE items/gohere.png 10 6}
	{PLACE_IMAGE items/gohere.png 10 15}
    [/else]
    [/if]
    [message]
	speaker=narrator
	message= _ "When you're finished exploring Fort Pinewood, head back to the front gate!"
	image=wesnoth-icon.png
    [/message]
#enddef

#define AURELIA_SKILLS_2
    [message]
	id=Master Ooze
	message= _ "Your prowess is unmatched! Through hard work and great courage you've forged yourself into a mighty enchantress! You've learned to tap deeply into the magic power of your elven blood!"
    [/message]
#enddef

#define AURELIA_CHALLENGE
    [if]
        [variable]
            name=have_training_sithras
            greater_than=2
        [/variable]
    [then]
        [message]
	    id=Sergeant Ryn
	    message= _ "Very impressive. I'm afraid you've been so successful in the arena that our stock of monsters has been almost completely depleted! Unfortunately we can't offer any new challenges for you..."
	[/message]
        [message]
	    id=Sergeant Ryn
	    message= _ "We had a wild gryphon. But Sithras, champion of our arena, has already slain the fearsome beast."
	[/message]
        {VARIABLE pinewood_arena_closed yes}
        [remove_item]
	    x,y=10,6
	[/remove_item]
    [/then]
    [else]
        [message]
	    id=Sergeant Ryn
	    message= _ "Very impressive. I'm afraid you've been so successful in the arena that our stock of monsters has been almost completely depleted! There is one last challenge that we can offer you..."
        [/message]
        [message]
            id=Sergeant Ryn
	    message= _ "We have a wild gryphon. It is a fearsome beast with sharp talons and a deadly beak. Already the creature has slain four challengers. The reward for defeating the gryphon is 30 gold pieces, but the risk will be greater than any you've faced before."
        [/message]
    [/else]
    [/if]
    [set_variable]
	name=have_training_aurelia
	value=2
    [/set_variable]
#enddef

#define PINEWOOD_ARENA SIDE
    [set_variable]
        name=master_ooze
        value={SIDE}
    [/set_variable]
    [if]
      [variable]
        name=master_ooze
        numerical_equals=1
      [/variable]   
    [then]
      [set_variable]
        name=speaker_id
        value=Master Ooze
      [/set_variable]   
    [/then]
    [else]
      [set_variable]
        name=speaker_id
        value=Master Ooze 2
      [/set_variable]   
    [/else]
    [/if]
    {LANGUAGE_PFIXES $master_ooze}
    [if]
	[variable]
	    name=ongoing_fight
	    numerical_equals=0
	[/variable]
    [then]
    {RANDOM 1..7}
    [set_variable]
	name=foe_number
	value=$random
    [/set_variable]
	[message]
	    id=Sergeant Ryn
	    message= _ "Welcome to the Pinewood Arena, where gladiators fight monsters for glory and profit. Gladiators may not leave the arena before a fight is finished. All fights are to the death. Healing is available from High Priest Jal to the east. "
	[/message]
	[message]
	    id=Sergeant Ryn
	    message= _ "Do you want to compete?"
	[/message]
	[message]
	    id=$speaker_id
	    message= _ "(What to say?)"
	    [option]
		message= _ "I'm ready to fight!"
		[command]
		    [message]
			id=Sergeant Ryn
			message= _ "Let the match begin!"
		    [/message]
				
		    [set_variable]
		        name=ongoing_fight
			value=$master_ooze
		    [/set_variable]

            [object]
			silent=yes
			[filter]
			    id=Sergeant Ryn
			[/filter]
			[effect]
			    apply_to=defense 
			    replace=true
			    [defense]
			        castle=0
			    [/defense]
			[/effect]
		    [/object]
	
		    [object]
			silent=yes
			[filter]
			id=Master Ooze
			[/filter]
			[effect]
			apply_to=movement_costs 
			replace=true
			[movement_costs]
			castle=99
			[/movement_costs]
			[/effect]
		    [/object]

                    [object]
			silent=yes
			[filter]
			id=Master Ooze 2
			[/filter]
			[effect]
			apply_to=movement_costs 
			replace=true
			[movement_costs]
			castle=99
			[/movement_costs]
			[/effect]
		    [/object]

                    [if]
                        [variable]
                            name=ongoing_fight
                            numerical_equals=2
                        [/variable]
                        [then]
                            [object]
			        silent=yes
			        [filter]
			            id=Master Ooze 2
			        [/filter]
			        [effect]
			            apply_to=defense 
			            replace=true
			            [defense]
			                flat=30
			            [/defense]
			        [/effect]
		            [/object]
                        [/then]
                    [/if]			

		    [if]
			[variable]
			    name=foe_number
			    numerical_equals=1
			[/variable]
		    [then]
			[unit]
			    type=Blood Bat
			    side={F2}
			    id=Arena Monster
			    name= _ "Arena Monster"
			    [modifications]
				[object]
				silent=yes
				[effect]
				apply_to=movement_costs 
				replace=true
				[movement_costs]
				castle=99
				[/movement_costs]
				[/effect]
				[effect]
				apply_to=movement 
				set=1
				[/effect]
				[/object]
			    [/modifications]
			    x=10
			    y=7
			[/unit]					
	       	    [/then]
		    [/if]

	            [if]
			[variable]
			    name=foe_number
			    numerical_equals=2
			[/variable]
		    [then]
			[unit]
			    type=Drake Glider
			    side={F2}
			    id=Arena Monster
			    name= _ "Arena Monster"
			    [modifications]
			        [object]
				silent=yes
				[effect]
				apply_to=movement_costs 
				replace=true
				[movement_costs]
				castle=99
				[/movement_costs]
				[/effect]
				[effect]
				apply_to=movement 
				set=1
				[/effect]
				[/object]
			    [/modifications]
			    x=10
			    y=7
			[/unit]					
	            [/then]
		    [/if]

		     [if]
			 [variable]
			     name=foe_number
			     numerical_equals=3
			 [/variable]
		     [then]
			 [unit]
			     type=Giant Scorpion
			     side={F2}
			     id=Arena Monster
			     name= _ "Arena Monster"
			     [modifications]
				[object]
				silent=yes
				[effect]
				apply_to=movement_costs 
				replace=true
				[movement_costs]
				castle=99
				[/movement_costs]
				[/effect]
				[effect]
				apply_to=movement 
				set=1
				[/effect]
				[/object]
			    [/modifications]
			    x=10
			    y=7
			[/unit]
	            [/then]
	            [/if]

	            [if]
			[variable]
		            name=foe_number
		            numerical_equals=4
			[/variable]
		    [then]
			[unit]
		            type=Young Ogre
			    side={F2}
			    id=Arena Monster
			    name= _ "Arena Monster"
			    [modifications]
				[object]
				silent=yes
				[effect]
				apply_to=movement_costs 
				replace=true
				[movement_costs]
				castle=99
				[/movement_costs]
				[/effect]
				[effect]
				apply_to=movement 
				set=1
				[/effect]
				[/object]
			    [/modifications]
			    x=10
			    y=7
		        [/unit]
		    [/then]
		    [/if]

		    [if]
			[variable]
			    name=foe_number
			    numerical_equals=5
			[/variable]
		    [then]
			[unit]
			    type=Saurian Skirmisher
			    side={F2}
			    id=Arena Monster
			    name= _ "Arena Monster"
			    [modifications]
				[object]
				silent=yes
				[effect]
				apply_to=movement_costs 
				replace=true
				[movement_costs]
				castle=99
				[/movement_costs]
				[/effect]
				[effect]
				apply_to=movement 
				set=1
				[/effect]
				[/object]
			    [/modifications]
			    x=10
			    y=7
			[/unit]
		    [/then]
		    [/if]

		    [if]
			[variable]
			    name=foe_number
			    numerical_equals=6
			[/variable]
	            [then]
			[unit]
	       		    type=Goblin Impaler
			    side={F2}
			    id=Arena Monster
			    name= _ "Arena Monster"
			    [modifications]
				[object]
				silent=yes
				[effect]
				apply_to=movement_costs 
				replace=true
				[movement_costs]
				castle=99
				[/movement_costs]
				[/effect]
				[effect]
				apply_to=movement 
				set=1
				[/effect]
				[/object]
			    [/modifications]
			    x=10
			    y=7
			[/unit]					
		    [/then]
		    [/if]

		    [if]
			[variable]
		    	    name=foe_number
			    numerical_equals=7
			[/variable]
		    [then]
			[unit]
			    type=Wolf
			    side={F2}
			    id=Arena Monster
			    name= _ "Arena Monster"
			    [modifications]
				[object]
				silent=yes
				[effect]
				apply_to=movement_costs 
				replace=true
				[movement_costs]
				castle=99
				[/movement_costs]
				[/effect]
				[effect]
				apply_to=movement 
				set=1
				[/effect]
				[/object]
			    [/modifications]
			    x=10
			    y=7
			[/unit]					
		    [/then]
		    [/if]
				
		[/command]
	    [/option]
	    [option]
		message= _ "I'm not interested in fighting right now."
	 	[command]
		    [message]
			id=Sergeant Ryn
			message= _ "Fair enough. Come back when you're ready."
		    [/message]
		[/command]
	    [/option]
	[/message]
	[/then]
	[/if]
#enddef

#define MONSTER_DIE SIDE
    {TEAM_GOLD win 10 {SIDE}}  

    [object]
	silent=yes
	[filter]
	    id=Master Ooze
	[/filter]
        [effect]
	apply_to=movement_costs 
	replace=true
	[movement_costs]
	castle=1
	[/movement_costs]
	[/effect]
    [/object]

    [object]
	silent=yes
	[filter]
	    id=Master Ooze 2
	[/filter]
        [effect]
	apply_to=movement_costs 
	replace=true
	[movement_costs]
	castle=1
	[/movement_costs]
	[/effect]
    [/object]

    [object]
	silent=yes
	[filter]
	    id=Sergeant Ryn
	[/filter]
	[effect]
	    apply_to=defense 
	    replace=true
	    [defense]
		castle=40
	    [/defense]
	[/effect]
    [/object]

    [if]
        [variable]
            name=ongoing_fight
            numerical_equals=2
        [/variable]
    [then]
        [object]
	    silent=yes
	    [filter]
		id=Master Ooze 2
	    [/filter]
	    [effect]
		apply_to=defense 
		replace=true
	        [defense]
		    flat=60
	        [/defense]
	    [/effect]
	[/object]
    [/then]
    [/if]

    {VARIABLE fight_end $ongoing_fight}

    [set_variable]
	name=ongoing_fight
	value=0
    [/set_variable]
#enddef

#define SITHRAS_SKILLS TYPE
    {VARIABLE sithras_skill_type {TYPE}}

    [if]
        [variable]
        [/variable]
    [then]
        [message]
	    id=Master Ooze 2
            message= _ "Through countless battles in the arena you have improved your fighting skills! You've managed to develop the combat abilities of your host in a new direction!"
        [/message]
    [/then]
    [else]
        [message]
	    id=Master Ooze 2
	    message= _ "Through countless battles in the arena you have improved your fighting skills! Now you are truly formidable in combat!"
        [/message]
    [/else]
    [/if]

    [message]
        speaker=narrator
	message= _ "Unfortunately your potion of protection has worn off."
	image=items/potion-grey.png
    [/message]

    {CLEAR_VARIABLE sithras_skill_type}
#enddef

#define SITHRAS_CHALLENGE
    [if]
        [variable]
            name=have_training_aurelia
            greater_than=2
        [/variable]
    [then]
        [message]
	    id=Sergeant Ryn
	    message= _ "Very impressive. I'm afraid you've been so successful in the arena that our stock of monsters has been almost completely depleted! Unfortunately we can't offer any new challenge for you..."
	[/message]
        [message]
	    id=Sergeant Ryn
	    message= _ "We had a wild gryphon. But Aurelia, champion of our arena, has already slain the fearsome beast."
	[/message]
        {VARIABLE pinewood_arena_closed yes}
        [remove_item]
	    x,y=10,6
	[/remove_item]
    [/then]
    [else]
	[message]
	    id=Sergeant Ryn
	    message= _ "Very impressive. I'm afraid you've been so successful in the arena that our stock of monsters has been almost completely depleted! There is one last challenge that we can offer you..."
	[/message]
	[message]
	    id=Sergeant Ryn
	    message= _ "We have a wild gryphon. It is a fearsome beast with sharp talons and a deadly beak. Already the creature has slain four challengers. The reward for defeating the gryphon is 30 gold pieces, but the risk will be greater than any you've faced before."
	[/message]
    [/else]
    [/if]
    [set_variable]
	name=have_training_sithras
        value=2
    [/set_variable]
#enddef

#define PINEWOOD_ARENA_CHAMPION SIDE
    [set_variable]
        name=master_ooze
        value={SIDE}
    [/set_variable]
    [if]
      [variable]
        name=master_ooze
        numerical_equals=1
      [/variable]   
    [then]
      [set_variable]
        name=speaker_id
        value=Master Ooze
      [/set_variable]   
    [/then]
    [else]
      [set_variable]
        name=speaker_id
        value=Master Ooze 2
      [/set_variable]   
    [/else]
    [/if]
    {LANGUAGE_PFIXES $master_ooze}
    [if]
	[variable]
	    name=ongoing_fight
	    numerical_equals=0
	[/variable]
    [then]
	[message]
	    id=Sergeant Ryn
	    message= _ "Do you want to fight the gryphon?"
	[/message]
    [message]
	id=$speaker_id
	message= _ "(What to say?)"
	[option]
	    message= _ "Yes!"
	    [command]
		[message]
		    id=Sergeant Ryn
		    message= _ "Release the gryphon!"
		[/message]
				
		[set_variable]
		    name=ongoing_fight
		    value=$master_ooze
		[/set_variable]

                [object]
	            silent=yes
	            [filter]
	                id=Sergeant Ryn
	            [/filter]
	            [effect]
	                apply_to=defense 
	                replace=true
	                [defense]
		            castle=0
	                [/defense]
	            [/effect]
                [/object]

		[object]
		    silent=yes
		    [filter]
		    id=Master Ooze
		    [/filter]
		    [effect]
			apply_to=movement_costs 
			replace=true
			[movement_costs]
			castle=99
			[/movement_costs]
		    [/effect]
		[/object]

                [object]
		    silent=yes
		    [filter]
		    id=Master Ooze 2
		    [/filter]
		    [effect]
			apply_to=movement_costs 
			replace=true
			[movement_costs]
			castle=99
			[/movement_costs]
		    [/effect]
		[/object]
				
		[unit]
		    type=Gryphon
		    side={F2}
		    id=Bloodtalon
		    name= _ "Bloodtalon"
		    [modifications]
		    [object]
			silent=yes
			[effect]
			    apply_to=movement_costs 
			    replace=true
			    [movement_costs]
			    castle=99
			[/movement_costs]
			[/effect]
			[effect]
			    apply_to=movement 
			    set=1
				[/effect]
				[/object]
				[/modifications]
				x=10
				y=7
				[/unit]	
				
			[/command]
		[/option]
		[option]
			message= _ "Not right now."
			[command]
				[message]
				id=Sergeant Ryn
				message= _ "Fair enough. No one will think less of you for walking away from this fight."
				[/message]
			[/command]
		[/option]
	[/message]
	[/then]
	[/if]
#enddef

#define PINEWOOD_ARENA_SPECTATOR SIDE
    [if]
	[variable]
	    name=ongoing_fight
	    numerical_equals=0
	[/variable]
    [then]
    [set_variable]
        name=master_ooze
        value={SIDE}
    [/set_variable]
    [if]
      [variable]
        name=master_ooze
        numerical_equals=1
      [/variable]   
    [then]
      [set_variable]
        name=speaker_id
        value=Master Ooze
      [/set_variable]   
    [/then]
    [else]
      [set_variable]
        name=speaker_id
        value=Master Ooze 2
      [/set_variable]   
    [/else]
    [/if]
    {LANGUAGE_PFIXES $master_ooze}
    [message]
        id=Sergeant Ryn
        message= _ "The arena is closed for anyone besides challengers and monsters. You are not currently a challenger, so for your own safety I have to ask you to leave."
    [/message]
    [message]
        id=$speaker_id
        message= _ "I understand."
    [/message]
    [teleport]
	x=8
	y=4
    [/teleport]
    [/then]
    [/if]
#enddef

#define PINEWOOD_ARENA_CLOSED SIDE
    [if]
	[variable]
	    name=ongoing_fight
	    numerical_equals=0
	[/variable]
    [then]
    [set_variable]
        name=master_ooze
        value={SIDE}
    [/set_variable]
    [if]
        [variable]
            name=master_ooze
            numerical_equals=1
        [/variable]
    [then]
       [if]
           [variable]
	       name=have_training_aurelia
	       numerical_equals=3
	   [/variable]
       [then]
	   [message]
	       id=Sergeant Ryn
     	       message= _ "Welcome back, Champion! Unfortunately the arena is closed until we can restock our monster supply."
	   [/message]
       [/then]
       [else]
           [message]
	       id=Sergeant Ryn
     	       message= _ "Welcome back, Challenger! Unfortunately the arena is closed until we can restock our monster supply."
	   [/message]
       [/else]
       [/if]
    [/then]
    [else]
        [if]
           [variable]
	       name=have_training_sithras
	       numerical_equals=3
	   [/variable]
       [then]
	   [message]
	       id=Sergeant Ryn
     	       message= _ "Welcome back, Champion! Unfortunately the arena is closed until we can restock our monster supply."
	   [/message]
       [/then]
       [else]
           [message]
	       id=Sergeant Ryn
     	       message= _ "Welcome back, Challenger! Unfortunately the arena is closed until we can restock our monster supply."
	   [/message]
       [/else]
       [/if]
    [/else]
    [/if]
    [/then]
    [/if]
#enddef

#define BLOODTALON_DIE SIDE
    {TEAM_GOLD win 30 {SIDE}}

    [if]
        [variable]
            name=ongoing_fight
            numerical_equals=1
        [/variable]
    [then]
        [message]
	    id=Sergeant Ryn
	    message= _ "What a spectacular fight! What a terrific victory! All hail Aurelia, Champion of the Pinewood Arena!"
        [/message]
	
	[set_variable]
	    name=have_training_aurelia
	    value=3
	[/set_variable]

        [if]
            [variable]
                name=have_training_sithras
		numerical_equals=2
            [/variable]
        [then]
            {VARIABLE pinewood_arena_closed yes}
	    [remove_item]
		x,y=10,6
	    [/remove_item]
        [/then]
        [/if]
    [/then]
    [else]
        [message]
	    id=Sergeant Ryn
	    message= _ "What a spectacular fight! What a terrific victory! All hail Sithras, Champion of the Pinewood Arena!"
        [/message]
	
	[set_variable]
	    name=have_training_sithras
	    value=3
	[/set_variable]
        [if]
            [variable]
                name=have_training_aurelia
		numerical_equals=2
            [/variable]
        [then]
            {VARIABLE pinewood_arena_closed yes}
	    [remove_item]
		x,y=10,6
	    [/remove_item]
        [/then]
        [/if]
    [/else]
    [/if]

    [object]
	silent=yes
	[filter]
	    id=Sergeant Ryn
	[/filter]
	[effect]
	    apply_to=defense 
	    replace=true
	    [defense]
		castle=40
	    [/defense]
	[/effect]
    [/object]

    [object]
	silent=yes
	[filter]
	    id=Master Ooze
	[/filter]
        [effect]
	apply_to=movement_costs 
	replace=true
	[movement_costs]
	castle=1
	[/movement_costs]
	[/effect]
    [/object]

    [object]
	silent=yes
	[filter]
	    id=Master Ooze 2
	[/filter]
        [effect]
	apply_to=movement_costs 
	replace=true
	[movement_costs]
	castle=1
	[/movement_costs]
	[/effect]
    [/object]

    {VARIABLE sergeant_ryn_friend $ongoing_fight}
    {VARIABLE fight_end $ongoing_fight}
    {VARIABLE_OP leaderless_troops sub 1}
    {LEADERSHIP 1 $ongoing_fight}

    [set_variable]
	name=ongoing_fight
	value=0
    [/set_variable]
#enddef

#define FONTAINE SIDE
    [set_variable]
        name=master_ooze
        value={SIDE}
    [/set_variable]
    {LANGUAGE_PFIXES $master_ooze}
    [remove_item]
	x,y=15,11
    [/remove_item]
    [if]
        [variable]
            name=quest_fontaine
            numerical_equals=0
        [/variable]
    [then]
    {VARIABLE quest_fontaine $master_ooze}
    [if]
      [variable]
        name=master_ooze
        numerical_equals=1
      [/variable]   
    [then]
      [set_variable]
        name=speaker_id
        value=Master Ooze
      [/set_variable]
      {VARIABLE_OP quests_aurelia add 1}
    [message]
	id=Fontaine
        message= _ "(A young man in fine clothes approaches you and smiles.)"
    [/message]
    [message]
	id=Fontaine
	message= _ "You have a very fine figure, if I may say so milady. May I have the honor of painting your picture?"
    [/message]
    [message]
	id=$speaker_id
	message= _ "(How to respond?)"
	[option]
	    message= _ "(Be suspicious) If you're a painter then what are you doing with those swords?"
	    [command]
		[message]
		    id=Fontaine
		    message= _ "Truthfully, I'm a mercenary by trade. But my true passion lies in painting. (Bitterly) Alas, there isn't much appreciation for high-quality artwork in this backwater frontier town. Guarding the Mayor pays my bills, but one day I'll be famous enough to sell my art for a profit!"
		[/message]
	    [/command]
	[/option]
	[option]
	    message= _ "(Be friendly) Of course you can paint my picture!"
	    [command]
	        [message]
	 	    id=Fontaine
		    message= _ "(Excited) Thank you milady!"
	        [/message]
	    [/command]
	[/option]
    [/message]
    [message]
	id=Fontaine
	message= _ "I'll pay you 30 gold for a day's worth of modeling services. (Hesitantly) Or...60 gold if I may paint you...in your natural, ahem, state."
    [/message]
    [message]
	id=$speaker_id
	message= _ "(How to respond?)"
	[option]
	    message= _ "(Refuse) I'm not about to take a job from a complete stranger."
	    [command]
		[message]
		    id=Fontaine
		    message= _ "(Disappointed Sigh) I assure you I have no ulterior motives, milady, but...if that is your answer I suppose I must accept it. Good day to you. "
		[/message]
	    [/command]
	[/option]
	[option]
	    message= _ "(Accept) You can paint me for 30 gold."
	    [command]
		[message]
		    id=Fontaine
		    message= _ "Thank you milady! I've never painted a specimen as exotic as an elf before! I wonder how much shading I should put on your ears..."
		[/message]
		[message]
		    id=$speaker_id
		    message= _ "(You spend a day modeling for Fontaine!)"
		[/message]
		[message]
		    id=Fontaine
		    message= _ "(Fontaine's painting of you is actually quite good.) "
		[/message]
		[message]
		    id=Fontaine
		    message= _ "(Proud) One of my better works, to be sure. And here is your payment milady, you earned every copper."
		[/message]
		{TEAM_GOLD earn 30 $master_ooze}		                
	    [/command]
	[/option]
	[option]
	    message= _ "(Accept) You can paint me nude for 60 gold."
	    [command]
		[message]
		    id=Fontaine
		    message= _ "Thank you milady! I've never painted a specimen as exotic as an elf before! I wonder how much shading I should put on your ears..."
		[/message]
		[message]
		    id=$speaker_id
		    message= _ "(You spend a day modeling nude for Fontaine!)"
		[/message]
		[message]
		    id=Fontaine
		    message= _ "(Fontaine's painting of you is actually quite good.) "
		[/message]
		[message]
		    id=Fontaine
		    message= _ "(Proud) One of my better works, to be sure. And here is your payment milady, you earned every copper!"
		[/message]
		{TEAM_GOLD earn 60 $master_ooze}
		[message]
		    id=Fontaine
		    message= _ "If I may be so bold milady, you are a goddess, a diva! I think I will make you my Muse..."
		[/message]
		[message]
		    id=$speaker_id
		    message= _ "?!"
		[/message]
		[set_variable]
		    name=fontaine_friend
		    value=$master_ooze
		[/set_variable]
                {LEADERSHIP 1 $master_ooze}
	    [/command]
        [/option]
    [/message] 
    [/then]
    [else]
      [set_variable]
        name=speaker_id
        value=Master Ooze 2
      [/set_variable]
      {VARIABLE_OP quests_sithras add 1}
      {TEAM_HAS_GOLD 40 $master_ooze}
      [message]
	id=Fontaine
        message= _ "(You see a young man in fine clothes carefully looking at a painting.)"
    [/message]
    [message]
	id=Fontaine
	message= _ "(He speaks to himself) It's just all wrong...the colors, the shading..."
    [/message]
    [message]
	id=$speaker_id
	message= _ "(How to respond?)"
	[option]
	    message= _ "(Small talk) Did you paint this picture?"
	    [command]
		[message]
		    id=Fontaine
		    message= _ "(He notices you for the first time) I painted it, yes. I'm a mercenary by trade but my true passion lies in painting. (Bitterly) Alas, there isn't much appreciation for high-quality artwork in this backwater frontier town. Guarding the Mayor pays my bills, but one day I'll be famous enough to sell my art for a profit!"
		[/message]
	    [/command]
	[/option]
	[option]
	    message= _ "(Offer help) If you want this picture to look better I could help."
	    [command]
	        [message]
	 	    id=Fontaine
		    message= _ "Sorry sir, but you look more like a warrior than a fellow artist."
	        [/message]
	    [/command]
	[/option]
    [/message]
    [message]
	id=$speaker_id
	message= _ "If you would use some different colors here and here it would gain depth."
    [/message]
    [message]
	id=Fontaine
	message= _ "(He thinks for a little while then speaks excitedly) You know, you're absolutely right! I can't believe I didn't see it before! Thank you, friend!"
    [/message]
    [message]
	id=Fontaine
	message= _ "(Hesitantly) Maybe you could tell me how to become a better artist. I'll pay you 30 gold pieces for just one day of your time!"
    [/message]
    [message]
	id=$speaker_id
	message= _ "(How to respond?)"
	[option]
	    message= _ "(Refuse) I'm not about to teach just anyone I meet."
	    [command]
		[message]
		    id=Fontaine
		    message= _ "(Disappointed) I'm sorry if my offer offended you sir... Good day to you."
		[/message]
	    [/command]
	[/option]
	[option]
	    message= _ "(Accept) Fine I will tell you what I know for 30 gold pieces."
	    [command]
		[message]
		    id=Fontaine
		    message= _ "Thank you sir!"
		[/message]
		[message]
		    id=$speaker_id
		    message= _ "(You spend a day teaching Fontaine about art)"
		[/message]
		[message]
		    id=Fontaine
		    message= _ "(When you're done you notice that, if nothing else, Fontaine is a lot more confident now.) "
		[/message]
		[message]
		    id=Fontaine
		    message= _ "Thank you sir, our collaboration was my pleasure. And here is your payment as promised."
		[/message]
		{TEAM_GOLD earn 30 $master_ooze}		                
	    [/command]
	[/option]
	[option]
            [show_if]
                [variable]
                    name=has_gold
                    equals=yes
                [/variable]
            [/show_if]
	    message= _ "(Patronize) I'll not only teach you about art but also pay you 40 gold pieces to support your efforts."
	    [command]
		[message]
		    id=Fontaine
		    message= _ "That's a most generous offer my lord!"
		[/message]
		[message]
		    id=$speaker_id
		    message= _ "(You spend a day teaching Fontaine about art)"
		[/message]
		[message]
		    id=Fontaine
		    message= _ "(When you're done you notice that, if nothing else, Fontaine is a lot more confident now.) "
		[/message]
		[message]
		    id=Fontaine
		    message= _ "Thank you sir. I think this is the start of a glorious collaboration!"
		[/message]
		{TEAM_GOLD spent 40 $master_ooze}
		[message]
		    id=Fontaine
		    message= _ "Your patronage is much appreciated!"
		[/message]
		[set_variable]
		    name=fontaine_friend
		    value=$master_ooze
		[/set_variable]
                {LEADERSHIP 1 $master_ooze}
	    [/command]
        [/option]
    [/message]
    [/else]
    [/if]
    [/then]
    [/if]   
#enddef 

#define LIVIUS SIDE
    [set_variable]
        name=master_ooze
        value={SIDE}
    [/set_variable]
    [if]
      [variable]
        name=book_hunt
        numerical_equals=0
      [/variable]
      [and]
         [variable]
            name=livius_friend
            numerical_equals=0
         [/variable]
      [/and]
    [then]
    [if]
      [variable]
        name=master_ooze
        numerical_equals=1
      [/variable]   
    [then]
      {VARIABLE_OP quests_aurelia add 1}
    [/then]
    [else]
      {VARIABLE_OP quests_sithras add 1}  
    [/else]
    [/if]
    {LANGUAGE_PFIXES $master_ooze}
    [remove_item]
	x,y=15,7
    [/remove_item]
    [message]
	id=Livius
	message= _ "Fie and fiddle, where has my blasted book gone?! You! Elf! If you happen to see a thick silver tome, bring it to me immediately for a reward!"
    [/message]
    [set_variable]
	name=book_hunt
	value=$master_ooze
    [/set_variable]
    [/then]
    [/if]
#enddef

#define LIVIUS_BOOK SIDE
    [set_variable]
        name=master_ooze
        value={SIDE}
    [/set_variable]
    [if]
      [variable]
        name=master_ooze
        numerical_equals=1
      [/variable]   
    [then]
      [set_variable]
        name=speaker_id
        value=Master Ooze
      [/set_variable]   
    [/then]
    [else]
      [set_variable]
        name=speaker_id
        value=Master Ooze 2
      [/set_variable]   
    [/else]
    [/if]
    {LANGUAGE_PFIXES $master_ooze}
    [if]
	[variable]
            name=book_hunt
	    numerical_equals=$master_ooze
	[/variable]
    [then]
        [message]
	    id=$speaker_id
	    message= _ "(This looks like the book that Livius is looking for. You can bring it back to him for a reward.)"
        [/message]
        [set_variable]
	    name=have_book
	    value=$master_ooze
        [/set_variable]
        [remove_item]
	    x,y=3,14
        [/remove_item]
        {PLACE_IMAGE items/gohere.png 15 7}
    [/then]
    [/if]
#enddef

#define LIVIUS_REWARD SIDE
    [set_variable]
        name=master_ooze
        value={SIDE}
    [/set_variable]
    [if]
      [variable]
        name=master_ooze
        numerical_equals=1
      [/variable]   
    [then]
      [set_variable]
        name=speaker_id
        value=Master Ooze
      [/set_variable]   
    [/then]
    [else]
      [set_variable]
        name=speaker_id
        value=Master Ooze 2
      [/set_variable]   
    [/else]
    [/if]
    {LANGUAGE_PFIXES $master_ooze}
    [if]
	[variable]
	    name=have_book
	    numerical_equals=$master_ooze
	[/variable]
    [then]
	[message]
	    id=Livius
	    message= _ "You found my book, 'Exotic Culinary Delights -- How to Serve Magical Oozes, Slimes, and Puddings'!"
	[/message]
	[set_variable]
	    name=have_book
	    value=0
	[/set_variable]
	[set_variable]
	     name=livius_friend
	     value=$master_ooze
	[/set_variable]
        {LEADERSHIP 1 $master_ooze}
	[message]
	    id=Livius
	    message= _ "Here's 30 gold pieces for your help (he tosses a pouch of coins at your feet)."
	[/message]
        {TEAM_GOLD earn 30 $master_ooze}
	[message]
	    id=Livius
	    message= _ "After the Imperial Army crushes the ooze hordes, I'll make a fortune harvesting the corpses of the slimy creatures. They're quite a delicacy, you know!"
	[/message]
	[message]
	    id=$speaker_id
	    message= _ "(You had no idea you were tasty, much less a valuable food commodity)."
	[option]
	    message= _ "(Angry) You horrible man, get away from me!"
	    [command]
		[message]
                    [show_if]
                        [variable]
                            name=master_ooze
                            numerical_equals=1
                        [/variable]
                    [/show_if]
		    id=Livius
		    message= _ "I hope you don't have some misguided sense of sympathy for those monsters. They'd devour a helpless elf lass like yourself in moments! Bah! I don't have any more time to waste on you, I've got cooking preparations to make."
		[/message]
                [message]
                    [show_if]
                        [variable]
                            name=master_ooze
                            numerical_equals=2
                        [/variable]
                    [/show_if]
		    id=Livius
		    message= _ "I hope you don't have some misguided sense of sympathy for those monsters. They'd devour someone like you in moments! Bah! I don't have any more time to waste on you, I've got cooking preparations to make."
		[/message]
	   [/command]
       [/option]
       [option]
	   message= _ "(Wish him luck) Good luck, you're going to need it."
	   [command]
	       [message]
		   id=Livius
		   message= _ "No I won't but thanks all the same. Now if you'll excuse me, I've got cooking preparations to make."
	       [/message]
	   [/command]
	[/option]
        [/message]
        [remove_item]
	    x,y=15,7
        [/remove_item]
    [/then]
    [/if]
#enddef

#define JEDD_FARM_WORK WORK SIDE
    [set_variable]
        name=master_ooze
        value={SIDE}
    [/set_variable]
    [set_variable]
        name=jedd_work
        value={WORK}
    [/set_variable]
    [if]
      [variable]
        name=master_ooze
        numerical_equals=1
      [/variable]   
    [then]
      [set_variable]
        name=speaker_id
        value=Master Ooze
      [/set_variable]   
    [/then]
    [else]
      [set_variable]
        name=speaker_id
        value=Master Ooze 2
      [/set_variable]   
    [/else]
    [/if]
    {LANGUAGE_PFIXES $master_ooze}
    [if] 
        [variable]
            name=hay_hunt
            numerical_equals=$master_ooze
        [/variable]
    [then]
    [if]
        [variable]
            name=jedd_work
            less_than=1
        [/variable]
    [then]
        [if]
	    [variable]
	        name=hay_haul1
	        numerical_equals=0
	    [/variable]
        [then]
            [message]
	        id=$speaker_id
	        message= _ "(You help Jedd with some of his farm work.)"
	    [/message]
	    [set_variable]
	        name=hay_haul1
	        value=1
	    [/set_variable]
	    [remove_item]
	        x,y=13,4
	    [/remove_item]
        [/then]
        [/if]
    [/then]
    [else]
        [if]
            [variable]
                 name=jedd_work
                 less_than=2
            [/variable]
        [then]
            [if]
	        [variable]
	            name=hay_haul2
	            numerical_equals=0
	        [/variable]
            [then]
                [message]
	            id=$speaker_id
	            message= _ "(You help Jedd with some of his farm work.)"
	        [/message]
	        [set_variable]
		    name=hay_haul2
		    value=1
	         [/set_variable]
	         [remove_item]
		     x,y=13,3
	         [/remove_item]
             [/then]
             [/if]
         [/then]
         [else]
             [if]
                 [variable]
                     name=jedd_work
                     less_than=3
                 [/variable]
             [then]
                 [if]
	             [variable]
	                 name=hay_haul3
	                 numerical_equals=0
	             [/variable]
                 [then]
                     [message]
	                 id=$speaker_id
	                 message= _ "(You help Jedd with some of his farm work.)"
	             [/message]
	             [set_variable]
		         name=hay_haul3
		         value=1
	             [/set_variable]
	             [remove_item]
		         x,y=15,5
	             [/remove_item]
                 [/then]
                 [/if]
             [/then]
             [/if]
         [/else]
         [/if]
    [/else]
    [/if]
    [/then]
    [/if]
#enddef

#define JEDD SIDE
    [set_variable]
        name=master_ooze
        value={SIDE}
    [/set_variable]
    [if]
      [variable]
        name=master_ooze
        numerical_equals=1
      [/variable]   
    [then]
      [set_variable]
        name=speaker_id
        value=Master Ooze
      [/set_variable]
      {VARIABLE_OP quests_aurelia add 1}   
    [/then]
    [else]
      [set_variable]
        name=speaker_id
        value=Master Ooze 2
      [/set_variable]
      {VARIABLE_OP quests_sithras add 1}
    [/else]
    [/if]
    {LANGUAGE_PFIXES $master_ooze}
    [if]
        [variable]
            name=hay_hunt
            less_than=1
        [/variable]
    [then]
    [message]
	id=$speaker_id
	message= _ "(You see a sun-tanned farmer by the roadside leaning heavily on his pitchfork.)"
    [/message]
    [message]
       id=$speaker_id
       message= _ "(What to say?)"
       [option]
	   message= _ "(Friendly) Hello sir! How are you this fine day?"
       [command]
           [message]
	       id=Jedd
	       message= _ "(He spits some tobacco) Lousy. Threw my back out bringing in the harvest. Can't bring the rest of my hay to market with a bad back, so I'm about to go broke. Have to sell the farm. So yeah, I've had better days."
	   [/message]
	   [message]
	       id=Jedd
	       message= _ "Maybe you can help me? I need to hire a farmhand to bring in the rest of my hay before it rots. What do you say to 30 gold and a day's worth of honest labor?"
	   [/message]
				
	   [/command]
       [/option]
       [option]
	   message= _ "(Small talk) So what's your opinion on the ooze crisis?"
	   [command]
	       [message]
		   id=Jedd
		   message= _ "(He spits some tobacco) The what crisis?"
		[/message]
		[message]
		    id=$speaker_id
		    message= _ "Surely you've heard that there's a horde of ravenous amorphous creatures rampaging across the countryside."
		[/message]
		[message]
		    id=Jedd
		    message= _ "(He stares at you blankly.)"
		[/message]
		[message]
		    id=$speaker_id
		    message= _ "They beat the Pinewood Militia!"
		[/message]
		[message]
		    id=Jedd
		    message= _ "Sorry, I don't get out much."
		[/message]
		[message]
                    [show_if]
                        [variable]
                            name=master_ooze
                            numerical_equals=1
                        [/variable]
                    [/show_if]
		    id=Jedd
		    message= _ "I'm just a simple farmer. I don't got time for monsters, militias, or that idiot mayor of ours. Not a one of 'em ever did a hard days' work! But you lass, you look like you might be able to help me..."
		[/message]
                [message]
                    [show_if]
                        [variable]
                            name=master_ooze
                            numerical_equals=2
                        [/variable]
                    [/show_if]
		    id=Jedd
		    message= _ "I'm just a simple farmer. I don't got time for monsters, militias, or that idiot mayor of ours. Not a one of 'em ever did a hard days' work! But you sir, you look like you might be able to help me..."
		[/message]
		[message]
		    id=Jedd
		    message= _ "I threw out my back bringing in the summer harvest. I need to hire a farmhand to bring in those bushels o' hay oe'er yonder before they rot. What do you say to 30 gold and a day's worth of honest labor?"
		[/message]
	    [/command]
	[/option]
    [/message]

    [message]
	id=$speaker_id
	message= _ "(What to say?)"
	[option]
	    message= _ "(Agree to Help) I'll help you!"
	    [command]
		[message]
		    id=Jedd
		    message= _ "(He spits some more tobacco) Great. The hay is right next to my farm. Return here when you're done."
		[/message]
		[set_variable]
		    name=hay_hunt
		    value=$master_ooze
		[/set_variable]
		[set_variable]
		    name=hay_haul1
		    value=0
		[/set_variable]
		[set_variable]
		    name=hay_haul2
		    value=0
		[/set_variable]
		[set_variable]
		    name=hay_haul3
		    value=0
		[/set_variable]
				
	    [/command]
	[/option]
	[option]
	    message= _ "(Refuse) I don't have time for this."
	    [command]
		[message]
		    id=Jedd
		    message= _ "(He spits some more tobacco) Suit yourself."
		[/message]
		[remove_item]
		    x,y=14,5
		[/remove_item]
                [set_variable]
	            name=hay_hunt
	            value=3
	        [/set_variable]
	   [/command]
	[/option]
    [/message]
    [/then]
    [/if]
#enddef

#define JEDD_WORK_DONE SIDE
    [set_variable]
        name=master_ooze
        value={SIDE}
    [/set_variable]
    [if]
      [variable]
        name=master_ooze
        numerical_equals=1
      [/variable]   
    [then]
      [set_variable]
        name=speaker_id
        value=Master Ooze
      [/set_variable]   
    [/then]
    [else]
      [set_variable]
        name=speaker_id
        value=Master Ooze 2
      [/set_variable]   
    [/else]
    [/if]
    {LANGUAGE_PFIXES $master_ooze}
    [if]
	[variable]
	    name=hay_hunt
	    numerical_equals=$master_ooze
	[/variable]
	[and]
	    [variable]
		name=hay_haul1
		numerical_equals=1
	    [/variable]
	[/and]
	[and]
	    [variable]
		name=hay_haul2
		numerical_equals=1
	    [/variable]
	[/and]
	[and]
	    [variable]
		name=hay_haul3
		numerical_equals=1
	    [/variable]
	[/and]
    [then]
        [message]
            [show_if]
                [variable]
                    name=master_ooze
                    numerical_equals=1
                [/variable]
            [/show_if]
	    id=Jedd
	    message= _ "You've been a great help, lass! The world needs more people like you! Here's your thirty gold, plus a little extra!"
	[/message]
        [message]
            [show_if]
                [variable]
                    name=master_ooze
                    numerical_equals=2
                [/variable]
            [/show_if]
	    id=Jedd
	    message= _ "You've been a great help, sir! The world needs more people like you! Here's your thirty gold, plus a little extra!"
	[/message]
        [set_variable]
	    name=jedd_friend
	    value=$master_ooze
        [/set_variable]
        {LEADERSHIP 1 $master_ooze}
        {TEAM_GOLD earn 40 $master_ooze}
	[set_variable]
	    name=hay_hunt
	    value=3
	[/set_variable]
	[remove_item]
	    x,y=14,5
	[/remove_item]
   [/then]
   [/if]
#enddef

#define BROCK_CHALLENGE_LOST
    [message]
	id=$speaker_id
	message= _ "(Brock effortlessly pins your arm to the table. You lost!)"
    [/message]
    [message]
        [show_if]
            [variable]
                name=master_ooze
                numerical_equals=1
            [/variable]
        [/show_if]
	id=Brock
	message= _ "Don't be sad lass, many men far stronger than you have challenged me and lost."
    [/message]
    [message]
        [show_if]
            [variable]
                name=master_ooze
                numerical_equals=2
            [/variable]
        [/show_if]
	id=Brock
	message= _ "Don't be sad my boy, many men far stronger than you have challenged me and lost."
    [/message]
#enddef

#define BROCK_CHALLENGE_WIN
    [if]
      [variable]
        name=master_ooze
        numerical_equals=1
      [/variable]   
    [then]
      [if]
        [variable]
            name=brock_friend
            greater_than=2
        [/variable]
        [and]
            [not]
                [variable]
                    name=quests_aurelia
                    greater_than=$quests_limit
                [/variable]
            [/not]
        [/and]
      [then]
        {VARIABLE brock_friend $master_ooze}
        {VARIABLE_OP leaderless_troops sub 1}
        {LEADERSHIP 1 $master_ooze}     
        {VARIABLE_OP quests_aurelia add 1}
      [/then]
      [/if]
    [/then]
    [else]
      [if]
        [variable]
            name=brock_friend
            greater_than=2
        [/variable]
        [and]
            [not]
                [variable]
                    name=quests_sithras
                    greater_than=$quests_limit
                [/variable]
            [/not]
        [/and]
      [then]
        {VARIABLE brock_friend $master_ooze}
        {VARIABLE_OP leaderless_troops sub 1}
        {LEADERSHIP 1 $master_ooze}
        {VARIABLE_OP quests_sithras add 1}
      [/then]
      [/if]    
    [/else]
    [/if]
#enddef

#define BROCK SIDE
    [set_variable]
        name=master_ooze
        value={SIDE}
    [/set_variable]
    {HAS_TRAITS}
    [if]
      [variable]
        name=master_ooze
        numerical_equals=1
      [/variable]   
    [then]
      [set_variable]
        name=speaker_id
        value=Master Ooze
      [/set_variable]
      {VARIABLE brock_challenge $brock_challenge_aurelia}   
    [/then]
    [else]
      [set_variable]
        name=speaker_id
        value=Master Ooze 2
      [/set_variable]
      {VARIABLE brock_challenge $brock_challenge_sithras}    
    [/else]
    [/if]
    {TEAM_HAS_GOLD 5 $master_ooze}
    {LANGUAGE_PFIXES $master_ooze}
    #In multiplayer all costs need to be even numbers, in single player the cost is 5 gold
    [message]
	id=Brock
	message= _ "Welcome to Brock's Tavern. Five gold pieces for full room and board!"
    [/message]
    [if]
	[variable]
            name=brock_challenge
	    numerical_equals=0
	[/variable]
    [then]
	[message]
	    id=Brock
	    message= _ "Or perhaps you've come to challenge me, the Fort Pinewood Armwrestling Champion, to a contest of strength?"
	[/message]
    [/then]
    [/if]
    [message]
	id=$speaker_id
	message= _ "(What to say?)"
	[option]
	    message= _ "(Stay at the Tavern) I want a room."
	    [command]
		[if]
		    [variable] 
			name=has_gold 
			equals=no
		    [/variable]
		[then]
		    [message]
			id=Brock
			message= _ "It looks like you don't have five gold. Come back when you have more gold."
		    [/message]
		[/then]
		[/if]
		[if]
		[variable] 
		    name=has_gold 
		    equals=yes
		[/variable]
		[then]
		[message]
		    id=Brock
		    message= _ "Splendid!"
		[/message]
                {TEAM_GOLD lost 5 $master_ooze}
		[sound]
		    name=heal.wav
	        [/sound]
		[object]
		    [filter]
		        id=$speaker_id
		    [/filter]
		    silent=yes
		    [effect]
		        apply_to=hitpoints
		        heal_full=yes
		    [/effect]
		[/object]
		[message]
		    speaker=narrator
		    message= _ "You wake up the next day feeling refreshed!"
		    image=wesnoth-icon.png
		[/message]
		[/then]
		[/if]
	    [/command]
	[/option]
	[option]
	    message= _ "(Challenge him) I want to challenge you."
	    [command]
		[if]
		    [variable]
			name=brock_challenge
			numerical_equals=2
		    [/variable]
	        [then]
		    [message]
                        [show_if]
                            [variable]
                                name=master_ooze
                                numerical_equals=1
                            [/variable]
                        [/show_if]
		        id=Brock
		        message= _ "Sorry lass, you've already challenged me, remember?"
		    [/message]
                    [message]
                        [show_if]
                            [variable]
                                name=master_ooze
                                numerical_equals=2
                            [/variable]
                        [/show_if]
		        id=Brock
		        message= _ "Sorry boy, you've already challenged me, remember?"
		    [/message]
		[/then]
		[else]
		    [message]
		        id=Brock
		        message= _ "Splendid!"
		    [/message]
		    [set_variable]
		        name=brock_challenge
	        	value=1
		    [/set_variable]
		[/else]
		[/if]
	    [/command]
	[/option]
	[option]
	    message= _ "(Leave) Goodbye."
	    [command]
	        [message]
	            id=Brock
		    message= _ "Come again!"
	        [/message]
	    [/command]
	[/option]
    [/message]

    [if]
	[variable]
	    name=brock_challenge
	    numerical_equals=1
	[/variable]
    [then]
	[message]
            [show_if]
                [variable]
                    name=master_ooze
                    numerical_equals=1
                [/variable]
            [/show_if]
	    id=Brock
	    message= _ "Many strong men have tried to defeat me and failed. I doubt a little elf lass like you will put up much of a fight, but I never turn away a challenger, ha ha!"
	[/message]
        [message]
            [show_if]
                [variable]
                    name=master_ooze
                    numerical_equals=2
                [/variable]
            [/show_if]
	    id=Brock
	    message= _ "Many strong men have tried to defeat me and failed. I doubt a little boy like you will put up much of a fight, but I never turn away a challenger, ha ha!"
	[/message]
	[set_variable]
	     name=brock_challenge
	     value=2
	[/set_variable]
        [if]
            [variable]
                name=master_ooze
                numerical_equals=1
            [/variable]   
        [then]
            [set_variable]
                name=speaker_id
                value=Master Ooze
           [/set_variable]
           {VARIABLE brock_challenge_aurelia $brock_challenge}   
       [/then]
       [else]
          [set_variable]
              name=speaker_id
              value=Master Ooze 2
          [/set_variable]
          {VARIABLE brock_challenge_sithras $brock_challenge}    
       [/else]
       [/if]
	[message]
	    id=$speaker_id
	    message= _ "(You both get into position. Looking at the size of the huge muscles on Brock's arm, you realize that he will not be easy to defeat.)"
	[/message]
	[message]
	    id=$speaker_id
	    message= _ "(What to do?)"
	    [option]
		message= _ "(Force Brock's arm down with sheer brute strength)"
		[command]
		    [if]
			[variable] 
			    name=have_strength
			    numerical_equals=1
			[/variable]
		    [then]
                        [message]
			    id=$speaker_id
			    message= _ "(Both you and Brock grunt with exertion and your arm muscles bulge. At first you seem to be evenly matched, but gradually you prove yourself to be the stronger competitor and force his arm down. You won!)"
			[/message]
			[message]
                            [show_if]
                                [variable]
                                    name=master_ooze
                                    numerical_equals=1
                                [/variable]
                            [/show_if]
			    id=Brock
			    message= _ "(He seems surprised at first but then laughs heartily) You're the strongest elf lass I've ever met! Good show! The reward for beating me is thirty pieces of gold, and you earned every bit of it!"
			[/message]
                        [message]
                            [show_if]
                                [variable]
                                    name=master_ooze
                                    numerical_equals=2
                                [/variable]
                            [/show_if]
			    id=Brock
			    message= _ "(He seems surprised at first but then laughs heartily) You're the strongest elf I've ever met! Good show! The reward for beating me is thirty pieces of gold, and you earned every bit of it!"
			[/message]
                        {BROCK_CHALLENGE_WIN}
			{TEAM_GOLD gain 30 $master_ooze}
		    [/then]
		    [else]
			{BROCK_CHALLENGE_LOST}
		   [/else]
		   [/if]
		[/command]
	    [/option]
	    [option]
		message= _ "(Move quickly as soon as the match starts to take him by surprise)"
		[command]
		    [if]
			[variable] 
			    name=have_quickness
			    numerical_equals=1
			[/variable]
		    [then]
			[message]
			    id=$speaker_id
			    message= _ "(You move with blinding speed the instant the match starts. With a loud THUMP you slam Brock's arm down. He gapes at you in surprise. You won!)"
			[/message]
			[message]
			    id=Brock
			    message= _ "I...I can't believe I lost. By the Gods you're quick. You knew you couldn't overpower me so you counted on me underestimating you. Good show! The reward for beating me is thirty pieces of gold, and you earned every bit of it!"
			[/message]
                        {BROCK_CHALLENGE_WIN}
			{TEAM_GOLD gain 30 $master_ooze}
		   [/then]
		   [else]
		       {BROCK_CHALLENGE_LOST}
		  [/else]
		  [/if]
	      [/command]
	      [/option]
	      [option]
		  message= _ "(Simply try and hold your ground to wear him out)"
		  [command]
		      [if]
			  [variable] 
			      name=have_resilient
			      numerical_equals=1
			  [/variable]
		      [then]
			  [message]
			      id=$speaker_id
			      message= _ "(Brock pushes hard against you but you're able to hold your own...barely. More than a minute passes and beads of sweat break out on both your foreheads. But soon Brock has spent his strength and you're able to claim victory. You won!)"
			  [/message]
			  [message]
			      id=Brock
			      message= _ "I...I can't believe I lost. By the Gods you're hardy. You knew you couldn't outright overpower me so you counted on me wearing myself out. Good show! The reward for beating me is thirty pieces of gold, and you earned every bit of it!"
			  [/message]
                          {BROCK_CHALLENGE_WIN}
			  {TEAM_GOLD gain 30 $master_ooze}
		      [/then]
		      [else]
		  	  {BROCK_CHALLENGE_LOST}
		      [/else]
		      [/if]
		 [/command]
	     [/option]
	     [option]
	 	 message= _ "(Try to get your arm into a superior position)"
		 [command]
		     [if]
		 	 [variable] 
			     name=have_dexterity
		 	     numerical_equals=1
			 [/variable]
		     [then]
		     [message]
			id=$speaker_id
		        message= _ "(Brock presses against you hard and you realize you won't have much time before he pins you. You jockey for a better position and finally get it! With your superior position you're able to gradually force his arm down. You won!)"
		    [/message]
		    [message]
			id=Brock
		        message= _ "I...I can't believe I lost. By the Gods that was an odd strategy. I've never seen anyone armwrestle like that before. Good show! The reward for beating me is thirty pieces of gold, and you earned every bit of it!"
		    [/message]
                        {BROCK_CHALLENGE_WIN}
		        {TEAM_GOLD gain 30 $master_ooze}
		    [/then]
		    [else]
		        {BROCK_CHALLENGE_LOST}
		    [/else]
		    [/if]
	        [/command]
	    [/option]
        [/message]
    [/then]
    [/if]
#enddef

#define VALIN_CHALLENGE_WIN
    [if]
      [variable]
        name=master_ooze
        numerical_equals=1
      [/variable]   
    [then]
      [if]
        [variable]
            name=valin_friend
            greater_than=2
        [/variable]
        [and]
            [not]
                [variable]
                    name=quests_aurelia
                    greater_than=$quests_limit
                [/variable]
            [/not]
        [/and]
      [then]
        {VARIABLE valin_friend $master_ooze}
        {VARIABLE_OP leaderless_troops sub 1}
        {LEADERSHIP 1 $master_ooze}
        {VARIABLE_OP quests_aurelia add 1}
      [/then]
      [/if] 
    [/then]
    [else]
      [if]
        [variable]
            name=valin_friend
            greater_than=2
        [/variable]
        [and]
            [not]
                [variable]
                    name=quests_sithras
                    greater_than=$quests_limit
                [/variable]
            [/not]
        [/and]
      [then]
        {VARIABLE valin_friend $master_ooze}
        {VARIABLE_OP leaderless_troops sub 1}
        {LEADERSHIP 1 $master_ooze}
        {VARIABLE_OP quests_sithras add 1}
      [/then]
      [/if]
    [/else]
    [/if]
#enddef

#define VALIN SIDE
    [set_variable]
        name=master_ooze
        value={SIDE}
    [/set_variable]
    {CLEAR_VARIABLE valin_challenge}
    {HAS_TRAITS}
    [if]
      [variable]
        name=master_ooze
        numerical_equals=1
      [/variable]   
    [then]
      [set_variable]
        name=speaker_id
        value=Master Ooze
      [/set_variable]
      {VARIABLE valin_challenge $valin_challenge_aurelia}   
    [/then]
    [else]
      [set_variable]
        name=speaker_id
        value=Master Ooze 2
      [/set_variable]
      {VARIABLE valin_challenge $valin_challenge_sithras}    
    [/else]
    [/if]
    {LANGUAGE_PFIXES $master_ooze}
    [if]
	[variable] 
	    name=valin_challenge
	    numerical_equals=2
	[/variable]
    [then]
	[message]
	    id=Valin
	    message= _ "Back again? You only get one shot at my game, no pun intended."
	[/message]
    [/then]
    [/if]

    [if]
	[variable] 
	    name=valin_challenge
	    numerical_equals=0
	[/variable]
    [then]
    [message]
	id=Valin
	message= _ "Come one come all! Test your SKILL at archery and win PRIZE MONEY! Hit the bulls eye in ONE shot from THIRTY paces! Easy you say? Not really! BEHOLD the bows that you may use!"
    [/message]
    [message]
	id=Valin
	message= _ "(With a flourish he produces three bizarre longbows. One is so large that it seems to have been made for a giant. Another is an exotic curved bow of uncertain origin. The third bow has a bowstring drawn so taut it looks like you might hurt yourself trying to use it!)"
    [/message]
    [message]
	id=Valin
	message= _ "Do you have the strength to wield the OGRE'S LONGBOW? Or are you skilled enough to decipher the mysteries of the TYRAKIAN HORSEBOW? Or perhaps you're brave enough to try the BACKBREAKER BOW? Step right up to find out!"
    [/message]
    [message]
	id=$speaker_id
	message= _ "(Compete?)"
        [option]
	    message= _ "I want to try."
	    [command]
	        [message]
	            id=Valin
	            message= _ "Now you have to choose what bow you're going to use..."
	        [/message]
	        [set_variable]
	            name=valin_challenge
	            value=1
	        [/set_variable]
	    [/command]
	[/option]
	[option]
	    message= _ "(Leave)"
	    [command]
	        [message]
		    id=Valin
		    message= _ "Another time perhaps."
		[/message]
	    [/command]
	[/option]
    [/message]
    [/then]
    [/if]

    [if]
	[variable] 
	    name=valin_challenge
	    numerical_equals=1
	[/variable]
    [then]
        [set_variable]
	    name=valin_challenge
	    value=2
	[/set_variable]
        [if]
            [variable]
                name=master_ooze
                numerical_equals=1
            [/variable]   
        [then]
            {VARIABLE valin_challenge_aurelia $valin_challenge}
            [if]
                [variable]
                    name=valin_challenge_sithras
                    numerical_equals=2
                [/variable]
            [then]
                [remove_item]
	            x,y=17,8
	        [/remove_item]
            [/then]
            [/if]
       [/then]
       [else]   
           {VARIABLE valin_challenge_sithras $valin_challenge}
           [if]
                [variable]
                    name=valin_challenge_aurelia
                    numerical_equals=2
                [/variable]
            [then]
                [remove_item]
	            x,y=17,8
	        [/remove_item]
            [/then]
            [/if]  
        [/else]
        [/if]
	
       [message]
	   id=$speaker_id
	   message= _ "(What bow should you choose?)"
	   [option]
	       message= _ "(Choose the huge bow)"
	       [command]
		   [if]
		       [variable] 
			   name=have_strength
			   numerical_equals=1
		       [/variable]
		   [then]
		       [sound]
		           name=bow.ogg
		       [/sound]
		   [message]
		       id=$speaker_id
		       message= _ "(It takes all your strength to bend this bow. When you loose your arrow it thuds into the target with tremendous force. You did it!)"
		   [/message]
		   [message]
		       id=Valin
		       message= _ "Congratulations! Archery isn't JUST about marksmanship! Sometimes you've got to be pretty STRONG to make a bow WORK how you want it to. Here is your PRIZE MONEY!"
		   [/message]
                   {VALIN_CHALLENGE_WIN}
                   {TEAM_GOLD gain 30 $master_ooze}
	      [/then]
	      [else]
		  [message]
		      id=$speaker_id
		      message= _ "(Your efforts to bend the huge bow are completely futile. You failed!)"
		  [/message]
		  [message]
		      id=Valin
		      message= _ "And it seems the OGRE'S LONGBOW has triumphed over yet ANOTHER contestant!"
		  [/message]
	      [/else]
	      [/if]
	  [/command]
      [/option]
      [option]
	  message= _ "(Choose the complicated foreign bow)"
	  [command]
	      [if]
		  [variable] 
		      name=have_dexterity
		      numerical_equals=1
		  [/variable]
	      [then]
	          [sound]
		     name=bow.ogg
	          [/sound]
	          [message]
		      id=$speaker_id
		      message= _ "(You run your slender fingers along the bow, trying to get a feel for it. It is oddly balanced, but you feel confident you can make it work. Your confidence pays off as your arrow thunks into the target. You did it!)"
	          [/message]
	          [message]
		      id=Valin
		      message= _ "Congratulations! Archery isn't JUST about marksmanship! Sometimes you've got to be pretty DEXTROUS to make a bow WORK how you want it to. Here is your PRIZE MONEY!"
	          [/message]
	          {VALIN_CHALLENGE_WIN}
                  {TEAM_GOLD gain 30 $master_ooze}
	      [/then]
	      [else]
	          [sound]
		      name=bow-miss.ogg
	          [/sound]
	          [message]
	 	      id=$speaker_id
		      message= _ "(Your efforts to make the exotic bow work are completely futile. Your arrow flies off target and into the grass. You failed!)"
	          [/message]
	          [message]
	  	      id=Valin
		      message= _ "And it seems the TYRAKIAN HORSEBOW has triumphed over yet ANOTHER contestant!"
	          [/message]
	      [/else]
	      [/if]
          [/command]
      [/option]
      [option]
	  message= _ "(Choose the ultra-taut backbreaker bow)"
	  [command]
	      [if]
		  [variable] 
		      name=have_resilient
		      numerical_equals=1
		  [/variable]
	      [then]
		  [sound]
		      name=bow.ogg
		  [/sound]
		  [message]
		      id=$speaker_id
		      message= _ "(The bow is aptly named. You nearly break your back trying to draw it! But your persistence pays off as your arrow thunks into the target. You did it!)"
		  [/message]
		  [message]
		      id=Valin
		      message= _ "Congratulations! Archery isn't JUST about marksmanship! Sometimes you've got to be pretty RESILIENT to make a bow WORK how you want it to. Here is your PRIZE MONEY!"
		  [/message]
		  {VALIN_CHALLENGE_WIN}
                  {TEAM_GOLD gain 30 $master_ooze}
	      [/then]
	      [else]
		  [sound]
		      name=bow-miss.ogg
		  [/sound]
	          [message]
		      id=$speaker_id
		      message= _ "(The bow is aptly named. You nearly break your back trying to draw it! Your arrow flies a pitiful distance into the grass. You failed!)"
	          [/message]
	          [message]
		      id=Valin
		      message= _ "And it seems the BACKBREAKER has triumphed over yet ANOTHER contestant!"
	          [/message]
	      [/else]
	      [/if]
          [/command]
      [/option]
  [/message]
  [/then]
  [/if]
#enddef

#define RAM SIDE
    [set_variable]
        name=master_ooze
        value={SIDE}
    [/set_variable]
    {HAS_TRAITS}
    [if]
      [variable]
        name=master_ooze
        numerical_equals=1
      [/variable]   
    [then]
      [set_variable]
        name=speaker_id
        value=Master Ooze
      [/set_variable]   
    [/then]
    [else]
      [set_variable]
        name=speaker_id
        value=Master Ooze 2
      [/set_variable]    
    [/else]
    [/if]
    {LANGUAGE_PFIXES $master_ooze}
    [if]
	[variable] 
	    name=ram_challenge
	    numerical_equals=2
	[/variable]
    [then]
	[message]
	    id=Ram Aide
	    message= _ "All that drink'in shure wash fun. I think I'm gonna regret it in tha morning though."
	[/message]
    [/then]
    [/if]

    [if]
	[variable] 
	    name=ram_challenge
	    numerical_equals=0
	[/variable]
    [then]
	[message]
	    id=$speaker_id
	    message= _ "(You see a surly looking dwarf leaning up against a gigantic barrel.)"
        [/message]
	[message]
	    id=$speaker_id
	    message= _ "That's a BIG barrel you've got there..."
	[/message]
	[message]
	    id=Ram Aide
	    message= _ "(His speech is slurred and you realize he's drunk) Yessh, yessh it is my pretty. And itsh mine, ALL mine!!! All tha booze in tha worldsh! Hic!"
	[/message]
	[message]
	    id=$speaker_id
	    message= _ "So that barrel is full of liquor? Why do you need so much?"
	[/message]
	[message]
	    id=Ram Aide
	    message= _ "Ta blowsh the bridge of coursh! Tha bridge inta town. Tha oozes gonna BURN when they get to Pinewood, ha ha hic! Or ats least thatsh what tha Mayor says."
	[/message]
	[message]
	    id=$speaker_id
	    message= _ "(How to react?)"
	    [option]
		message= _ "I don't think you're responsible enough to be the custodian of that barrel."
		[command]
		    [message]
			id=Ram Aide
			message= _ "Hic! I am TOO vigilant! You notish how none o' thosh oozes haf come ta town yet? They KNOWSH I could spots 'em a mile away! Hic!"
		    [/message]
		    [message]
			id=Ram Aide
			message= _ "If yoush wants tha barrel, you gotta PROVE you deserve it!"
		    [/message]
		    [message]
			id=$speaker_id
			message= _ "How?"
		    [/message]
		    [message]
			id=Ram Aide
			message= _ "Why, the only wayth you can prove anything! A drink'in contesht!"
		    [/message]
		    [set_variable]
			name=ram_challenge
			value=1
		    [/set_variable]
		    [remove_item]
			x,y=4,7
		    [/remove_item]
		[/command]
	    [/option]
	    [option]
		message= _ "(Leave) I don't care about this."
		[command]
		    [message]
			id=Ram Aide
			message= _ "Goodb-hic!"
		    [/message]
		[/command]
	    [/option]
	[/message]
    [/then]
    [/if]

    [if]
	[variable] 
	    name=ram_challenge
	    numerical_equals=1
	[/variable]
    [then]
	[set_variable]
	    name=ram_challenge
	    value=2
	[/set_variable]
        [if]
          [variable]
             name=master_ooze
             numerical_equals=1
          [/variable]   
       [then]
          {VARIABLE_OP quests_aurelia add 1}   
       [/then]
       [else]
          {VARIABLE_OP quests_sithras add 1}    
       [/else]
       [/if]
	[message]
	    id=$speaker_id
	    message= _ "(What to do?)"
	    [option]
		message= _ "(Try and out-drink Ram Aide)"
		[command]
		    [if]
			[variable] 
			    name=have_resilient
			    numerical_equals=1
			[/variable]
		    [then]
		        [message]
			    id=$speaker_id
			    message= _ "(You drink cup after cup of hard liquor. Your vision blurs and the world becomes hazy. After an hour you can barely stand, but Ram Aide has collapsed in a drunken stupor. You've won!)"
			[/message]
		        [set_variable]
			    name=ram_friend
			    value=$master_ooze
			[/set_variable]
                        {VARIABLE_OP leaderless_troops sub 1}
                        {LEADERSHIP 1 $master_ooze}
			[message]
			    speaker=narrator
			    #image=items/barrel.png
			    image=Items/oldbarrel.png
			    message= _ "You've gained possession of a gigantic barrel of booze. Perhaps you'll be able to find some use for it later."
			[/message]
		    [/then]
		    [else]
			[message]
			    id=$speaker_id
			    message= _ "(You drink cup after cup of hard liquor. Your vision blurs and the world becomes hazy. After an hour you collapse in a drunken stupor, Ram Aide's slurred and mocking laughter the last thing you hear before you slip into unconsciousness. You failed!)"
			[/message]
		    [/else]
		    [/if]
		[/command]
	    [/option]
	    [option]
		message= _ "(Cheat in the drinking contest by quickly tossing the liquor in the grass when Ram Aide isn't looking)"
		[command]
		    [if]
			[variable] 
			    name=have_quickness
			    numerical_equals=1
			[/variable]
		    [then]
			[message]
			    id=$speaker_id
			    message= _ "(Your cheating has paid off! Ram Aide collapses in a drunken stupor after an hour of hard drinking. You've won!)"
			[/message]
			[set_variable]
			    name=ram_friend
			    value=$master_ooze
			[/set_variable]
                        {VARIABLE_OP leaderless_troops sub 1}
                        {LEADERSHIP 1 $master_ooze}
			[message]
			    speaker=narrator
			    #image=items/barrel.png
			    image=Items/oldbarrel.png
			    message= _ "You've gained possession of a gigantic barrel of booze. Perhaps you'll be able to find some use for it later."
			[/message]
		    [/then]
		    [else]
			[message]
			    id=$speaker_id
			    message= _ "(You aren't quick enough. Ram Aide notices your cheating and chases you away from his barrel at gunpoint. You failed!)"
			[/message]
		    [/else]
		    [/if]
		[/command]
	    [/option]
	    [option]
		message= _ "(Deftly place some noxious herbs in Ram Aide's tankard when he isn't looking)"
		[command]
		    [if]
		        [variable] 
		 	    name=have_dexterity
			    numerical_equals=1
			[/variable]
		    [then]
		        [message]
			    id=$speaker_id
			    message= _ "(Your cheating has paid off! Ram Aide is forced to forfeit after getting sick. You've won!)"
		        [/message]
			[set_variable]
			    name=ram_friend
			    value=$master_ooze
			[/set_variable]
                        {VARIABLE_OP leaderless_troops sub 1}
                        {LEADERSHIP 1 $master_ooze}
			[message]
			    speaker=narrator
			    #image=items/barrel.png
			    image=Items/oldbarrel.png
			    message= _ "You've gained possession of a gigantic barrel of booze. Perhaps you'll be able to find some use for it later."
			[/message]
			[/then]
			[else]
			    [message]
			        id=$speaker_id
			        message= _ "(You aren't dexterous enough. Ram Aide notices your attempt and chases you away from his barrel at gunpoint. You failed!)"
			    [/message]
			[/else]
			[/if]
		    [/command]
		[/option]
		[option]
		    message= _ "This is ridiculous, goodbye!"
		    [command]
		        [message]
			    id=Ram Aide
			    message= _ "Goodby-hic!"
			[/message]
		    [/command]
		[/option]
	    [/message]
	[/then]
	[/if]
#enddef

#define HIGH_PRIEST_JAL SIDE
    [set_variable]
        name=master_ooze
        value={SIDE}
    [/set_variable]
    [if]
      [variable]
        name=master_ooze
        numerical_equals=1
      [/variable]   
    [then]
      [set_variable]
        name=speaker_id
        value=Master Ooze
      [/set_variable]   
    [/then]
    [else]
      [set_variable]
        name=speaker_id
        value=Master Ooze 2
      [/set_variable]    
    [/else]
    [/if]
    {LANGUAGE_PFIXES $master_ooze}
    [if]
	[variable] 
	    name=donation
	    numerical_equals=1
	[/variable]
    [then]		
	[message]
	    id=High Priest Jal
	    message= _ "May the blessings of Pelor be upon thee, child."
	[/message]
    [/then]
    [/if]

    [if]
	[variable] 
	    name=donation
	    numerical_equals=0
	[/variable]
    [then]
	[message]
	    id=High Priest Jal
	    message= _ "Would you be interested in making a donation to Pelor, god of healing?"
	[/message]
	
	[message]
	    id=$speaker_id
	    message= _ "(What to say?)"
	    [option]
	        message= _ "(Make a small donation) Here's five gold pieces."
	        [command]
                    {TEAM_HAS_GOLD 5 $master_ooze}
		    [if]
		        [variable] 
			    name=has_gold 
			    not_equals=yes
		        [/variable]
		    [then]
			[message]
			    id=$speaker_id
			    message= _ "(Actually you don't have that much)"
			[/message]
		    [/then]
		    [/if]

		     [if]
			 [variable] 
			     name=has_gold 
			     equals=yes
			 [/variable]
		     [then]
			[message]
			    id=High Priest Jal
			    message= _ "Thank you. May Pelor's light always shine upon you!"
			[/message]
                        {TEAM_GOLD lost 5 $master_ooze}
		    [/then]
		    [/if]
		[/command]
	    [/option]
	    [option]
		message= _ "(Make a large donation) Here's fifty gold pieces."
		[command]
                    {TEAM_HAS_GOLD 50 $master_ooze}
		    [if]
			[variable] 
			    name=has_gold 
			    not_equals=yes
			[/variable]
		    [then]
			[message]
			    id=$speaker_id
			    message= _ "(Actually you don't have that much)"
			[/message]
		    [/then]
		    [/if]
		    [if]
			[variable] 
			    name=has_gold 
			    equals=yes
			[/variable]
		    [then]
                        [if]
                            [variable]
                                name=master_ooze
                                numerical_equals=1
                            [/variable]   
                        [then]
                            {VARIABLE_OP quests_aurelia add 1} 
                        [/then]
                        [else]
                            {VARIABLE_OP quests_sithras add 1}
                        [/else]
                        [/if]

			[set_variable]
			    name=donation
			    value=1
			[/set_variable]
			[remove_item]
			    x,y=15,9
			[/remove_item]

			[message]
                            [show_if]
                                [variable]
                                    name=master_ooze
                                    numerical_equals=1
                                [/variable]
                            [/show_if]
			    id=High Priest Jal
			    message= _ "My lady is MOST generous! You have gained a great ally in Pelor today!"
			[/message]
                        [message]
                            [show_if]
                                [variable]
                                    name=master_ooze
                                    numerical_equals=2
                                [/variable]
                            [/show_if]
			    id=High Priest Jal
			    message= _ "My lord is MOST generous! You have gained a great ally in Pelor today!"
			[/message]
			[set_variable]
			    name=jal_friend
			    value=$master_ooze
			[/set_variable]
                        {LEADERSHIP 1 $master_ooze}
			{TEAM_GOLD lost 50 $master_ooze}
		    [/then]
		    [/if]
		[/command]
	    [/option]
	    [option]
		message= _ "(Decline to donate) Sorry, not today."
		[command]
		    [message]
			id=High Priest Jal
			message= _ "Peace be with you."
		    [/message]
		[/command]
	    [/option]
	[/message]
    [/then]
    [/if]
#enddef

#define ALKAR SIDE
    [set_variable]
        name=master_ooze
        value={SIDE}
    [/set_variable]
    {LANGUAGE_PFIXES $master_ooze}
    [if]
      [variable]
        name=alkar_offer
        numerical_equals=0
      [/variable]
    [then]
    [if]
      [variable]
        name=master_ooze
        numerical_equals=1
      [/variable]   
    [then]
      [set_variable]
        name=speaker_id
        value=Master Ooze
      [/set_variable]
      [message]
          speaker=$speaker_id
          message= _ "(You see a young man training with his pitchfork, though he doesn't seem to be very good at it. He looks like part of the village militia. He is so absorbed in his task that he doesn't even notice you. Perhaps your warrior companion ooze could give him some advice.)"
      [/message]   
    [/then]
    [else]
      [set_variable]
        name=speaker_id
        value=Master Ooze 2
      [/set_variable]
      {TEAM_HAS_GOLD 30 $master_ooze}
      [message]
          speaker=$speaker_id
          message= _ "(You see a young man training with his pitchfork. He looks like part of the village militia.)"
      [/message]
      [message]
          speaker=Alkar
          message= _ "You look like an experienced warrior sir. Would you like to train me in combat? Not for free of course... I could pay you 40 gold pieces for your expertise."
      [/message]
      [message]
          speaker=$speaker_id
          message= _ "(How to respond?)"
          [option]
              message= _ "(Accept) Before I can train you I need to see what you can do."
              [command]
                  {VARIABLE alkar_offer 1}
              [/command]
          [/option]
          [option]
              message= _ "Why do you want to learn from an elven fighter? Aren't there plenty of human warriors here that you could learn from?"
              [command]
                  {VARIABLE alkar_offer 2}
              [/command]
          [/option]
          [option]
              message= _ "(Reject) I have no time for this."
              [command]
                  {VARIABLE alkar_offer 3}
                  [remove_item]
	              x,y=6,5
                  [/remove_item]
              [/command]
          [/option]
      [/message]
    [/else]
    [/if]

    [if]
        [variable]
            name=alkar_offer
            numerical_equals=2
        [/variable]
    [then]
      [message]
          speaker=Alkar
          message= _ "There's hardly anyone in this fort with real combat experience. I feel like I'm just not making any progress in the Pinewood militia. But you...well it's a well known fact that elves live for centuries. Elves who have dedicated themselves to the art of war must surely be masters of its craft with so many years of experience!"
      [/message]
      [message]
          speaker=$speaker_id
          message= _ "(What to respond?)"
          [option]
              message= _ "(Accept) Before I can train you I need to see what you can do."
              [command]
                  {VARIABLE alkar_offer 1}
              [/command]
          [/option]
          [option]
              message= _ "(Reject) I have no time for this."
              [command]
                  {VARIABLE alkar_offer 5}
                  [remove_item]
	              x,y=6,5
                  [/remove_item]
              [/command]
          [/option]
      [/message]
    [/then]
    [/if]

    [if]
        [variable]
            name=alkar_offer
            numerical_equals=1
        [/variable]
    [then]
      [message]
          speaker=Alkar
          message= _ "Of course sir. (You start a test fight with Alkar)"
      [/message]
      [message]
          speaker=$speaker_id
          message= _ "(During this short test you've noticed that he is brave and fast, but unfortunately he lacks real combat skill. He keeps trying to defeat you with one powerful strike that you easily parry... If he could do this from horseback as some human warriors do it might work out. But this is just awful!)"
          [option]
              message= _ "If we got you better equipment you might make a decent spearman."
              [command]
                  {VARIABLE alkar_offer 1}
              [/command]
          [/option]
          [option]
              message= _ "I think that you'll fight better on horseback."
              [command]
                  {VARIABLE alkar_offer 2}
              [/command]
          [/option]
      [/message]
    [/then]
    [/if]

    [if]
        [variable]
            name=alkar_offer
            numerical_equals=2
        [/variable]
    [then]
      [message]
          speaker=Alkar
          message= _ "I'm afraid that I don't have enough gold for equipment. I'd need 30 gold pieces more than I have."
      [/message]
      [message]
          speaker=$speaker_id
          message= _ "(How to respond?)"
          [option]
              message= _ "In that case I'll teach you how to be a spearman."
              [command]
                  {VARIABLE alkar_offer 1}
              [/command]
          [/option]
          [option]
              [show_if]
                [variable]
                    name=has_gold
                    equals=yes
                [/variable]
              [/show_if]
              id=$speaker_id
              message= _ "I'll give you 30 gold pieces so you can buy a good horse."
              [command]
                  {VARIABLE alkar_offer 2}
              [/command]
          [/option]
      [/message]
    [/then]
    [/if]

    [if]
        [variable]
            name=alkar_offer
            numerical_equals=1
        [/variable]
    [then]
      [kill]
          id=Alkar
      [/kill]
      [message]
          speaker=$speaker_id
          message= _ "(You spend a day training Alkar)"
      [/message]
      [unit]
	  type=Spearman
	  id=Alkar
	  name= _ "Alkar"
	  [modifications]
	      {TRAIT_LOYAL}
	      {TRAIT_QUICK}
	  [/modifications]
	  side={F1}
	  x=6
	  y=4
      [/unit]
      [message]
          speaker=Alkar
          message= _ "Thank you sir. I think I really learned something today! Here is your 40 gold!"
      [/message]
      {VARIABLE alkar_friend $master_ooze}
      {TEAM_GOLD earn 40 $master_ooze}
      {VARIABLE alkar_offer 3}
      {LEADERSHIP 1 $master_ooze}
      [remove_item]
	  x,y=6,5
      [/remove_item]
    [/then]
    [/if]        

    [if]
        [variable]
            name=alkar_offer
            numerical_equals=2
        [/variable]
    [then]
      [message]
          speaker=Alkar
          message= _ "Thank you sir. I owe you a debt and I won't forget it!"
      [/message]
      [message]
          speaker=Alkar
          message= _ "I'll do my best not to disappoint you!"
      [/message]
      {VARIABLE alkar_friend $master_ooze}
      {TEAM_GOLD lost 30 $master_ooze}
      {VARIABLE alkar_offer 4}
      {LEADERSHIP 1 $master_ooze}
      [remove_item]
	  x,y=6,5
      [/remove_item]
    [/then]
    [/if]

    [/then]
    [/if]
#enddef

#define SHADY_CHARACTER
    [remove_item]
	x,y=17,12
    [/remove_item]
    [message]
	id=Shady Character
	message= _ "Move along! Nothing to see here! Really! Go away!"
    [/message]
#enddef

#define GUTHRY SIDE
    [set_variable]
        name=master_ooze
        value={SIDE}
    [/set_variable]
    [if]
      [variable]
        name=master_ooze
        numerical_equals=1
      [/variable]   
    [then]
      [set_variable]
        name=speaker_id
        value=Master Ooze
      [/set_variable]
      {VARIABLE_OP quests_aurelia add 1} 
    [/then]
    [else]
      [set_variable]
        name=speaker_id
        value=Master Ooze 2
      [/set_variable]
      {VARIABLE_OP quests_sithras add 1}
    [/else]
    [/if]
    {LANGUAGE_PFIXES $master_ooze}
    [message]
	id=Guthry
	message= _ "Hello stranger. It's not often you see an elf in Fort Pinewood. It's said your kind knows about...sylvan problems...so maybe you'd be able to help me."
    [/message]
    [message]
	 id=Guthry
	 message= _ "My brother used to own this cottage, but he was in the militia and..."
    [/message]
    [message]
	id=$speaker_id
	message= _ "Got eaten?"
    [/message]
    [message]
	id=Guthry
	message= _ "Yeah. No worries though, I hated the guy. And now I've inherited his cottage. Only problem is, there's this crazed fairy that keeps attacking me! Then she runs to hide in the forest when I call for the town guards!"
    [/message]
    [unit]
	type=Elvish Druid
	id=Dryad
	name= _ "Dryad"
	[modifications]
	    {TRAIT_LOYAL}
	    {TRAIT_QUICK}
	[/modifications]
	facing=sw
	side={F1}
	x=5
	y=3
    [/unit]
		
    [redraw]
    [/redraw]
		
    [message]
	id=Dryad
	message= _ "Lies! This land is mine! The human who used to live in the cottage was nice. But this new human tried to cut down my tree."
    [/message]
    [message]
	id=Guthry
	message= _ "It's my tree, not yours! I own this land now! Its been in my family for five generations."
    [/message]
    [message]
	id=Dryad
	message= _ "I do not know what these 'generations' are that you speak of. But I have lived here since my tree was but a tiny sprout in the ground. The human town is something new. I do not like it. The humans need to leave this place forever."
    [/message]
    [message]
	id=Guthry
	message= _ "Help me claim my inheritance and I'll reward you well."
    [/message]
    [remove_item]
	x,y=4,4
    [/remove_item]
    [message]
	id=$speaker_id
	message= _ "(What to say?)"
	[option]
            [show_if]
                [variable]
                    name=master_ooze
                    numerical_equals=1
                [/variable]
            [/show_if]
	    message= _ "(Side with Guthry) I'll use my sylvan magic to banish this crazy dryad."
	    [command]
	       [message]
		   id=Dryad
		   message= _ "No! You're an elf! How could you side with--"
	       [/message]
	       [message]
		   id=$speaker_id
		   message= _ "Niste Siara Belkan! (You banish the dryad back into her tree. It will be many years before she will be able to emerge again.)"
		[/message]
		[kill]
		    id=Dryad
		    animate=yes
		[/kill]
		[message]
		    id=Guthry
		    message= _ "Thanks for the help! Here's fifty gold for your trouble."
		[/message]
		[set_variable]
		    name=guthry_friend
		    value=$master_ooze
		[/set_variable]
                {LEADERSHIP 1 $master_ooze}
                {TEAM_GOLD gain 50 $master_ooze}
	    [/command]
	[/option]
        [option]
            [show_if]
                [variable]
                    name=master_ooze
                    numerical_equals=2
                [/variable]
            [/show_if]
	    message= _ "(Side with Guthry) This man is just protecting his property. Leave him alone or else!"
	    [command]
               [message]
		    id=Guthry
		    message= _ "That's it?! You won't do anything more?!"
		[/message]
	       [message]
		   id=Dryad
		   message= _ "You're an elf! How could you side with--"
	       [/message]
	       [message]
                   [show_if]
                       [variable]
                           name=have_dexterity_sithras
                           numerical_equals=1
                       [/variable]
                   [/show_if]
		   id=$speaker_id
		   message= _ "(You pull out your sword with astonishing speed. For one long moment a sunbeam beautifully plays on the blade's surface. The next moment the dryad lies dead under her tree...)"
		[/message]
                [message]
                   [show_if]
                       [variable]
                           name=have_quickness_sithras
                           numerical_equals=1
                       [/variable]
                   [/show_if]
		   id=$speaker_id
		   message= _ "(Steel lightning strikes... Before anyone can react the dryad lies dead under her tree, cut in twain by your sword...)"
		[/message]
		[kill]
		    id=Dryad
		    animate=yes
		[/kill]
                [message]
                   [show_if]
                       [variable]
                           name=have_dexterity_sithras
                           numerical_equals=1
                       [/variable]
                   [/show_if]
		   id=Guthry
		   message= _ "You just... You actually... Killed her... That was amazing! I've never seen anything like it! You make killing look like an art!"
		[/message]
                [message]
                   [show_if]
                       [variable]
                           name=have_quickness_sithras
                           numerical_equals=1
                       [/variable]
                   [/show_if]
		   id=Guthry
		   message= _ "You... You just... Killed her... That was amazing! It was so quick I didn't even realize what had happened until it was all over! You are truly a great warrior!"
		[/message]
                [message]
                   [show_if]
                       [variable]
                           name=have_dexterity_sithras
                           numerical_equals=1
                       [/variable]
                   [/show_if]
		   id=$speaker_id
		   message= _ "(You raise an eyebrow and speak very calmly.) So, you really liked it? Should I make another performance especially for you?"
		[/message]
                [message]
                   [show_if]
                       [variable]
                           name=have_quickness_sithras
                           numerical_equals=1
                       [/variable]
                   [/show_if]
		   id=$speaker_id
		   message= _ "(You smile a smile as warm as ice.) You want to see it again in slow motion?"
		[/message]
		[message]
		    id=Guthry
		    message= _ "(He speaks very fast and his voice quavers) No, that's absolutely unnecessary! I have a lot on my mind right now so thanks for the help! Here's seventy gold for your trouble."
		[/message]
		[set_variable]
		    name=guthry_friend
		    value=$master_ooze
		[/set_variable]
                {LEADERSHIP 1 $master_ooze}
                {TEAM_GOLD gain 70 $master_ooze}
	    [/command]
	[/option]
        [option]
	    message= _ "(Side with the Dryad) The Dryad was here first, she is in the right."
	    [command]
		[message]
		    id=Guthry
		    message= _ "Damn dryad and her damn tree-hugging sympathizers! (Menacingly) I know I can't take this land by force, but mark my words, one day someone strong will come along who'll see my side of things!"
		[/message]
		[message]
		    id=Dryad
		    message= _ "Thank you for helping keep the rabid human at bay, though I fear it is just for a little while longer. If you ever need a friend of the Forest, I am here."
		[/message]
		[set_variable]
		    name=dryad_friend
		    value=$master_ooze
		[/set_variable]
                {LEADERSHIP 1 $master_ooze}
	     [/command]
        [/option]
    [/message]
#enddef

#define SLAVER_DEBATE_STAGE VALUE
    [set_variable]
	name=slaver_debate
        value={VALUE}
    [/set_variable]
    [if]
        [variable]
            name=master_ooze
            numerical_equals=1
        [/variable]   
    [then]
        {VARIABLE slaver_debate_aurelia $slaver_debate}
    [/then]
    [else]
        {VARIABLE slaver_debate_sithras $slaver_debate}
    [/else]
    [/if]
#enddef

#define SLAVER_DEBATE SIDE
    [set_variable]
        name=master_ooze
        value={SIDE}
    [/set_variable]
    [if]
      [variable]
        name=master_ooze
        numerical_equals=1
      [/variable]   
    [then]
      [set_variable]
        name=speaker_id
        value=Master Ooze
      [/set_variable]
      {VARIABLE slaver_debate $slaver_debate_aurelia}
    [/then]
    [else]
      [set_variable]
        name=speaker_id
        value=Master Ooze 2
      [/set_variable]
      {VARIABLE slaver_debate $slaver_debate_sithras}
    [/else]
    [/if]
    {LANGUAGE_PFIXES $master_ooze}
    [if]
	[variable] 
	    name=slaver_debate 
	    numerical_equals=0
	[/variable]
    [then]
        [if]
            [variable]
                name=master_ooze
                numerical_equals=1
            [/variable]
        [then]
            {VARIABLE_OP quests_aurelia add 1}
            {VARIABLE slaver_debate_sithras 3}
        [/then]
        [else]
            {VARIABLE_OP quests_sithras add 1}
            {VARIABLE slaver_debate_aurelia 3}
        [/else]
        [/if]

	[message]
	    id=Haffuz the Slaver
	    message= _ "Thirty gold pieces gets you your very own troll whelp slave. Use the creature for manual labor, bet on him in the gladiator pits, sic him on your enemies, just think of the possibilities! And all for the low, low price of thirty gold!"
	[/message]
	[message]
	    id=Bryony the Idealist
	    message= _ "Enslaving other creatures is wrong! How can you be so cold-hearted?!"
	[/message]
	[message]
	    id=Haffuz the Slaver
	    message= _ "What do you care? You're not the one being sold on the auction block!"
	[/message]
	[message]
	    id=Bryony the Idealist
	    message= _ "I'll have the town guards arrest you!"
	[/message]
	[message]
	    id=Haffuz the Slaver
	    message= _ "For what? Slavery is legal in this province. So take your self-righteous attitude, turn yourself around, and walk the other way! Or maybe I'll have Gorl teach you a lesson."
	[/message]
	[message]
	    id=Gorl the Smasher
	    message= _ "(Grunts)"
	[/message]
	[message]
	    id=Kirielle the Realist
	    message= _ "Come on Bryony, there's nothing to be gained from agitating the locals. We must stay focused on our mission!"
	[/message]
	[message]
	    id=Bryony the Idealist
	    message= _ "We can't just walk away from something like this!"
	[/message]
	[message]
	    id=$speaker_id
	    message= _ "(What to say?)"
	    [option]
		message= _ "I'll buy the troll whelp for 30 gold."
		[command]
		    [message]
			id=Bryony the Idealist
			message= _ "I hope you realize that by patronizing this man's business you're only encouraging him!"
		    [/message]
                    {SLAVER_DEBATE_STAGE 1}
		[/command]
	    [/option]
	    [option]
		message= _ "(Side with Bryony) Slaving is an evil business! I think you should stop."
		[command]
		    [message]
			id=Haffuz the Slaver
			message= _ "I used to be a beggar on the streets of Tarakin City, but since I got into slaving I've always had three meals a day and a soft bed to sleep in at night. What the hell do you elves know about poverty or evil?"
		    [/message]
		    [message]
			id=Bryony the Idealist
			message= _ "Just because you had a rough life doesn't mean you're entitled to make other people suffer!"
		    [/message]
                    {SLAVER_DEBATE_STAGE 2}
		[/command]
	    [/option]
	    [option]
		message= _ "(Don't get involved)."
		[command]
		    [message]
			id=$speaker_id
			message= _ "(The elf and the human are still arguing as you leave)"
		    [/message]
                    {SLAVER_DEBATE_STAGE 3}
		    [remove_item]
			 x,y=10,2
		    [/remove_item]
		[/command]
	    [/option]
	[/message]
	[/then]
	[/if]

	[if]
	    [variable] 
	        name=slaver_debate 
		numerical_equals=1
	    [/variable]
	[then]
            {TEAM_HAS_GOLD 30 $master_ooze}
	    [if]
		[variable] 
		    name=has_gold 
		    equals=yes
		[/variable]
	    [then]
		[message]
		    id=Haffuz the Slaver
		    message= _ "A pleasure doing business with you! Would you like to take your slave with you now?"
		[/message]
		[message]
		    id=$speaker_id
		    message= _ "I'll pick him up shortly."
		[/message]
		[set_variable]
		    name=troll_friend
		    value=$master_ooze
		[/set_variable]
                {LEADERSHIP 1 $master_ooze}
                {TEAM_GOLD spent 30 $master_ooze}
                {SLAVER_DEBATE_STAGE 3}
		[remove_item]
		     x,y=10,2
		[/remove_item]
	    [/then]
	    [/if]
	    [if]
		[variable] 
		    name=has_gold 
		    not_equals=yes
		[/variable]
	    [then]
		[message]
		    id=Haffuz the Slaver
		    message= _ "You don't have that much money right now. Come back when you can pay me."
		[/message]
	    [/then]
	    [/if]
	[/then]
	[/if]

	[if]
	    [variable] 
		name=slaver_debate 
		numerical_equals=2
	    [/variable]
	[then]
        {TEAM_HAS_GOLD 50 $master_ooze}
	[message]
	    id=Haffuz the Slaver
	    message= _ "Everyone has to look out for themselves, because no one else is gonna do it for you. That's what ten years of living on the streets of Tarakin City taught me. Why should I give up slaving? What's in it for me?"
	[/message]
	[message]
	    id=$speaker_id
	    message= _ "(What to say?)"
	[option]
	    message= _ "You'll have a clear conscience."
	    [command]
		[message]
		    id=Haffuz the Slaver
		    message= _ "I'd rather be rich than have a clear conscience! Now leave, before I have Gorl here give you a pounding!"
		[/message]
	    [/command]
	[/option]
	[option]
	    message= _ "I'll pay you money to work for me as a bodyguard. 50 gold pieces for the two of you!"
	    [command]
		[message]
		    id=Haffuz the Slaver
		    message= _ "What do you think, Gorl?"
		[/message]
		[message]
		    id=Gorl the Smasher
		    message= _ "(Grunts)"
		[/message]
		[message]
		    id=Haffuz the Slaver
		    message= _ "Gorl likes it."
		[/message]
		[if]
		    [variable] 
			name=has_gold 
			equals=yes
		    [/variable]
		[then]
	 	    [message]
		        id=Haffuz the Slaver
		        message= _ "Goodbye slavery, hello lucrative bodyguard contract!"
		    [/message]
		    [message]
		        id=$speaker_id
		        message= _ "Wait for me here until I need you."
		    [/message]
		    [message]
                        [show_if]
                            [variable]
                                name=master_ooze
                                numerical_equals=1
                            [/variable]
                        [/show_if]
		        id=Haffuz the Slaver
		        message= _ "Yes ma'am!"
		    [/message]
                    [message]
                        [show_if]
                            [variable]
                                name=master_ooze
                                numerical_equals=2
                            [/variable]
                        [/show_if]
		        id=Haffuz the Slaver
		        message= _ "Yes sir!"
		    [/message]
		    [set_variable]
		        name=slavers_friend
		        value=$master_ooze
		    [/set_variable]
                    {LEADERSHIP 3 $master_ooze}
		    {TEAM_GOLD spent 50 $master_ooze}
                    {SLAVER_DEBATE_STAGE 3}
		    [remove_item]
			x,y=10,2
		    [/remove_item]
	        [/then]
	        [/if]

	        [if]
		    [variable] 
		        name=has_gold 
		        not_equals=yes
		    [/variable]
	        [then]
	 	    [message]
		        id=Haffuz the Slaver
		        message= _ "Come back when you have the money!"
		    [/message]
	        [/then]
	        [/if]				
	    [/command]
        [/option]
    [/message]
    [/then]
    [/if]
#enddef

#define PINEWOOD_RULES
    [message]
	speaker=narrator
	message= _ "In this scenario time is unlimited, but there is a limited number of quests you can accept. Your character will warn you when this event happens."
	image=wesnoth-icon.png
    [/message]
#enddef

#define PINEWOOD_TRANSACTIONS_OVER SIDE
    [set_variable]
        name=master_ooze
        value={SIDE}
    [/set_variable]
    [if]
      [variable]
        name=master_ooze
        numerical_equals=1
      [/variable]   
    [then]
      [set_variable]
        name=speaker_id
        value=Master Ooze
      [/set_variable]
      {VARIABLE have_training $have_training_aurelia}
    [/then]
    [else]
      [set_variable]
        name=speaker_id
        value=Master Ooze 2
      [/set_variable]
      {VARIABLE have_training $have_training_sithras}
    [/else]
    [/if]
    {LANGUAGE_PFIXES $master_ooze}
    [if]
	[variable]
	    name=have_training
	    greater_than=0
	[/variable]
    [then]
        [if]
            [variable]
                name=pinewood_transactions_done
                numerical_equals=0
            [/variable]
        [then]
            [message]
	        id=$speaker_id
	        message= _ "(Have you finished exploring Fort Pinewood)?"
	        [option]
		    message= _ "Yes (Your turn will be omitted to the end of scenario)."
		    [command]
                        {VARIABLE pinewood_transactions_done $master_ooze}
                        [teleport]
                            [filter]
                                side=$master_ooze
                            [/filter]
                            x,y=10,13
                        [/teleport]
                        [object]
			    silent=yes
			    [filter]
			        id=$speaker_id
			    [/filter]
			    [effect]
			        apply_to=movement_costs 
			        replace=true
			        [movement_costs]
			            flat=99
			        [/movement_costs]
			    [/effect]
                        [/object]
                        {VARIABLE immobilized $speaker_id}
                        [end_turn]
                        [/end_turn]
		    [/command]
	        [/option]
	    	[option]
		    message= _ "Not yet."
		[/option]
	    [/message]
	[/then]
        [else]
            [message]
	        id=$speaker_id
	        message= _ "(Have you finished exploring Fort Pinewood)?"
	        [option]
		    message= _ "Yes (End level)."
		    [command]
                        [object]
			    silent=yes
			    [filter]
			        id=$immobilized
			    [/filter]
			    [effect]
			        apply_to=movement_costs 
			        replace=true
			        [movement_costs]
			            flat=1
			        [/movement_costs]
			    [/effect]
                        [/object]

                        [store_unit]
		            variable=ooze_store
		            kill=no
		            [filter]
		                id=Master Ooze
		            [/filter]
	                [/store_unit]
                        [store_unit]
		            variable=ooze_store2
		            kill=no
		            [filter]
		                id=Master Ooze 2
		            [/filter]
	                [/store_unit]

                        {CLEAR_VARIABLE pinewood_transactions_done}
                        {CLEAR_VARIABLE have_strength}
			{CLEAR_VARIABLE have_dexterity}
			{CLEAR_VARIABLE have_quickness}
			{CLEAR_VARIABLE have_resilient}
                        {CLEAR_VARIABLE have_strength_aurelia}
			{CLEAR_VARIABLE have_dexterity_aurelia}
			{CLEAR_VARIABLE have_quickness_aurelia}
			{CLEAR_VARIABLE have_resilient_aurelia}
                        {CLEAR_VARIABLE have_strength_sithras}
			{CLEAR_VARIABLE have_dexterity_sithras}
			{CLEAR_VARIABLE have_quickness_sithras}
			{CLEAR_VARIABLE have_resilient_sithras}
			{CLEAR_VARIABLE have_training}
                        {CLEAR_VARIABLE have_training_aurelia}
                        {CLEAR_VARIABLE have_training_sithras}
			{CLEAR_VARIABLE book_hunt}
			{CLEAR_VARIABLE slaver_debate}
                        {CLEAR_VARIABLE slaver_debate_aurelia}
                        {CLEAR_VARIABLE slaver_debate_sithras}
			{CLEAR_VARIABLE foe_number}
			{CLEAR_VARIABLE have_book}
			{CLEAR_VARIABLE hay_hunt}
			{CLEAR_VARIABLE hay_haul1}
			{CLEAR_VARIABLE hay_haul2}
			{CLEAR_VARIABLE hay_haul3}
			{CLEAR_VARIABLE brock_challenge}
                        {CLEAR_VARIABLE brock_challenge_aurelia}
                        {CLEAR_VARIABLE brock_challenge_sithras}
			{CLEAR_VARIABLE valin_challenge}
                        {CLEAR_VARIABLE valin_challenge_aurelia}
                        {CLEAR_VARIABLE valin_challenge_sithras}
			{CLEAR_VARIABLE ram_challenge}
			{CLEAR_VARIABLE donation}
			{CLEAR_VARIABLE ongoing_fight}
			{CLEAR_VARIABLE dryden_quest}
                        {CLEAR_VARIABLE mayor_wyatt_speach}
                        {CLEAR_VARIABLE side_turn_to_end}
                        {CLEAR_VARIABLE book_hunt}

                        #undef TEAM_GOLD_VALUE
                        #undef TEAM_HAS_GOLD
                        #undef TEAM_GOLD
                        #undef HAS_TRAITS
                        # LANGUAGE_PFIXES
                        #undef NO_TIME
                        #undef LEADERSHIP

                        #undef MAYOR_WYATT
                        #undef DRYDEN_PROBLEM
                        #undef DRYDEN_RESPONSE
                        #undef DRYDEN_WINS
                        #undef DRYDEN_LOSES
                        #undef CORRINA_PROBLEM
                        #undef CORRINA_WINS
                        #undef CORRINA_CHOICE
                        #undef SIR_DRYDEN
                        #undef CORRINA
                        #undef FRIST
                        #undef AURELIA_TRAINING
                        #undef AURELIA_SKILLS
                        #undef AURELIA_SKILLS_2
                        #undef PINEWOOD_ARENA
                        #undef MONSTER_DIE
                        #undef SITHRAS_SKILLS
                        #undef SITHRAS_CHALLENGE
                        #undef PINEWOOD_ARENA_CHAMPION
                        #undef PINEWOOD_ARENA_SPECTATOR
                        #undef PINEWOOD_ARENA_CLOSED
                        #undef BLOODTALON_DIE
                        #undef FONTAINE
                        #undef LIVIUS
                        #undef LIVIUS_BOOK
                        #undef LIVIUS_REWARD
                        #undef JEDD_FARM_WORK
                        #undef JEDD
                        #undef JEDD_WORK_DONE
                        #undef BROCK_CHALLENGE_LOST
                        #undef BROCK_CHALLENGE_WIN
                        #undef BROCK
                        #undef VALIN_CHALLENGE_WIN
                        #undef VALIN
                        #undef RAM
                        #undef HIGH_PRIEST_JAL
                        #undef ALKAR
                        #undef SHADY_CHARACTER
                        #undef GUTHRY
                        #undef SLAVER_DEBATE_STAGE
                        #undef SLAVER_DEBATE

			[endlevel]
			    result=victory
			    carryover_percentage=100
                            bonus=no
			[/endlevel]
		    [/command]
	        [/option]
	    	[option]
		    message= _ "Not yet."
		[/option]
	    [/message]
        [/else]
	[/if]
    [/then]
    [/if]
#enddef

     # ===================================================================================================================== #
     # SCENARIO
     # ===================================================================================================================== #

[multiplayer]
#textdomain wesnoth-Ooze_Mini_Campaign
name= _ "Pinewood"
id=3_mp_Pinewood
next_scenario=4_mp_Pinewood_Siege
experience_modifier=100
shroud=no
fog=no

allow_new_game=no
map_data="{~add-ons/Ooze_Mini_Campaign/maps/Fort_Pinewood.map}"
{SCENARIO_MUSIC "wanderer.ogg"}
{EXTRA_SCENARIO_MUSIC "nunc_dimittis.ogg"}
{EXTRA_SCENARIO_MUSIC "the_king_is_dead.ogg"}
{EXTRA_SCENARIO_MUSIC "traveling_minstrels.ogg"}

	turns=-1
	victory_when_enemies_defeated=no

	{AFTERNOON}
	
	[label]
	x,y=10,10
	text= _ "Wyatt Manor"
	[/label]
	[label]
	x,y=6,8
	text= _ "Training Hall"
	[/label]

	{PLACE_IMAGE scenery/leanto.png 3 7}
	{PLACE_IMAGE scenery/signpost.png 11 18}
	{PLACE_IMAGE scenery/temple1.png 14 6}
	{PLACE_IMAGE scenery/tent-fancy-red.png 18 7}
	{PLACE_IMAGE scenery/well.png 6 6}
	{PLACE_IMAGE items/archery-target-right.png 17 9}
	{PLACE_IMAGE items/archery-target-right.png 18 9}
	{PLACE_IMAGE items/grain-sheaf.png 13 3}
	{PLACE_IMAGE units/trolls/whelp.png 9 2}
	{PLACE_IMAGE items/cage.png 9 2}
	{PLACE_IMAGE items/book1.png 3 14}
	{PLACE_IMAGE items/scarecrow.png 16 3}
	{PLACE_IMAGE items/straw-bale1.png 15 5}
	{PLACE_IMAGE items/straw-bale2.png 13 4}
	#{PLACE_IMAGE items/barrel.png 3 6}
	{PLACE_IMAGE Items/oldbarrel.png 3 6}
	{PLACE_IMAGE items/gohere.png 10 11}

	{PLACE_IMAGE items/gohere.png 8 12}
	{PLACE_IMAGE items/gohere.png 13 12}
	{PLACE_IMAGE items/gohere.png 15 11}
	{PLACE_IMAGE items/gohere.png 17 12}
	{PLACE_IMAGE items/gohere.png 15 9}
	{PLACE_IMAGE items/gohere.png 17 8}
	{PLACE_IMAGE items/gohere.png 15 7}
	{PLACE_IMAGE items/gohere.png 14 5}
	{PLACE_IMAGE items/gohere.png 10 2}
	{PLACE_IMAGE items/gohere.png 6 9}
	{PLACE_IMAGE items/gohere.png 4 7}
	{PLACE_IMAGE items/gohere.png 6 5}
	{PLACE_IMAGE items/gohere.png 4 4}
[side]
	side={P1}
	controller=human
	id=Master Ooze
        save_id=Ooze
	name= _ "Master Ooze"
	type=Elvish Shaman Ooze
	fog=no
	canrecruit=yes
	recruit=
	team_name=oozes
	gold=15
	income=-2
	
[/side]

 [side]
	side={P2}
	controller=human
	id=Master Ooze 2
        save_id=Ooze2
	name= _ "Master Ooze 2"
	type=Elvish Fighter
	fog=no
	canrecruit=yes
	recruit=
	team_name=oozes
	gold=15
	income=-2
		
[/side]
	
[side]
	side={F1}
	controller=ai
        allow_player=no
	type=Mayor
	[modifications]
		{TRAIT_LOYAL}
		{TRAIT_QUICK}
	[/modifications]
	id=Mayor Wyatt
	name= _ "Mayor Wyatt"
	canrecruit=yes
	recruit=Peasant,Woodsman
	gold=0
	team_name=oozes
	[ai]
		passive_leader=yes
		ai_algorithm=idle_ai
	[/ai]
	
		[unit]
		type=Spearman
		id=Stern Guard
		name= _ "Stern Guard"
		[modifications]
		{TRAIT_LOYAL}
		{TRAIT_INTELLIGENT}
		[/modifications]
		facing=se
		side={F1}
		x=9
		y=15
	[/unit]
	[unit]
		type=Bowman
		id=Bored Guard
		name= _ "Bored Guard"
		[modifications]
		{TRAIT_LOYAL}
		{TRAIT_QUICK}
		[/modifications]
		facing=sw
		side={F1}
		x=11
		y=15
	[/unit]
	[unit]
		type=Heavy Infantryman
		id=Big Bodyguard
		name= _ "Big Bodyguard"
		[modifications]
		{TRAIT_LOYAL}
		{TRAIT_STRONG}
		[/modifications]
		side={F1}
		x=9
		y=10
	[/unit]
	[unit]
		type=Heavy Infantryman
		id=Mean Bodyguard
		name= _ "Mean Bodyguard"
		[modifications]
		{TRAIT_LOYAL}
		{TRAIT_STRONG}
		[/modifications]
		side={F1}
		x=9
		y=11
	[/unit]
	[unit]
		type=Heavy Infantryman
		id=Ugly Bodyguard
		name= _ "Ugly Bodyguard"
		[modifications]
		{TRAIT_LOYAL}
		{TRAIT_STRONG}
		[/modifications]
		facing=sw
		side={F1}
		x=11
		y=10
	[/unit]
	[unit]
		type=Heavy Infantryman
		id=Lazy Bodyguard
		name= _ "Lazy Bodyguard"
		[modifications]
		{TRAIT_LOYAL}
		{TRAIT_STRONG}
		[/modifications]
		facing=sw
		side={F1}
		x=11
		y=11
	[/unit]

	[unit]
		type=Dwarvish Thunderer
		id=Ram Aide
		name= _ "Ram Aide"
		[modifications]
		{TRAIT_LOYAL}
		{TRAIT_STRONG}
		[/modifications]
		side={F1}
		x=3
		y=7
	[/unit]
	[unit]
		type=Rogue
		id=Shady Character
		name= _ "Shady Character"
		facing=sw
		side={F1}
		x=17
		y=13
	[/unit]
	[unit]
		type=Fencer
		id=Fontaine
		name= _ "Fontaine"
		[modifications]
		{TRAIT_LOYAL}
		{TRAIT_QUICK}
		[/modifications]
		facing=sw
		side={F1}
		x=16
		y=10
	[/unit]
	[unit]
		type=White Mage
		id=High Priest Jal
		name= _ "High Priest Jal"
		[modifications]
		{TRAIT_LOYAL}
		{TRAIT_INTELLIGENT}
		[/modifications]
		side={F1}
		x=14
		y=8
	[/unit]
	[unit]
		type=Peasant
		id=Jedd
		name= _ "Jedd"
		[modifications]
		{TRAIT_LOYAL}
		{TRAIT_RESILIENT}
		[/modifications]
		side={F1}
		x=14
		y=4
	[/unit]
	[unit]
		type=Woodsman
		id=Guthry
		name= _ "Guthry"
		[modifications]
		{TRAIT_LOYAL}
		{TRAIT_STRONG}
		[/modifications]
		side={F1}
		x=4
		y=3
	[/unit]
	[unit]
		type=Footpad
		id=Haffuz the Slaver
		name= _ "Haffuz the Slaver"
		[modifications]
		{TRAIT_LOYAL}
		{TRAIT_INTELLIGENT}
		[/modifications]
		side={F1}
		x=9
		y=3
	[/unit]
	[unit]
		type=Thug
		id=Gorl the Smasher
		name= _ "Gorl the Smasher"
		[modifications]
		{TRAIT_LOYAL}
		{TRAIT_STRONG}
		[/modifications]
		side={F1}
		x=8
		y=2
	[/unit]
	[unit]
		type=Dark Sorceress
		id=Corinna
		name= _ "Corinna"
		[modifications]
		{TRAIT_LOYAL}
		{TRAIT_INTELLIGENT}
		[/modifications]
		facing=se
		side={F1}
		x=3
		y=11
	[/unit]
	[unit]
		type=Paladin
		id=Sir Dryden
		name= _ "Sir Dryden"
		[modifications]
		{TRAIT_LOYAL}
		{TRAIT_RESILIENT}
		[/modifications]
		facing=sw
		side={F1}
		x=7
		y=13
	[/unit]
	[unit]
		type=Sergeant
		id=Sergeant Ryn
		name= _ "Sergeant Ryn"
		[modifications]
		{TRAIT_LOYAL}
		{TRAIT_INTELLIGENT}
		[/modifications]
		side={F1}
		x=10
		y=5
	[/unit]
	[unit]
		type=Mage
		id=Livius
		name= _ "Livius"
		[modifications]
		{TRAIT_LOYAL}
		{TRAIT_INTELLIGENT}
		[/modifications]
		facing=sw
		side={F1}
		x=16
		y=6
	[/unit]
	[unit]
		type=Peasant
		id=Alkar
		name= _ "Alkar"
		[modifications]
		{TRAIT_LOYAL}
		{TRAIT_QUICK}
		[/modifications]
		side={F1}
		x=6
		y=4
	[/unit]
	[unit]
		type=Dwarvish Fighter
		id=Frist
		name= _ "Frist"
		[modifications]
		{TRAIT_LOYAL}
		{TRAIT_STRONG}
		[/modifications]
		side={F1}
		x=6
		y=8
	[/unit]
	[unit]
		type=Longbowman
		id=Valin
		name= _ "Valin"
		[modifications]
		{TRAIT_LOYAL}
		{TRAIT_STRONG}
		[/modifications]
		facing=sw
		side={F1}
		x=18
		y=8
	[/unit]
	[unit]
		type=Dwarvish Guardsman
		id=Brock
		name= _ "Brock"
		[modifications]
		{TRAIT_LOYAL}
		{TRAIT_RESILIENT}
		[/modifications]
		profile=Portraits/olddwarf-guard.png
		facing=sw
		side={F1}
		x=14
		y=12
	[/unit]
	[unit]
		type=Elvish Ranger
		id=Kirielle the Realist
		name= _ "Kirielle the Realist"
		[modifications]
		{TRAIT_LOYAL}
		{TRAIT_INTELLIGENT}
		[/modifications]
		facing=sw
		side={F1}
		x=10
		y=1
		gender=female
	[/unit]
	[unit]
		type=Elvish Marksman
		id=Bryony the Idealist
		name= _ "Bryony the Idealist"
		[modifications]
		{TRAIT_LOYAL}
		{TRAIT_QUICK}
		[/modifications]
		facing=sw
		side={F1}
		x=11
		y=2
		gender=female
	[/unit]
	
		[village] 
			x=14
			y=12
		[/village]
		[village] 
			x=17
			y=13
		[/village]
		[village] 
			x=16
			y=10
		[/village]
		[village] 
			x=14
			y=8
		[/village]
		[village] 
			x=16
			y=6
		[/village]
		[village] 
			x=14
			y=4
		[/village]
		[village] 
			x=6
			y=4
		[/village]
		[village] 
			x=4
			y=3
		[/village]
		[village] 
			x=6
			y=8
		[/village]
		[village] 
			x=3
			y=11
		[/village]
[/side]
	
[side]
	side={F2}
	controller=ai
        allow_player=no
	no_leader=yes
	gold=50
	income=0
	team_name=enemies
	[ai]
		aggression=1.0
		[target]
		side={F1}
		value=1
		[/target]
		[target]
		id=Master Ooze
		value=3
		[/target]
        [target]
		id=Master Ooze 2
		value=3
		[/target]

	[/ai]
	
	[/side]

[side]
	side={F3}
	controller=ai
        allow_player=no
	no_leader=yes
	gold=0
	income=0
	team_name=enemies
	[ai]
		aggression=0.8
	[/ai]

	
	[/side]

		[event]
		name=prestart
		[objectives]
		side={P1}
			[objective]
			description= _ "Infiltrate Fort Pinewood in your new 'Solid' form. Cultivate allies and try to earn gold. Earn experience at the Training Hall."
			condition=win
			[/objective]
			[objective]
			description= _ "Death of the Master Ooze"
			condition=lose
			[/objective]
                        [objective]
		            description= _ "Death of the Master Ooze 2"
		            condition=lose
	                [/objective]
		[/objectives]

                [objectives]
                side={P2}
			[objective]
			description= _ "Infiltrate Fort Pinewood in your new 'Solid' form. Cultivate allies and try to earn gold. Earn experience at the Training Hall."
			condition=win
			[/objective]
			[objective]
			description= _ "Death of the Master Ooze"
			condition=lose
			[/objective]
                        [objective]
		            description= _ "Death of the Master Ooze 2"
		            condition=lose
	                [/objective]
		[/objectives]

		[terrain]
			x=10
			y=19
			terrain=Re
		[/terrain]
		[terrain]
			x=12
			y=18
			terrain=Gg
		[/terrain]

                {VARIABLE quests_aurelia 0}
                {VARIABLE quests_sithras 0}
                {VARIABLE quests_limit 4}
                {VARIABLE training_aurelia 0}
                {VARIABLE brock_challenge_aurelia 0}
                {VARIABLE brock_challenge_sithras 0}
                {VARIABLE vallin_challenge_aurelia 0}
                {VARIABLE vallin_challenge_sithras 0}
                {VARIABLE slaver_debate_aurelia 0}
                {VARIABLE slaver_debate_sithras 0}
                {VARIABLE brock_friend 3}
                {VARIABLE valin_friend 3}
                {VARIABLE ram_friend 3}
                {VARIABLE corinna_friend 3}
                {VARIABLE sergeant_ryn_friend 3}
                {VARIABLE leaderless_troops 5}
                {VARIABLE leadership_aurelia 3}
                {VARIABLE leadership_sithras 0}

		[set_variable]
			name=book_hunt
			value=0
		[/set_variable]
		[set_variable]
			name=slaver_debate
			value=0
		[/set_variable]	
		[set_variable]
			name=dryden_quest
			value=0
		[/set_variable]
# Variables <<<

		[/event]
	
	[event]
	name=start

	[message]
	id=Master Ooze
	message= _ "The past few days you have gathered up all the slimy blobs of yourself and tightly compacted them into one small ooze, which now resides in the innards of the elvish Solid. Because you devoured the elf's spirit, her abilities are now at your command, although she lost much of her power with the destruction of the Forest Heart."
	[/message]
	[message]
	id=Master Ooze
	message= _ "It has taken you some time to get used to your new solid form. Your senses of taste, touch, hearing and sight are completely different. The elf's memories have given you new insight into the world."
	[/message]
	[message]
	id=Master Ooze
	message= _ "Being a Solid does have drawbacks though. You are more vulnerable to damage, and you're not able to squeeze yourself through small cracks or crevices. You grow tired more easily, and cannot simply dissolve your food in moments." 
	[/message]
	[message]
	id=Master Ooze
	message= _ "You need to determine where you should focus your new talents. Should you focus on developing your physical strength or work on building up your endurance?"
		[option]
			message= _ "I will focus on strength. I want to be able to overpower the opposition." 
			[command]
				[set_variable]
					name=have_strength_aurelia
					value=1
				[/set_variable]
			[/command]
		[/option]
		[option]
			message= _ "I will focus on endurance. I want to be able to outlast my opponents."
			[command]
				[set_variable]
					name=have_resilient_aurelia
					value=1
				[/set_variable]
			[/command]
		[/option]
	[/message]
	[message]
	id=Master Ooze
	message= _ "Elves are well known for their natural grace of movement. Should you focus on manual dexterity or fleetness of foot?"
		[option]
			message= _ "I will focus on manual dexterity. It will help bolster my ranged attacks." 
			[command]
				[set_variable]
					name=have_dexterity_aurelia
					value=1
				[/set_variable]
			[/command]
		[/option]
		[option]
			message= _ "I will focus on fleetness of foot. I want to be able to outrun my enemies."
			[command]
				[set_variable]
					name=have_quickness_aurelia
					value=1
				[/set_variable]
			[/command]
		[/option]
	[/message]
	[message]
	id=Master Ooze
	message= _ "You've arrived at the gates of Fort Pinewood, the main Solid settlement in the region. You're going to have to decide whether to assimilate peacefully into the Solids' civilization, or attempt to destroy it from within..."
	[/message]
	[store_unit]
			variable=ooze_store
			kill=yes
			[filter]
			id=Master Ooze
			[/filter]
	[/store_unit]
	[move_unit_fake]
	type=$ooze_store.type
	x=10,10,10,10,10
	y=19,18,17,16,15
	[/move_unit_fake]
	
	[unstore_unit]
	variable=ooze_store
	[/unstore_unit]
	{CLEAR_VARIABLE ooze_store}

	[kill]
	id=Master Ooze
	[/kill]

	[redraw]
	[/redraw]

	[if]
		[variable]
			name=have_strength_aurelia
			numerical_equals=1
		[/variable]
	[and]
		[variable]
			name=have_dexterity_aurelia
			numerical_equals=1
		[/variable]
	[/and]
	[then]
	[unit]
	side={P1}
	controller=human
	id=Master Ooze
	name= _ "Master Ooze"
	type=Elvish Shaman Ooze
	[modifications]
		{TRAIT_STRONG}
		{TRAIT_DEXTROUS}
	[/modifications]
	fog=no
	canrecruit=yes
	recruit=Ooze
	team_name=oozes
	gold=100
	income=-2
	x=10
	y=15
	[/unit]
	[/then]
	[/if]

	[if]
		[variable]
			name=have_strength_aurelia
			numerical_equals=1
		[/variable]
	[and]
		[variable]
			name=have_quickness_aurelia
			numerical_equals=1
		[/variable]
	[/and]
	[then]
	[unit]
	side={P1}
	controller=human
	id=Master Ooze
	name= _ "Master Ooze"
	type=Elvish Shaman Ooze
	[modifications]
		{TRAIT_STRONG}
		{TRAIT_QUICK}
	[/modifications]
	fog=no
	canrecruit=yes
	recruit=Ooze
	team_name=oozes
	gold=100
	income=-2
	x=10
	y=15
	[/unit]
	[/then]
	[/if]

	[if]
		[variable]
			name=have_resilient_aurelia
			numerical_equals=1
		[/variable]
	[and]
		[variable]
			name=have_dexterity_aurelia
			numerical_equals=1
		[/variable]
	[/and]
	[then]
	[unit]
	side={P1}
	controller=human
	id=Master Ooze
	name= _ "Master Ooze"
	type=Elvish Shaman Ooze
	[modifications]
		{TRAIT_RESILIENT}
		{TRAIT_DEXTROUS}
	[/modifications]
	fog=no
	canrecruit=yes
	recruit=Ooze
	team_name=oozes
	gold=100
	income=-2
	x=10
	y=15
	[/unit]
	[/then]
	[/if]

	[if]
		[variable]
			name=have_resilient_aurelia
			numerical_equals=1
		[/variable]
	[and]
		[variable]
			name=have_quickness_aurelia
			numerical_equals=1
		[/variable]
	[/and]
	[then]
	[unit]
	side={P1}
	controller=human
	id=Master Ooze
	name= _ "Master Ooze"
	type=Elvish Shaman Ooze
	[modifications]
		{TRAIT_RESILIENT}
		{TRAIT_QUICK}
	[/modifications]
	fog=no
	canrecruit=yes
	recruit=Ooze
	team_name=oozes
	gold=100
	income=-2
	x=10
	y=15
	[/unit]
	[/then]
	[/if]
# Master Ooze 2
        [store_unit]
		variable=ooze_store2
		kill=yes
		[filter]
		id=Master Ooze 2
		[/filter]
	[/store_unit]
	[move_unit_fake]
	type=$ooze_store.type
	x=9,10,10,10
	y=19,18,17,16
	[/move_unit_fake]

	[unstore_unit]
	variable=ooze_store2
	[/unstore_unit]
	{CLEAR_VARIABLE ooze_store2}

	[kill]
	id=Master Ooze 2
	[/kill]

	[redraw]
	[/redraw]

        [unit]
	side={P2}
	controller=human
	id=Master Ooze 2
	name= _ "Master Ooze 2"
	type=Elvish Fighter
	fog=no
	canrecruit=yes
	recruit=Ooze
	team_name=oozes
	gold=100
	income=-2
	x=10
	y=16
	[/unit]
	

		[message]
		speaker=Stern Guard
		message= _ "Halt! Who the hell are you?"
		[/message]
		[message]
		speaker=Bored Guard
		message= _ "Aw come on Carmen! Do ya have ta give everyone who passes through here a hard time? Let the elf lady pass! We're only standin' guard ta keep out th' oozes!"
		[/message]
		[message]
		speaker=Stern Guard
		message= _ "Like hell we are! The Mayor says the Fort is under complete lockdown until the ooze crisis is resolved. Besides, we don't need her kind of riff-raff in Pinewood. So sod off, little elf lass, there's nothin' for you here!"
		[/message]
		[message]
	id=Master Ooze
	message= _ "(How should you get past the gate guards?)"
		[option]
			message= _ "(Beg) Please, please, please let me in! You can't leave me out here! The oozes will eat me!"
			[command]
				[message]
					id=Stern Guard
					message= _ "Hmph! Pathetic!"
				[/message]
				[message]
					id=Bored Guard
					message= _ "Aww, Carmen, do ya have to be so heartless? (He pats you on the shoulder as he ushers you through the gate) There, there, little lady, you'll be safe in this here fort. And here's a few coins so you can stay at th' inn."
				[/message]
				
				[message]
					speaker=narrator
					message= _ "You gained five gold pieces!"
				    image=wesnoth-icon.png
				[/message]
				[sound]
					name=gold.ogg
				[/sound]
				[gold]
					side={P1}
					amount=5
				[/gold]
                                [message]
                                  speaker=Master Ooze
                                  message= _ "(You feel strange about this gift from the guard... Like it would be only for you. You don't feel a need to share it with your companion ooze. Fascinated with this new experience you decide to keep it only for yourself.)"
                                [/message]
				[message]
					id=Stern Guard
					message= _ "What the hell?! All it takes is some teary-eyed little wench and you get all sentimental! You're a pathetic excuse for a guard! And as for you, elf witch, you better behave yourself or you'll end up in the town gaol! The other mercenaries in the Mayor's service aren't nearly as forgiving as my idiot companion here!"
				[/message]
                                [message]
					id=Stern Guard
					message= _ "And this other elf behind you?"
				[/message]
                                [message]
					id=Master Ooze
					message= _ "He's with me."
				[/message]
                                [message]
					id=Stern Guard
					message= _ "Bloody hell! Now we have an elvish refugee invasion!"
				[/message]
                                [set_variable]
                                     name=bored_friend
                                     value={P1}
                                [/set_variable]
                                [set_variable]
                                     name=stern_friend
                                     value={P2}
                                [/set_variable]
                                {TEAM_GOLD_VALUE}
                                {LEADERSHIP 1 {P1}}
                                {LEADERSHIP 1 {P2}}
			[/command]
		[/option]
		[option]
			message= _ "(Bribe) I'll pay you thirty pieces of gold if you let me in!"
			[command]
				[message]
					id=Stern Guard
					message= _ "That works for me! Have a nice day, ma'am! And welcome to Fort Pinewood!"
				[/message]
				{TEAM_GOLD lost 30 {P1}}
                                [message]
					id=Bored Guard
					message= _ "Hey wait a moment. What about the man behind you?"
				[/message]  
                                [message]
					id=Stern Guard
					message= _ "Who cares? We've got our bonus pay, it's not our problem anymore."
				[/message]
                                [set_variable]
                                     name=bored_friend
                                     value={P2}
                                [/set_variable]
                                [set_variable]
                                     name=stern_friend
                                     value={P1}
                                [/set_variable]
                                {LEADERSHIP 1 {P1}}
                                {LEADERSHIP 1 {P2}}                      
			[/command]

		[/option]
		[option]
			message= _ "(Offer to help) The oozes threaten everyone. I'm a healer and I came to offer my services in these dark times."
			[command]
				[message]
					id=Stern Guard
					message= _ "Hmmm...I suppose we need all the help we can get..."
				[/message]
				[message]
					id=Bored Guard
					message= _ "Head to th' Mayor's manor just up the street. He's lookin' ta hire healers like yourself."
				[/message]
                                [message]
					id=Stern Guard
					message= _ "And this armed fellow behind you is..."
				[/message]
                                [message]
					id=Master Ooze
					message= _ "My personal bodyguard."
				[/message]
				[message]
					id=Stern Guard
					message= _ "Oh. Welcome to Fort Pinewood then."
				[/message]
                                [set_variable]
                                     name=bored_friend
                                     value={P1}
                                [/set_variable]
                                [set_variable]
                                     name=stern_friend
                                     value={P1}
                                [/set_variable]
                                {TEAM_GOLD_VALUE}
                                {LEADERSHIP 2 {P1}}
			[/command]
		[/option]
		[option]
			message= _ "(Seduce) Surely strong, handsome men like yourselves could do a woman like me a little favor? I could make it worth your while!"
			[command]
				[message]
					id=Bored Guard
					message= _ "(Gulp!) Well I guess we could--"
				[/message]
				[message]
					id=Stern Guard
					message= _ "Could what? You're not actually considering letting that inhuman freak have her way with you, are you? Elves are just one step above monsters! If the Imperial Army wiped their decadent race off the face of the planet, the world would be a better place! I'll say it one last time -- sod off missy! There's nothing for you in Fort Pinewood!"
				[/message]
				[message]
					id=Master Ooze
					message= _ "(He's really angry; it looks like bribery is the only option you have left)"
				[/message]
				[message]
					id=Master Ooze
					message= _ "(Bribe) I'll pay you thirty pieces of gold if you let me in!"
				[/message]
				[message]
					id=Stern Guard
					message= _ "You've finally got my attention, lass! I'll take those coins and... Hey who is that fellow behind you?"
				[/message]
                                [message]
					id=Master Ooze
					message= _ "He's with me."
				[/message]
                                [message]
                                        id=Stern Guard
                                        message= _ "Really? Never mind then. Welcome to Fort Pinewood! May the rest of your day be as nice, ha ha!"
                                [/message]
				{TEAM_GOLD lost 30 {P1}}
				[message]
					id=Bored Guard
					message= _ "Yer really evil, ya know that?"
				[/message]
				[message]
					id=Stern Guard
					message= _ "(Shrugs) I try."
				[/message]
				[set_variable]
                                     name=bored_friend
                                     value={P2}
                                [/set_variable]
                                [set_variable]
                                     name=stern_friend
                                     value={P2}
                                [/set_variable]
                                {LEADERSHIP 2 {P2}}
			[/command]

		[/option]
		
		[/message]
		[message]
			speaker=narrator
			image=items/gohere.png
			message= _ "Whenever you see an icon that looks like this, you should move the Master Ooze onto the hex that contains it to trigger an event."
		[/message]
                {PINEWOOD_RULES}
# DEBUG ===
# remove it in final
#[set_variable]
#  name=various_test
#  value= _ "postfix"
#[/set_variable]
#{TEAM_HAS_GOLD 50 1}
#[message]
#	id=Master Ooze
#	message= _ "The value of test variables:
#$gga
#$ggl
#$has_gold"
#	[/message]
# DEBUG ===
	[/event]
# Setup Master Ooze 2 - it has to be during turn of a player
        [event]
        name=side {P2} turn 1
        # Master Ooze 2
        [message]
	id=Master Ooze 2
	message= _ "The past few days you have gathered up all the slimy blobs of yourself and tightly compacted them into one small ooze, which now resides in the innards of the elvish Solid. Because you devoured the elf's spirit, his abilities are now at your command, although he lost much of his power with the destruction of the Forest Heart."
	[/message]
	[message]
	id=Master Ooze 2
	message= _ "It has taken you some time to get used to your new solid form. Your senses of taste, touch, hearing and sight are completely different. The elf's memories have given you new insight into the world."
	[/message]
	[message]
	id=Master Ooze 2
	message= _ "Being a Solid does have drawbacks though. You are more vulnerable to damage, and you're not able to squeeze yourself through small cracks or crevices. You grow tired more easily, and cannot simply dissolve your food in moments." 
	[/message]
	[message]
	id=Master Ooze 2
	message= _ "You need to determine where you should focus your new talents. Should you focus on developing your physical strength or work on building up your endurance?"
		[option]
			message= _ "I will focus on strength. I want to be able to overpower the opposition." 
			[command]
				[set_variable]
					name=have_strength_sithras
					value=1
				[/set_variable]
			[/command]
		[/option]
		[option]
			message= _ "I will focus on endurance. I want to be able to outlast my opponents."
			[command]
				[set_variable]
					name=have_resilient_sithras
					value=1
				[/set_variable]
			[/command]
		[/option]
	[/message]
	[message]
	id=Master Ooze 2
	message= _ "Elves are well known for their natural grace of movement. Should you focus on manual dexterity or fleetness of foot?"
		[option]
			message= _ "I will focus on manual dexterity. It will help bolster my ranged attacks." 
			[command]
				[set_variable]
					name=have_dexterity_sithras
					value=1
				[/set_variable]
			[/command]
		[/option]
		[option]
			message= _ "I will focus on fleetness of foot. I want to be able to outrun my enemies."
			[command]
				[set_variable]
					name=have_quickness_sithras
					value=1
				[/set_variable]
			[/command]
		[/option]
	[/message]
	[message]
	id=Master Ooze 2
	message= _ "You've arrived at the gates of Fort Pinewood, the main Solid settlement in the region. You're going to have to decide whether to assimilate peacefully into the Solids' civilization, or attempt to destroy it from within..."
	[/message]
        [store_unit]
		variable=ooze_store2
		kill=yes
		[filter]
		id=Master Ooze 2
		[/filter]
	[/store_unit]
	
	[unstore_unit]
	variable=ooze_store2
	[/unstore_unit]
	{CLEAR_VARIABLE ooze_store2}

	[kill]
	id=Master Ooze 2
	[/kill]

	[redraw]
	[/redraw]
	[if]
		[variable]
			name=have_strength_sithras
			numerical_equals=1
		[/variable]
	[and]
		[variable]
			name=have_dexterity_sithras
			numerical_equals=1
		[/variable]
	[/and]
	[then]
	[unit]
	side={P2}
	controller=human
	id=Master Ooze 2
	name= _ "Master Ooze 2"
	type=Elvish Fighter
	[modifications]
		{TRAIT_STRONG}
		{TRAIT_DEXTROUS}
	[/modifications]
	fog=no
	canrecruit=yes
	recruit=Ooze
	team_name=oozes
	gold=100
	income=-2
	x=10
	y=16
	[/unit]
	[/then]
	[/if]

	[if]
		[variable]
			name=have_strength_sithras
			numerical_equals=1
		[/variable]
	[and]
		[variable]
			name=have_quickness_sithras
			numerical_equals=1
		[/variable]
	[/and]
	[then]
	[unit]
	side={P2}
	controller=human
	id=Master Ooze 2
	name= _ "Master Ooze 2"
	type=Elvish Fighter
	[modifications]
		{TRAIT_STRONG}
		{TRAIT_QUICK}
	[/modifications]
	fog=no
	canrecruit=yes
	recruit=Ooze
	team_name=oozes
	gold=100
	income=-2
	x=10
	y=16
	[/unit]
	[/then]
	[/if]

	[if]
		[variable]
			name=have_resilient_sithras
			numerical_equals=1
		[/variable]
	[and]
		[variable]
			name=have_dexterity_sithras
			numerical_equals=1
		[/variable]
	[/and]
	[then]
	[unit]
	side={P2}
	controller=human
	id=Master Ooze 2
	name= _ "Master Ooze 2"
	type=Elvish Fighter
	[modifications]
		{TRAIT_RESILIENT}
		{TRAIT_DEXTROUS}
	[/modifications]
	fog=no
	canrecruit=yes
	recruit=Ooze
	team_name=oozes
	gold=100
	income=-2
	x=10
	y=16
	[/unit]
	[/then]
	[/if]

	[if]
		[variable]
			name=have_resilient_sithras
			numerical_equals=1
		[/variable]
	[and]
		[variable]
			name=have_quickness_sithras
			numerical_equals=1
		[/variable]
	[/and]
	[then]
	[unit]
	side={P2}
	controller=human
	id=Master Ooze 2
	name= _ "Master Ooze 2"
	type=Elvish Fighter
	[modifications]
		{TRAIT_RESILIENT}
		{TRAIT_QUICK}
	[/modifications]
	fog=no
	canrecruit=yes
	recruit=Ooze
	team_name=oozes
	gold=100
	income=-2
	x=10
	y=16
	[/unit]
	[/then]
	[/if]
        [message]
		speaker=narrator
		image=items/gohere.png
		message= _ "Whenever you see an icon that looks like this, you should move the Master Ooze 2 onto the hex that contains it to trigger an event."
	[/message]
        {PINEWOOD_RULES}
        [/event]

	[event]
	name=moveto
		[filter]
		side={P1},{P2}
		x=11
		y=18
		[/filter]

		[message]
		speaker=narrator
		message= _ "Welcome to Fort Pinewood. North to Tarakin City. South to Shinseki Forest."
		    image=wesnoth-icon.png
		[/message]
	[/event]

	[event]
	name=moveto
	first_time_only=yes
		[filter]
		side={P1}
		x=10
		y=11
                [/filter]
		[if]
                [not]
                [variable]
                  name=mayor_wyatt_speach
                  numerical_equals=2
                [/variable]
                [/not]
                [then]
                {VARIABLE mayor_wyatt_speach {P1}}
		[remove_item]
		x,y=10,11
		[/remove_item]
		{MAYOR_WYATT {P1}}
                [/then]
                [/if]		
	[/event]

        [event]
	name=moveto
	first_time_only=yes
		[filter]
		side={P2}
		x=10
		y=11
		[/filter]
                [if]
                [not]
                [variable]
                  name=mayor_wyatt_speach
                  numerical_equals=1
                [/variable]
                [/not]
                [then]
                {VARIABLE mayor_wyatt_speach {P2}}
		[remove_item]
		x,y=10,11
		[/remove_item]
		{MAYOR_WYATT {P2}}
                [/then]
                [/if]		
	[/event]

	#dryden_quest variable value key:
	#0: Quest not given
	#1: Player is to bring letter to Corinna
	#2: Player returns to Dryden after letter mission
	#3: Player is honest with Dryden
	#4: Player tricks Dryden
	#5: Player brings the ring to Corinna
	#6: Tell Dryden he won
	#7: Tell Dryden he lost
	
	#Speaking with Dryden events
    [event]
	name=moveto
	first_time_only=no
	[filter]
	    side={P1}
	    x=8
	    y=12
	[/filter]

        [if]
            [variable]
                name=quests_aurelia
                greater_than=$quests_limit
            [/variable]
        [then]
            [if]
                [variable]
                    name=quest_sir_dryden
                    numerical_equals={P1}
                [/variable]
            [then]
                {SIR_DRYDEN {P1}}
            [/then]
            [else]
            [/else]
                {NO_TIME {P1}}
            [/if]
        [/then]
        [else]
        [if]
            [not]
                [variable]
                    name=quest_sir_dryden
                    numerical_equals=2
                [/variable]
            [/not]
        [then]
	    {SIR_DRYDEN {P1}}
        [/then]
        [/if]
        [/else]
        [/if]
    [/event]

    [event]
	name=moveto
	first_time_only=no
	[filter]
	    side={P2}
	    x=8
	    y=12
	[/filter]
        [if]
            [variable]
                name=quests_sithras
                greater_than=$quests_limit
            [/variable]
            [and]
                [variable]
                    name=quest_sir_dryden
                    less_than=2
                [/variable]
            [/and]
        [then]
            [if]
                [variable]
                    name=quest_sir_dryden
                    numerical_equals={P2}
                [/variable]
            [then]
                {SIR_DRYDEN {P2}}
            [/then]
            [else]
            [/else]
                {NO_TIME {P2}}
            [/if]
        [/then]
        [else]
        [if]
            [not]
                [variable]
                    name=quest_sir_dryden
                    numerical_equals=1
                [/variable]
            [/not]
        [then]
	    {SIR_DRYDEN {P2}}
        [/then]
        [/if]
        [/else]
        [/if]	
   [/event]
	
	#Speaking with Corinna events
	[event]
	name=moveto
	first_time_only=no
		[filter]
		side={P1}
		x=4
		y=10
		[/filter]
                [if]
                [not]
                [variable]
                  name=quest_sir_dryden
                  numerical_equals=2
                [/variable]
                [/not]
                [then]
		{CORRINA {P1}}
                [/then]
                [/if]
	[/event]

        [event]
	name=moveto
	first_time_only=no
		[filter]
		side={P2}
		x=4
		y=10
		[/filter]
                [if]
                [not]
                [variable]
                  name=quest_sir_dryden
                  numerical_equals=1
                [/variable]
                [/not]
                [then]
		{CORRINA {P2}}
                [/then]
                [/if]
	[/event]

[event]
    name=moveto
    first_time_only=no
    [filter]
    side={P1}
    x=6
    y=9
    [/filter]
    {FRIST {P1}}				
[/event]

[event]
    name=moveto
    first_time_only=no
    [filter]
    side={P2}
    x=6
    y=9
    [/filter]
    {FRIST {P2}}				
[/event]

#Prevent Sithras from attacking quintains by moving them apart
[event]
	name=attack
	first_time_only=no
	[filter]
		side={P2}
	[/filter]
	[filter_second]
		type=Quintain0
	[/filter_second]
	[message]
		speaker=narrator
		message= _ "You're already a skilled warrior. You won't get any experience from practicing on quintains!"
	[/message]
	
	[teleport]
	[filter]
		side={P2}
	[/filter]
	x=7
	y=12
	[/teleport]
	
	#a second_unit filter here might be better?
	[teleport]
	[filter]
		type=Quintain0
	[/filter]
	x=7
	y=8
	[/teleport]
	
	#[kill]
	#[filter]
	#	type=Quintain0
	#[/filter]
	#[/kill]
	
	
	
[/event]



[event]
	name=post_advance
	[filter]
	id=Master Ooze
	[/filter]
	{AURELIA_SKILLS}
[/event]

[event]
    name=moveto
    first_time_only=no
    [filter]
	side={P1}
	x=10
	y=6
    [/filter]    
    [if]
        [variable]
            name=have_training_aurelia
            numerical_equals=1
        [/variable]
        [and]
        [variable]
            name=pinewood_arena_closed
            not_equals=yes
        [/variable]
        [/and]
    [then]
	{PINEWOOD_ARENA {P1}}
    [/then]
    [else]
        [if]
	    [variable]
	        name=have_training_aurelia
	        numerical_equals=2
	    [/variable]
            [and]
                [variable]
	            name=have_training_sithras
	            less_than=3
	        [/variable]
            [/and]
        [then]
            {PINEWOOD_ARENA_CHAMPION {P1}}
        [/then]
        [else]
            [if]
                [variable]
                    name=pinewood_arena_closed
                    equals=yes
                [/variable]
            [then]             
                {PINEWOOD_ARENA_CLOSED {P1}}
            [/then]
            [/if]           
        [/else]
        [/if]
    [/else]
    [/if]
[/event]

[event]
    name=moveto
    first_time_only=no
    [filter]
        side={P2}
	x=10
	y=6
    [/filter]
    [if]
        [variable]
            name=have_training_sithras
            numerical_equals=1
        [/variable]
        [and]
        [variable]
            name=pinewood_arena_closed
            not_equals=yes
        [/variable]
        [/and]
    [then]
	{PINEWOOD_ARENA {P2}}
    [/then]
    [else]
        [if]
	    [variable]
                name=have_training_sithras
	        numerical_equals=2
	    [/variable]
            [and]
                [variable]
	            name=have_training_aurelia
	            less_than=3
	        [/variable]
            [/and]
        [then]
            {PINEWOOD_ARENA_CHAMPION {P2}}
        [/then]
        [else]
            [if]
                [variable]
                    name=pinewood_arena_closed
                    equals=yes
                [/variable]
            [then]
                {PINEWOOD_ARENA_CLOSED {P2}}
            [/then]
            [/if] 
        [/else]
        [/if]
    [/else]
    [/if]
[/event]

[event]
	name=die
	first_time_only=no
	[filter]
	id=Arena Monster
	[/filter]
	{MONSTER_DIE $ongoing_fight}
[/event]

[event]
	name=die
	first_time_only=no
	[filter]
	type=Quintain0
	[/filter]
        [if]
            [variable]
                name=training_aurelia
                greater_than=1
            [/variable]
            [and]
                [not]
                    [have_unit]
                        side={F3}
                        type=Quintain0
                    [/have_unit]
                [/not]
            [/and]
        [then]
        {CLEAR_VARIABLE quintains_released}
	{AURELIA_TRAINING}
        [/then]
        [else]
            [if]
                [not]
                    [have_unit]
                        side={F3}
                        type=Quintain0
                    [/have_unit]
                [/not]
            [then]
                {CLEAR_VARIABLE quintains_released}
            [/then]
            [/if]
        [/else]
              
        [/if]
[/event]

[event]
    name=post_advance
    [filter]
        id=Master Ooze 2
        type=Elvish Captain
    [/filter]
    {SITHRAS_SKILLS 1}
    {SITHRAS_CHALLENGE}
[/event]

[event]
    name=post_advance
    [filter]
        id=Master Ooze 2
        type=Elvish Hero
    [/filter]
    {SITHRAS_SKILLS 2}
    {SITHRAS_CHALLENGE}
[/event]

[event]
    name=moveto
    first_time_only=no
    [filter]
	side={P1}
	x=8,9,10,11,12
	y=6-7,6-8,7-8,6-8,6-7
    [/filter]
    [if]
        [variable]
            name=pinewood_arena_closed
            not_equals=yes
        [/variable]
    [then]
        {PINEWOOD_ARENA_SPECTATOR {P1}}
    [/then]
    [/if]
[/event]

[event]
    name=moveto
    first_time_only=no
    [filter]
	side={P2}
	x=8,9,10,11,12
	y=6-7,6-8,7-8,6-8,6-7
    [/filter]
    [if]
        [variable]
            name=pinewood_arena_closed
            not_equals=yes
        [/variable]
    [then]
       {PINEWOOD_ARENA_SPECTATOR {P2}}
    [/then]
    [/if]
[/event]

[event]
    name=post_advance
    [filter]
	type=Elvish Enchantress Ooze
    [/filter]
    {AURELIA_SKILLS_2}
    {AURELIA_CHALLENGE}
[/event]
	
[event]
    name=die
    [filter]
	id=Bloodtalon
    [/filter]
    {BLOODTALON_DIE $ongoing_fight}
[/event]
		
[event]
    name=moveto
    first_time_only=yes
    [filter]
	side={P1}
	x=15
	y=11
    [/filter]
    [if]
        [variable]
            name=quests_aurelia
            greater_than=$quests_limit
        [/variable]
    [then]
        {NO_TIME {P1}}
    [/then]
    [else]
        {FONTAINE {P1}}
    [/else]
    [/if]
[/event]

[event]
    name=moveto
    first_time_only=yes
    [filter]
	side={P2}
	x=15
	y=11
    [/filter]
    [if]
        [variable]
            name=quests_sithras
            greater_than=$quests_limit
        [/variable]
    [then]
        {NO_TIME {P2}}
    [/then]
    [else]
        {FONTAINE {P2}}
    [/else]
    [/if]
[/event]

[event]
    name=moveto
    first_time_only=yes
    [filter]
	side={P1}
	x=15
	y=7
    [/filter]
    [if]
        [variable]
            name=quests_aurelia
            greater_than=$quests_limit
        [/variable]
    [then]
        {NO_TIME {P1}}
    [/then]
    [else]
        {LIVIUS {P1}}
    [/else]
    [/if]
[/event]

[event]
    name=moveto
    first_time_only=yes
    [filter]
	side={P2}
	x=15
	y=7
    [/filter]
    [if]
        [variable]
            name=quests_sithras
            greater_than=$quests_limit
        [/variable]
    [then]
        {NO_TIME {P2}}
    [/then]
    [else]
        {LIVIUS {P2}}
    [/else]
    [/if]
[/event]

[event]
    name=moveto
    first_time_only=no
    [filter]
	side={P1}
	x=3
	y=14
    [/filter]
    {LIVIUS_BOOK {P1}}	
[/event]

[event]
    name=moveto
    first_time_only=no
    [filter]
	side={P2}
	x=3
	y=14
    [/filter]
    {LIVIUS_BOOK {P2}}	
[/event]

[event]
    name=moveto
    first_time_only=no
    [filter]
	side={P1}
	x=15
	y=7
    [/filter]
    {LIVIUS_REWARD {P1}}
[/event]

[event]
    name=moveto
    first_time_only=no
    [filter]
	side={P2}
	x=15
	y=7
    [/filter]
    {LIVIUS_REWARD {P2}}
[/event]

[event]
    name=moveto
    first_time_only=yes
    [filter]
	side={P1}
	x=14
	y=5
    [/filter]
    [if]
        [variable]
            name=quests_aurelia
            greater_than=$quests_limit
        [/variable]
    [then]
        {NO_TIME {P1}}
    [/then]
    [else]
        {JEDD {P1}}
    [/else]
    [/if]	
[/event]

[event]
    name=moveto
    first_time_only=yes
    [filter]
	side={P2}
	x=14
	y=5
    [/filter]
    [if]
        [variable]
            name=quests_sithras
            greater_than=$quests_limit
        [/variable]
    [then]
        {NO_TIME {P2}}
    [/then]
    [else]
        {JEDD {P2}}
    [/else]
    [/if]	
[/event]

[event]
    name=moveto
    first_time_only=no
    [filter]
	side={P1}
	x=13
	y=4
    [/filter]
    {JEDD_FARM_WORK 0 {P1}}
[/event]

[event]
    name=moveto
    first_time_only=no
    [filter]
	side={P2}
	x=13
	y=4
    [/filter]
    {JEDD_FARM_WORK 0 {P2}}
[/event]

[event]
    name=moveto
    first_time_only=no
    [filter]
	side={P1}
	x=13
	y=3
    [/filter]
    {JEDD_FARM_WORK 1 {P1}}
[/event]

[event]
    name=moveto
    first_time_only=no
    [filter]
	side={P2}
	x=13
	y=3
    [/filter]
    {JEDD_FARM_WORK 1 {P2}}
[/event]

[event]
    name=moveto
    first_time_only=no
    [filter]
	side={P1}
	x=15
	y=5
    [/filter]
    {JEDD_FARM_WORK 2 {P1}}
[/event]

[event]
    name=moveto
    first_time_only=no
    [filter]
	side={P2}
	x=15
	y=5
    [/filter]
    {JEDD_FARM_WORK 2 {P2}}
[/event]

[event]
    name=moveto
    first_time_only=no
    [filter]
	side={P1}
	x=14
	y=5
    [/filter]
    {JEDD_WORK_DONE {P1}}
[/event]

[event]
    name=moveto
    first_time_only=no
    [filter]
	side={P2}
	x=14
	y=5
    [/filter]
    {JEDD_WORK_DONE {P2}}
[/event]

[event]
     name=moveto
     first_time_only=no
     [filter]
	 side={P1}
	 x=13
	 y=12
     [/filter]
     {BROCK {P1}}		
[/event]

[event]
     name=moveto
     first_time_only=no
     [filter]
	 side={P2}
	 x=13
	 y=12
     [/filter]
     {BROCK {P2}}		
[/event]

[event]
    name=moveto
    first_time_only=no
    [filter]
	side={P1}
	x=17
	y=8
    [/filter]
    {VALIN {P1}}	
[/event]

[event]
    name=moveto
    first_time_only=no
    [filter]
	side={P2}
	x=17
	y=8
    [/filter]
    {VALIN {P2}}	
[/event]

[event]
    name=moveto
    first_time_only=no
    [filter]
	side={P1}
	x=4
	y=7
    [/filter]
    [if]
        [variable]
            name=quests_aurelia
            greater_than=$quests_limit
        [/variable]
    [then]
        {NO_TIME {P1}}
    [/then]
    [else]
        {RAM {P1}}
    [/else]
    [/if]
[/event]

[event]
    name=moveto
    first_time_only=no
    [filter]
	side={P2}
	x=4
	y=7
    [/filter]
    [if]
        [variable]
            name=quests_sithras
            greater_than=$quests_limit
        [/variable]
    [then]
        {NO_TIME {P2}}
    [/then]
    [else]
        {RAM {P2}}
    [/else]
    [/if]
[/event]

[event]
    name=moveto
    first_time_only=no
    [filter]
	side={P1}
	x=15
	y=9
    [/filter]
    [if]
        [variable]
            name=quests_aurelia
            greater_than=$quests_limit
        [/variable]
    [then]
        {NO_TIME {P1}}
    [/then]
    [else]
        {HIGH_PRIEST_JAL {P1}}
    [/else]
    [/if]
[/event]

[event]
    name=moveto
    first_time_only=no
    [filter]
	side={P2}
	x=15
	y=9
    [/filter]
    [if]
        [variable]
            name=quests_sithras
            greater_than=$quests_limit
        [/variable]
    [then]
        {NO_TIME {P2}}
    [/then]
    [else]
        {HIGH_PRIEST_JAL {P2}}
    [/else]
    [/if]
[/event]

[event]
    name=moveto
    first_time_only=yes
    [filter]
	side={P1},{P2}
	x=17
	y=12
    [/filter]
    {SHADY_CHARACTER}
[/event]

[event]
    name=moveto
    [filter]
         side={P1}
         x=6
         y=5
    [/filter]
    {ALKAR {P1}}
[/event]

[event]
    name=moveto
    [filter]
         side={P2}
         x=6
         y=5
    [/filter]
    {ALKAR {P2}}
[/event]

[event]
    name=moveto
    first_time_only=yes
    [filter]
        side={P1}
	x=4
        y=4
    [/filter]
    [if]
        [variable]
            name=quests_aurelia
            greater_than=$quests_limit
        [/variable]
    [then]
        {NO_TIME {P1}}
    [/then]
    [else]
        {GUTHRY {P1}}
    [/else]
    [/if]
[/event]

[event]
    name=moveto
    first_time_only=yes
    [filter]
       side={P2}
       x=4
       y=4
    [/filter]
    [if]
        [variable]
            name=quests_sithras
            greater_than=$quests_limit
        [/variable]
    [then]
        {NO_TIME {P2}}
    [/then]
    [else]	
        {GUTHRY {P2}}
    [/else]
    [/if]
[/event]

[event]
    name=moveto
    first_time_only=no
    [filter]
	side={P1}
	x=10
	y=2
    [/filter]
    [if]
        [variable]
            name=quests_aurelia
            greater_than=$quests_limit
        [/variable]
    [then]
        {NO_TIME {P1}}
    [/then]
    [else]
        {SLAVER_DEBATE {P1}}
    [/else]
    [/if] 		
[/event]

[event]
    name=moveto
    first_time_only=no
    [filter]
	side={P2}
	x=10
	y=2
    [/filter]
    [if]
        [variable]
            name=quests_sithras
            greater_than=$quests_limit
        [/variable]
    [then]
        {NO_TIME {P2}}
    [/then]
    [else]
        {SLAVER_DEBATE {P2}}
    [/else]
    [/if]		
[/event]

[event]
    name=moveto
    first_time_only=no
    [filter]
	side={P1}
        x=10
        y=15
    [/filter]
    {PINEWOOD_TRANSACTIONS_OVER {P1}}	
[/event]

[event]
    name=moveto
    first_time_only=no
    [filter]
	side={P2}
        x=10
        y=15
    [/filter]
    {PINEWOOD_TRANSACTIONS_OVER {P2}}	
[/event]

[event]
    name=side {P1} turn
    first_time_only=no
    [if]
        [variable]
            name=fight_end
            not_equals=0
        [/variable]
    [then]
        [teleport]
            [filter]
                side=$fight_end
            [/filter]
            x=14
            y=7
        [/teleport]        

        {VARIABLE fight_end 0}        
    [/then]
    [/if]

    [if]
        [variable]
            name=pinewood_transactions_done
            numerical_equals={P1}
        [/variable]
    [then]
        [end_turn]
        [/end_turn]
    [/then]
    [/if]
[/event]		

[event]
    name=side {P2} turn
    first_time_only=no
    [if]
        [variable]
            name=fight_end
            not_equals=0
        [/variable]
    [then]
        [teleport]
            [filter]
                side=$fight_end
            [/filter]
            x=14
            y=7
        [/teleport]        

        {VARIABLE fight_end 0}        
    [/then]
    [/if]
    
    [if]
        [variable]
            name=pinewood_transactions_done
            numerical_equals={P2}
        [/variable]
    [then]
        [end_turn]
        [/end_turn]
    [/then]
    [/if]
[/event]

[event]
	name=last breath
	[filter]
	id=Master Ooze
	[/filter]
	[message]
	speaker=unit
	message= _ "Gurgle!"
	[/message]
        [message]
            id=Master Ooze 2
            message= _ "(It seems you somehow remain connected to your companion ooze. When your other part dies you die as well...)"
        [/message]
	[endlevel]
	result=defeat
	[/endlevel]
[/event]

[event]
	name=last breath
	[filter]
        id=Master Ooze 2
	[/filter]
	[message]
	speaker=unit
	message= _ "Gurgle!"
	[/message]
        [message]
            id=Master Ooze
            message= _ "(It seems you somehow remain connected to your companion ooze. When your other part dies you die as well...)"
        [/message]
	[endlevel]
	result=defeat
	[/endlevel]
[/event]

[event]
    name=moveto
    first_time_only=no
    [filter]
        side={P1}
    [/filter]
    [if]
        [variable]
            name=pinewood_transactions_done
            numerical_equals=2
        [/variable]
    [then]
        [store_unit]
            kill=no
            variable=temp
            [filter]
                id=Master Ooze
            [/filter]
        [/store_unit]
        [set_variable]
            name=temp.moves
            to_variable=temp.max_moves
        [/set_variable]
        [unstore_unit]
            find_vacant=no
            variable=temp
        [/unstore_unit]
        [clear_variable]
            name=temp
        [/clear_variable]
    [/then]
    [/if]
[/event]

[event]
    name=moveto
    first_time_only=no
    [filter]
        side={P2}
    [/filter]
    [if]
        [variable]
            name=pinewood_transactions_done
            numerical_equals=1
        [/variable]
    [then]
        [store_unit]
            kill=no
            variable=temp
            [filter]
                id=Master Ooze 2
            [/filter]
        [/store_unit]
        [set_variable]
            name=temp.moves
            to_variable=temp.max_moves
        [/set_variable]
        [unstore_unit]
            find_vacant=no
            variable=temp
        [/unstore_unit]
        [clear_variable]
            name=temp
        [/clear_variable]
    [/then]
    [/if]
[/event]

[/multiplayer]

